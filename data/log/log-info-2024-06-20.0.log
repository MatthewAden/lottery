24-06-20.15:06:54.053 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 89144 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-20.15:06:54.054 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-20.15:06:54.596 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-20.15:06:54.597 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-20.15:06:54.615 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 11 ms. Found 0 Redis repository interfaces.
24-06-20.15:06:55.000 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-20.15:06:55.004 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-20.15:06:55.004 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-20.15:06:55.005 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-20.15:06:55.054 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-20.15:06:55.054 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 945 ms
24-06-20.15:06:55.361 [main            ] WARN  AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'raffleActivityController': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'strategyAssembleFactory': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'strategyRepository': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'raffleAward': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.BeanCurrentlyInCreationException: Error creating bean with name 'strategyRepository': Requested bean is currently in creation: Is there an unresolvable circular reference?
24-06-20.15:06:55.362 [main            ] INFO  StandardService        - Stopping service [Tomcat]
24-06-20.15:06:55.371 [main            ] INFO  ConditionEvaluationReportLoggingListener - 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
24-06-20.15:06:55.379 [main            ] ERROR LoggingFailureAnalysisReporter - 

***************************
APPLICATION FAILED TO START
***************************

Description:

The dependencies of some of the beans in the application context form a cycle:

   raffleActivityController
      ↓
   strategyAssembleFactory
┌─────┐
|  strategyRepository
↑     ↓
|  raffleAward
└─────┘


Action:

Relying upon circular references is discouraged and they are prohibited by default. Update your application to remove the dependency cycle between beans. As a last resort, it may be possible to break the cycle automatically by setting spring.main.allow-circular-references to true.

24-06-20.15:14:42.994 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 90289 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-20.15:14:42.995 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-20.15:14:43.550 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-20.15:14:43.551 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-20.15:14:43.570 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 11 ms. Found 0 Redis repository interfaces.
24-06-20.15:14:44.072 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-20.15:14:44.076 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-20.15:14:44.076 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-20.15:14:44.076 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-20.15:14:44.119 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-20.15:14:44.120 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1102 ms
24-06-20.15:14:44.436 [main            ] WARN  AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'raffleActivityController': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'strategyAssembleFactory': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'strategyRepository': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'raffleAward': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.BeanCurrentlyInCreationException: Error creating bean with name 'strategyRepository': Requested bean is currently in creation: Is there an unresolvable circular reference?
24-06-20.15:14:44.444 [main            ] INFO  StandardService        - Stopping service [Tomcat]
24-06-20.15:14:44.453 [main            ] INFO  ConditionEvaluationReportLoggingListener - 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
24-06-20.15:14:44.460 [main            ] ERROR LoggingFailureAnalysisReporter - 

***************************
APPLICATION FAILED TO START
***************************

Description:

The dependencies of some of the beans in the application context form a cycle:

   raffleActivityController
      ↓
   strategyAssembleFactory
┌─────┐
|  strategyRepository
↑     ↓
|  raffleAward
└─────┘


Action:

Relying upon circular references is discouraged and they are prohibited by default. Update your application to remove the dependency cycle between beans. As a last resort, it may be possible to break the cycle automatically by setting spring.main.allow-circular-references to true.

24-06-20.15:15:23.424 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 90395 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-20.15:15:23.425 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-20.15:15:23.911 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-20.15:15:23.912 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-20.15:15:23.929 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 11 ms. Found 0 Redis repository interfaces.
24-06-20.15:15:24.406 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-20.15:15:24.410 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-20.15:15:24.411 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-20.15:15:24.411 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-20.15:15:24.457 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-20.15:15:24.458 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1014 ms
24-06-20.15:15:24.821 [main            ] INFO  Version                - Redisson 3.26.0
24-06-20.15:15:24.836 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-20.15:15:24.905 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.15:15:24.914 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.15:15:25.434 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-20.15:15:25.569 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.15:15:25.603 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.15:15:25.603 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.15:15:25.603 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718867725603
24-06-20.15:15:25.611 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-20.15:15:25.616 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.15:15:25.620 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.15:15:25.620 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.15:15:25.620 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718867725620
24-06-20.15:15:25.623 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-20.15:15:25.624 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.15:15:25.626 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.15:15:25.626 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.15:15:25.627 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718867725626
24-06-20.15:15:25.629 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-20.15:15:25.629 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
24-06-20.15:15:25.634 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-20.15:15:25.644 [main            ] INFO  Application            - Started Application in 2.424 seconds (JVM running for 2.71)
24-06-20.15:15:25.798 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-20.15:15:25.798 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-20.15:15:25.798 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-20.15:15:25.799 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.15:15:25.799 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.15:15:25.799 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.15:15:25.819 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.15:15:25.819 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.15:15:25.819 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.15:15:25.830 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.15:15:25.830 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.15:15:25.830 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.15:15:25.858 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-20.15:15:25.858 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-20.15:15:25.858 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-20.15:15:25.858 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.15:15:25.858 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.15:15:25.858 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.15:15:26.287 [RMI TCP Connection(4)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
24-06-20.15:15:26.288 [RMI TCP Connection(4)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
24-06-20.15:15:26.290 [RMI TCP Connection(4)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 2 ms
24-06-20.15:15:26.291 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.15:15:26.484 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.15:15:26.500 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.15:15:26.531 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.15:15:28.881 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=273, memberId='consumer-sku-clear-group-3-3028bb6a-5aba-4ba0-b256-a5cc56b03777', protocol='range'}
24-06-20.15:15:28.883 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=271, memberId='consumer-sku-deduct-group-2-006b245c-5752-4ffe-b0fb-3a75f0ce3c71', protocol='range'}
24-06-20.15:15:28.883 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=19, memberId='consumer-send-rebate-group-1-ba2fcee7-5ac4-4248-9555-5348b49cf60e', protocol='range'}
24-06-20.15:15:28.885 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 19: {consumer-send-rebate-group-1-ba2fcee7-5ac4-4248-9555-5348b49cf60e=Assignment(partitions=[send-rebate-topic-0])}
24-06-20.15:15:28.885 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 273: {consumer-sku-clear-group-3-3028bb6a-5aba-4ba0-b256-a5cc56b03777=Assignment(partitions=[sku-clear-topic-0])}
24-06-20.15:15:28.885 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 271: {consumer-sku-deduct-group-2-006b245c-5752-4ffe-b0fb-3a75f0ce3c71=Assignment(partitions=[sku-deduct-topic-0])}
24-06-20.15:15:28.919 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=273, memberId='consumer-sku-clear-group-3-3028bb6a-5aba-4ba0-b256-a5cc56b03777', protocol='range'}
24-06-20.15:15:28.919 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=19, memberId='consumer-send-rebate-group-1-ba2fcee7-5ac4-4248-9555-5348b49cf60e', protocol='range'}
24-06-20.15:15:28.919 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=271, memberId='consumer-sku-deduct-group-2-006b245c-5752-4ffe-b0fb-3a75f0ce3c71', protocol='range'}
24-06-20.15:15:28.919 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-20.15:15:28.919 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-20.15:15:28.919 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-20.15:15:28.921 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-20.15:15:28.921 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-20.15:15:28.921 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-20.15:15:28.929 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=84, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.15:15:28.929 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.15:15:28.929 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Setting offset for partition send-rebate-topic-0 to the committed offset FetchPosition{offset=7, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.15:15:28.930 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-20.15:15:28.930 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-20.15:15:28.930 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-20.15:15:28.973 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.15:15:29.030 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.15:15:29.040 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.15:15:29.050 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.15:15:29.060 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.15:15:29.073 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.15:15:29.074 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.15:15:29.482 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.15:15:29.482 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.15:15:29.484 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.15:15:29.497 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.15:15:29.497 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.15:15:29.988 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.15:15:29.988 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.15:15:29.990 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.15:15:30.000 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.15:15:30.001 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.15:15:30.493 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.15:15:30.493 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.15:15:30.498 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.15:15:30.511 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.15:15:30.511 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.15:15:31.003 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.15:15:31.003 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.15:15:31.010 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.15:15:31.020 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.15:15:31.020 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.15:15:31.510 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.15:15:31.510 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.15:15:31.513 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.15:15:31.525 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.15:15:31.526 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.15:15:32.013 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.15:15:32.014 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.15:15:32.017 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.15:15:32.029 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.15:15:32.030 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.15:15:32.523 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.15:15:32.523 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.15:15:32.525 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.15:15:32.538 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.15:15:32.538 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.15:15:33.030 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.15:15:33.031 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.15:15:33.036 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.15:15:33.049 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.15:15:33.049 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.15:15:33.534 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.15:15:33.534 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.15:15:33.537 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.15:15:33.538 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR DefaultErrorHandler    - Backoff FixedBackOff{interval=0, currentAttempts=10, maxAttempts=9} exhausted for send-rebate-topic-0@7
org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.15:15:33.538 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 8 for partition send-rebate-topic-0
24-06-20.15:15:34.039 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_sku_20240618","rebateConfig":"999","rebateDesc":"签到返利-sku额度","rebateType":"sku","userId":"matthew"},"id":"66659538015","timestamp":1718696688011}]
24-06-20.15:15:34.039 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"integral","userId":"matthew"},"id":"52032248913","timestamp":1718696688012}]
24-06-20.15:24:26.037 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Node -1 disconnected.
24-06-20.15:24:26.037 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Node -1 disconnected.
24-06-20.15:24:26.037 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Node -1 disconnected.
24-06-20.15:46:31.934 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Revoke previously assigned partitions sku-clear-topic-0
24-06-20.15:46:31.934 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Revoke previously assigned partitions sku-deduct-topic-0
24-06-20.15:46:31.934 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Revoke previously assigned partitions send-rebate-topic-0
24-06-20.15:46:31.935 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-20.15:46:31.935 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-20.15:46:31.935 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-20.15:46:31.935 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-006b245c-5752-4ffe-b0fb-3a75f0ce3c71 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.15:46:31.935 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-ba2fcee7-5ac4-4248-9555-5348b49cf60e sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.15:46:31.935 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-3028bb6a-5aba-4ba0-b256-a5cc56b03777 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.15:46:31.938 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.15:46:31.938 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.15:46:31.938 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.15:46:31.938 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.15:46:31.938 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.15:46:31.938 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.15:46:31.938 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.15:46:31.938 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.15:46:31.938 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.15:46:31.939 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.15:46:31.939 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.15:46:31.939 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.15:46:31.939 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.15:46:31.939 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.15:46:31.939 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.15:46:31.958 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.15:46:31.958 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.15:46:31.958 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.15:46:31.958 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.15:46:31.959 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.15:46:31.959 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.15:46:31.959 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.15:46:31.959 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.15:46:31.959 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.15:46:31.964 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-20.15:46:31.964 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-20.15:46:31.965 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-20.15:46:31.965 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-20.15:46:31.965 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-20.15:46:31.965 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-20.15:50:43.484 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 95676 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-20.15:50:43.485 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-20.15:50:43.973 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-20.15:50:43.974 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-20.15:50:43.991 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 10 ms. Found 0 Redis repository interfaces.
24-06-20.15:50:44.374 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-20.15:50:44.378 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-20.15:50:44.378 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-20.15:50:44.378 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-20.15:50:44.419 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-20.15:50:44.419 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 915 ms
24-06-20.15:50:44.799 [main            ] INFO  Version                - Redisson 3.26.0
24-06-20.15:50:44.816 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-20.15:50:44.895 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.15:50:44.902 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.15:50:45.482 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-20.15:50:45.667 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.15:50:45.716 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.15:50:45.717 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.15:50:45.717 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718869845715
24-06-20.15:50:45.726 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-20.15:50:45.736 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.15:50:45.741 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.15:50:45.741 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.15:50:45.741 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718869845741
24-06-20.15:50:45.744 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-20.15:50:45.746 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.15:50:45.750 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.15:50:45.750 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.15:50:45.750 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718869845750
24-06-20.15:50:45.752 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-20.15:50:45.753 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
24-06-20.15:50:45.762 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-20.15:50:45.775 [main            ] INFO  Application            - Started Application in 2.502 seconds (JVM running for 2.786)
24-06-20.15:50:45.903 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-20.15:50:45.903 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-20.15:50:45.903 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-20.15:50:45.904 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.15:50:45.904 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.15:50:45.904 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.15:50:45.905 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.15:50:45.905 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.15:50:45.905 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.15:50:45.907 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.15:50:45.907 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.15:50:45.907 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.15:50:45.918 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-20.15:50:45.918 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-20.15:50:45.918 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-20.15:50:45.918 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.15:50:45.918 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.15:50:45.918 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.15:50:46.242 [RMI TCP Connection(2)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
24-06-20.15:50:46.242 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
24-06-20.15:50:46.243 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 1 ms
24-06-20.15:50:46.243 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.15:50:46.454 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.15:50:46.465 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.15:50:46.488 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.15:50:48.937 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=275, memberId='consumer-sku-clear-group-3-bb263285-612a-4f9c-a0dc-3f6e18661bde', protocol='range'}
24-06-20.15:50:48.937 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=21, memberId='consumer-send-rebate-group-1-fb81dd98-c332-4ec9-aeb7-3a58b48e8c24', protocol='range'}
24-06-20.15:50:48.937 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=273, memberId='consumer-sku-deduct-group-2-f3e1e762-a834-49c7-b4de-2f1a2f730ab7', protocol='range'}
24-06-20.15:50:48.941 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 275: {consumer-sku-clear-group-3-bb263285-612a-4f9c-a0dc-3f6e18661bde=Assignment(partitions=[sku-clear-topic-0])}
24-06-20.15:50:48.941 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 273: {consumer-sku-deduct-group-2-f3e1e762-a834-49c7-b4de-2f1a2f730ab7=Assignment(partitions=[sku-deduct-topic-0])}
24-06-20.15:50:48.941 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 21: {consumer-send-rebate-group-1-fb81dd98-c332-4ec9-aeb7-3a58b48e8c24=Assignment(partitions=[send-rebate-topic-0])}
24-06-20.15:50:48.959 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=21, memberId='consumer-send-rebate-group-1-fb81dd98-c332-4ec9-aeb7-3a58b48e8c24', protocol='range'}
24-06-20.15:50:48.959 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=275, memberId='consumer-sku-clear-group-3-bb263285-612a-4f9c-a0dc-3f6e18661bde', protocol='range'}
24-06-20.15:50:48.959 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=273, memberId='consumer-sku-deduct-group-2-f3e1e762-a834-49c7-b4de-2f1a2f730ab7', protocol='range'}
24-06-20.15:50:48.960 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-20.15:50:48.960 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-20.15:50:48.960 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-20.15:50:48.963 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-20.15:50:48.963 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-20.15:50:48.963 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-20.15:50:48.974 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.15:50:48.974 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Setting offset for partition send-rebate-topic-0 to the committed offset FetchPosition{offset=7, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.15:50:48.974 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=84, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.15:50:48.974 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-20.15:50:48.974 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-20.15:50:48.975 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-20.15:50:48.999 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.15:50:49.060 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.15:50:49.071 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.15:50:49.089 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.15:50:49.102 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.15:50:49.117 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.15:50:49.117 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.15:50:49.502 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.15:50:49.503 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.15:50:49.506 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.15:50:49.520 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.15:50:49.520 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.15:50:50.005 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.15:50:50.005 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.15:50:50.007 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.15:50:50.020 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.15:50:50.021 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.15:50:50.509 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.15:50:50.509 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.15:50:50.515 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.15:50:50.528 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.15:50:50.528 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.15:50:51.013 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.15:50:51.014 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.15:50:51.017 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.15:50:51.028 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.15:50:51.028 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.15:50:51.517 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.15:50:51.517 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.15:50:51.520 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.15:50:51.532 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.15:50:51.533 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.15:50:52.024 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.15:50:52.025 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.15:50:52.033 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.15:50:52.047 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.15:50:52.048 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.15:50:52.531 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.15:50:52.532 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.15:50:52.537 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.15:50:52.548 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.15:50:52.549 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.15:50:53.035 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.15:50:53.036 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.15:50:53.038 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.15:50:53.052 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.15:50:53.052 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.15:50:53.540 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.15:50:53.540 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.15:50:53.544 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.15:50:53.547 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR DefaultErrorHandler    - Backoff FixedBackOff{interval=0, currentAttempts=10, maxAttempts=9} exhausted for send-rebate-topic-0@7
org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.15:50:53.549 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 8 for partition send-rebate-topic-0
24-06-20.15:50:54.043 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_sku_20240618","rebateConfig":"999","rebateDesc":"签到返利-sku额度","rebateType":"sku","userId":"matthew"},"id":"66659538015","timestamp":1718696688011}]
24-06-20.15:50:54.043 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"integral","userId":"matthew"},"id":"52032248913","timestamp":1718696688012}]
24-06-20.15:58:57.639 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Revoke previously assigned partitions sku-clear-topic-0
24-06-20.15:58:57.639 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Revoke previously assigned partitions sku-deduct-topic-0
24-06-20.15:58:57.639 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Revoke previously assigned partitions send-rebate-topic-0
24-06-20.15:58:57.640 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-20.15:58:57.640 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-20.15:58:57.640 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-20.15:58:57.640 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-bb263285-612a-4f9c-a0dc-3f6e18661bde sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.15:58:57.640 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-f3e1e762-a834-49c7-b4de-2f1a2f730ab7 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.15:58:57.640 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-fb81dd98-c332-4ec9-aeb7-3a58b48e8c24 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.15:58:57.643 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.15:58:57.643 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.15:58:57.643 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.15:58:57.643 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.15:58:57.644 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.15:58:57.643 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.15:58:57.644 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.15:58:57.644 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.15:58:57.644 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.15:58:57.646 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.15:58:57.646 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.15:58:57.646 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.15:58:57.647 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.15:58:57.647 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.15:58:57.647 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.15:58:57.665 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.15:58:57.665 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.15:58:57.665 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.15:58:57.665 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.15:58:57.665 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.15:58:57.665 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.15:58:57.669 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.15:58:57.669 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.15:58:57.670 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.15:58:57.672 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-20.15:58:57.673 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-20.15:58:57.673 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-20.15:58:57.673 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-20.15:58:57.673 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-20.15:58:57.674 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-20.15:59:00.927 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 96890 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-20.15:59:00.928 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-20.15:59:01.459 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-20.15:59:01.460 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-20.15:59:01.477 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 10 ms. Found 0 Redis repository interfaces.
24-06-20.15:59:01.944 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-20.15:59:01.949 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-20.15:59:01.949 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-20.15:59:01.949 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-20.15:59:01.988 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-20.15:59:01.988 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1042 ms
24-06-20.15:59:02.328 [main            ] INFO  Version                - Redisson 3.26.0
24-06-20.15:59:02.342 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-20.15:59:02.421 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.15:59:02.430 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.15:59:02.937 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-20.15:59:03.075 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.15:59:03.105 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.15:59:03.105 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.15:59:03.105 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718870343105
24-06-20.15:59:03.112 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-20.15:59:03.118 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.15:59:03.122 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.15:59:03.122 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.15:59:03.122 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718870343122
24-06-20.15:59:03.124 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-20.15:59:03.125 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.15:59:03.128 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.15:59:03.128 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.15:59:03.128 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718870343128
24-06-20.15:59:03.130 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-20.15:59:03.131 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
24-06-20.15:59:03.137 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-20.15:59:03.146 [main            ] INFO  Application            - Started Application in 2.425 seconds (JVM running for 2.671)
24-06-20.15:59:03.273 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-20.15:59:03.273 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-20.15:59:03.273 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-20.15:59:03.274 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.15:59:03.274 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.15:59:03.274 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.15:59:03.275 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.15:59:03.275 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.15:59:03.275 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.15:59:03.278 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.15:59:03.278 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.15:59:03.278 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.15:59:03.287 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-20.15:59:03.287 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-20.15:59:03.287 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-20.15:59:03.287 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.15:59:03.287 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.15:59:03.287 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.15:59:03.724 [RMI TCP Connection(1)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
24-06-20.15:59:03.724 [RMI TCP Connection(1)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
24-06-20.15:59:03.724 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.15:59:03.725 [RMI TCP Connection(1)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 1 ms
24-06-20.15:59:03.870 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.15:59:03.878 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.15:59:03.901 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.15:59:06.300 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=23, memberId='consumer-send-rebate-group-1-a20753ed-a0d2-447f-aebc-6eea826d19ab', protocol='range'}
24-06-20.15:59:06.300 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=275, memberId='consumer-sku-deduct-group-2-b2a195f8-2c18-4ed4-8c5d-4e2cffcd4bd3', protocol='range'}
24-06-20.15:59:06.300 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=277, memberId='consumer-sku-clear-group-3-fa15b1eb-adc5-48e2-b486-e445b491c265', protocol='range'}
24-06-20.15:59:06.305 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 23: {consumer-send-rebate-group-1-a20753ed-a0d2-447f-aebc-6eea826d19ab=Assignment(partitions=[send-rebate-topic-0])}
24-06-20.15:59:06.305 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 277: {consumer-sku-clear-group-3-fa15b1eb-adc5-48e2-b486-e445b491c265=Assignment(partitions=[sku-clear-topic-0])}
24-06-20.15:59:06.305 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 275: {consumer-sku-deduct-group-2-b2a195f8-2c18-4ed4-8c5d-4e2cffcd4bd3=Assignment(partitions=[sku-deduct-topic-0])}
24-06-20.15:59:06.322 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=275, memberId='consumer-sku-deduct-group-2-b2a195f8-2c18-4ed4-8c5d-4e2cffcd4bd3', protocol='range'}
24-06-20.15:59:06.322 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=23, memberId='consumer-send-rebate-group-1-a20753ed-a0d2-447f-aebc-6eea826d19ab', protocol='range'}
24-06-20.15:59:06.322 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=277, memberId='consumer-sku-clear-group-3-fa15b1eb-adc5-48e2-b486-e445b491c265', protocol='range'}
24-06-20.15:59:06.323 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-20.15:59:06.323 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-20.15:59:06.323 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-20.15:59:06.326 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-20.15:59:06.326 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-20.15:59:06.326 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-20.15:59:06.339 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Setting offset for partition send-rebate-topic-0 to the committed offset FetchPosition{offset=7, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.15:59:06.339 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.15:59:06.339 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=84, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.15:59:06.340 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-20.15:59:06.340 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-20.15:59:06.340 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-20.15:59:06.368 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.15:59:06.420 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.15:59:06.428 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.15:59:06.449 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.15:59:06.462 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:55)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.15:59:06.476 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.15:59:06.476 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:55)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.15:59:06.871 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.15:59:06.872 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.15:59:06.876 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:55)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.15:59:06.889 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.15:59:06.890 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:55)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.15:59:07.375 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.15:59:07.375 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.15:59:07.377 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:55)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.15:59:07.389 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.15:59:07.390 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:55)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.15:59:07.880 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.15:59:07.880 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.15:59:07.884 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:55)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.15:59:07.896 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.15:59:07.896 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:55)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.15:59:08.386 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.15:59:08.386 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.15:59:08.391 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:55)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.15:59:08.404 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.15:59:08.404 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:55)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.15:59:08.890 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.15:59:08.891 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.15:59:08.896 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:55)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.15:59:08.907 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.15:59:08.908 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:55)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.15:59:09.399 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.15:59:09.400 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.15:59:09.406 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:55)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.15:59:09.419 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.15:59:09.420 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:55)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.15:59:09.905 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.15:59:09.905 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.15:59:09.909 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:55)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.15:59:09.922 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.15:59:09.922 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:55)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.15:59:10.412 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.15:59:10.413 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.15:59:10.419 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:55)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.15:59:10.432 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.15:59:10.433 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:55)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.15:59:10.917 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.15:59:10.918 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.15:59:10.921 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:55)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.15:59:10.923 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR DefaultErrorHandler    - Backoff FixedBackOff{interval=0, currentAttempts=10, maxAttempts=9} exhausted for send-rebate-topic-0@7
org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:55)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.15:59:10.923 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 8 for partition send-rebate-topic-0
24-06-20.15:59:11.422 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_sku_20240618","rebateConfig":"999","rebateDesc":"签到返利-sku额度","rebateType":"sku","userId":"matthew"},"id":"66659538015","timestamp":1718696688011}]
24-06-20.15:59:11.422 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户行为返利消息 - 非 sku 奖励暂时不处理 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_sku_20240618","rebateConfig":"999","rebateDesc":"签到返利-sku额度","rebateType":"sku","userId":"matthew"},"id":"66659538015","timestamp":1718696688011}]
24-06-20.15:59:11.422 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"integral","userId":"matthew"},"id":"52032248913","timestamp":1718696688012}]
24-06-20.15:59:11.423 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户行为返利消息 - 非 sku 奖励暂时不处理 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"integral","userId":"matthew"},"id":"52032248913","timestamp":1718696688012}]
24-06-20.16:02:00.080 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Revoke previously assigned partitions sku-deduct-topic-0
24-06-20.16:02:00.081 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-20.16:02:00.080 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Revoke previously assigned partitions sku-clear-topic-0
24-06-20.16:02:00.081 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-20.16:02:00.082 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-b2a195f8-2c18-4ed4-8c5d-4e2cffcd4bd3 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.16:02:00.080 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Revoke previously assigned partitions send-rebate-topic-0
24-06-20.16:02:00.082 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-fa15b1eb-adc5-48e2-b486-e445b491c265 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.16:02:00.083 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-20.16:02:00.083 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-a20753ed-a0d2-447f-aebc-6eea826d19ab sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.16:02:00.084 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:02:00.084 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:02:00.084 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:02:00.084 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:02:00.084 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.16:02:00.084 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.16:02:00.084 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:02:00.085 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:02:00.085 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.16:02:00.088 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:02:00.088 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:02:00.092 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:02:00.092 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:02:00.093 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:02:00.093 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:02:00.104 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.16:02:00.104 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.16:02:00.105 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.16:02:00.105 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.16:02:00.106 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.16:02:00.107 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.16:02:00.108 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.16:02:00.108 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.16:02:00.108 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.16:02:00.110 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-20.16:02:00.111 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-20.16:02:00.113 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-20.16:02:00.113 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-20.16:02:00.114 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-20.16:02:00.114 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-20.16:02:03.419 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 97342 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-20.16:02:03.420 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-20.16:02:03.887 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-20.16:02:03.888 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-20.16:02:03.905 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 10 ms. Found 0 Redis repository interfaces.
24-06-20.16:02:04.270 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-20.16:02:04.274 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-20.16:02:04.274 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-20.16:02:04.274 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-20.16:02:04.312 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-20.16:02:04.312 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 873 ms
24-06-20.16:02:04.645 [main            ] INFO  Version                - Redisson 3.26.0
24-06-20.16:02:04.660 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-20.16:02:04.728 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.16:02:04.738 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.16:02:05.243 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-20.16:02:05.371 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.16:02:05.402 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.16:02:05.402 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.16:02:05.402 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718870525402
24-06-20.16:02:05.409 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-20.16:02:05.414 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.16:02:05.418 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.16:02:05.418 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.16:02:05.418 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718870525418
24-06-20.16:02:05.421 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-20.16:02:05.422 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.16:02:05.424 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.16:02:05.424 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.16:02:05.424 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718870525424
24-06-20.16:02:05.426 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-20.16:02:05.427 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
24-06-20.16:02:05.432 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-20.16:02:05.441 [main            ] INFO  Application            - Started Application in 2.249 seconds (JVM running for 2.585)
24-06-20.16:02:05.591 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.16:02:05.600 [RMI TCP Connection(2)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
24-06-20.16:02:05.600 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
24-06-20.16:02:05.604 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 4 ms
24-06-20.16:02:05.612 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-20.16:02:05.612 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-20.16:02:05.613 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.16:02:05.613 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.16:02:05.615 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-20.16:02:05.615 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.16:02:05.616 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.16:02:05.616 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.16:02:05.616 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.16:02:05.619 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.16:02:05.619 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.16:02:05.620 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.16:02:05.633 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-20.16:02:05.633 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-20.16:02:05.634 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.16:02:05.634 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.16:02:05.635 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-20.16:02:05.636 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.16:02:05.769 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.16:02:05.776 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.16:02:05.796 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.16:02:08.644 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=277, memberId='consumer-sku-deduct-group-2-40695c87-2738-48b9-835d-c11da49c11a5', protocol='range'}
24-06-20.16:02:08.644 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=25, memberId='consumer-send-rebate-group-1-414cb48b-f109-4c76-ba36-9937189f1895', protocol='range'}
24-06-20.16:02:08.645 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=279, memberId='consumer-sku-clear-group-3-325069fb-cfaf-44fe-8cb9-7376d3f42ff3', protocol='range'}
24-06-20.16:02:08.650 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 277: {consumer-sku-deduct-group-2-40695c87-2738-48b9-835d-c11da49c11a5=Assignment(partitions=[sku-deduct-topic-0])}
24-06-20.16:02:08.650 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 279: {consumer-sku-clear-group-3-325069fb-cfaf-44fe-8cb9-7376d3f42ff3=Assignment(partitions=[sku-clear-topic-0])}
24-06-20.16:02:08.650 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 25: {consumer-send-rebate-group-1-414cb48b-f109-4c76-ba36-9937189f1895=Assignment(partitions=[send-rebate-topic-0])}
24-06-20.16:02:08.666 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=25, memberId='consumer-send-rebate-group-1-414cb48b-f109-4c76-ba36-9937189f1895', protocol='range'}
24-06-20.16:02:08.666 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=279, memberId='consumer-sku-clear-group-3-325069fb-cfaf-44fe-8cb9-7376d3f42ff3', protocol='range'}
24-06-20.16:02:08.666 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=277, memberId='consumer-sku-deduct-group-2-40695c87-2738-48b9-835d-c11da49c11a5', protocol='range'}
24-06-20.16:02:08.666 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-20.16:02:08.666 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-20.16:02:08.666 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-20.16:02:08.670 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-20.16:02:08.670 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-20.16:02:08.670 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-20.16:02:08.684 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Setting offset for partition send-rebate-topic-0 to the committed offset FetchPosition{offset=7, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.16:02:08.684 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.16:02:08.684 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=84, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.16:02:08.685 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-20.16:02:08.685 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-20.16:02:08.685 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-20.16:02:08.714 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.16:02:08.765 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.16:02:08.774 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.16:02:08.794 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.16:02:08.810 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:56)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.16:02:08.825 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.16:02:08.825 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:56)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.16:02:09.217 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.16:02:09.218 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.16:02:09.222 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:56)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.16:02:09.235 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.16:02:09.236 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:56)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.16:02:09.723 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.16:02:09.723 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.16:02:09.728 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:56)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.16:02:09.741 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.16:02:09.742 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:56)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.16:02:10.230 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.16:02:10.230 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.16:02:10.236 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:56)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.16:02:10.248 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.16:02:10.249 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:56)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.16:02:10.737 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.16:02:10.738 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.16:02:10.743 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:56)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.16:02:10.756 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.16:02:10.757 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:56)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.16:02:11.243 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.16:02:11.243 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.16:02:11.249 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:56)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.16:02:11.262 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.16:02:11.263 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:56)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.16:02:11.747 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.16:02:11.748 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.16:02:11.754 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:56)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.16:02:11.767 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.16:02:11.768 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:56)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.16:02:12.255 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.16:02:12.255 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.16:02:12.261 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:56)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.16:02:12.274 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.16:02:12.275 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:56)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.16:02:12.762 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.16:02:12.763 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.16:02:12.768 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:56)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.16:02:12.780 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-20.16:02:12.781 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:56)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.16:02:13.265 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.16:02:13.265 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-20.16:02:13.268 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:56)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.16:02:13.270 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR DefaultErrorHandler    - Backoff FixedBackOff{interval=0, currentAttempts=10, maxAttempts=9} exhausted for send-rebate-topic-0@7
org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:42)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:56)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-20.16:02:13.284 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 8 for partition send-rebate-topic-0
24-06-20.16:02:13.769 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_sku_20240618","rebateConfig":"999","rebateDesc":"签到返利-sku额度","rebateType":"sku","userId":"matthew"},"id":"66659538015","timestamp":1718696688011}]
24-06-20.16:02:13.770 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - rebateMessage:sku,
24-06-20.16:02:13.770 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户行为返利消息 - 非 sku 奖励暂时不处理 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_sku_20240618","rebateConfig":"999","rebateDesc":"签到返利-sku额度","rebateType":"sku","userId":"matthew"},"id":"66659538015","timestamp":1718696688011}]
24-06-20.16:02:13.770 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"integral","userId":"matthew"},"id":"52032248913","timestamp":1718696688012}]
24-06-20.16:02:13.770 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - rebateMessage:integral,
24-06-20.16:02:13.770 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户行为返利消息 - 非 sku 奖励暂时不处理 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"integral","userId":"matthew"},"id":"52032248913","timestamp":1718696688012}]
24-06-20.16:04:42.011 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Revoke previously assigned partitions send-rebate-topic-0
24-06-20.16:04:42.011 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Revoke previously assigned partitions sku-clear-topic-0
24-06-20.16:04:42.011 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Revoke previously assigned partitions sku-deduct-topic-0
24-06-20.16:04:42.014 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-20.16:04:42.014 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-20.16:04:42.014 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-20.16:04:42.015 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-414cb48b-f109-4c76-ba36-9937189f1895 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.16:04:42.015 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-325069fb-cfaf-44fe-8cb9-7376d3f42ff3 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.16:04:42.015 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-40695c87-2738-48b9-835d-c11da49c11a5 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.16:04:42.018 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:04:42.018 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:04:42.018 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:04:42.018 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:04:42.018 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:04:42.018 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.16:04:42.018 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:04:42.018 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.16:04:42.018 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.16:04:42.023 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:04:42.023 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:04:42.023 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:04:42.023 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:04:42.024 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:04:42.024 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:04:42.063 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.16:04:42.063 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.16:04:42.063 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.16:04:42.063 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.16:04:42.063 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.16:04:42.063 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.16:04:42.074 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.16:04:42.074 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.16:04:42.075 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.16:04:42.078 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-20.16:04:42.078 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-20.16:04:42.078 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-20.16:04:42.078 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-20.16:04:42.079 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-20.16:04:42.079 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-20.16:04:45.720 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 97778 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-20.16:04:45.721 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-20.16:04:46.200 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-20.16:04:46.201 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-20.16:04:46.219 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 10 ms. Found 0 Redis repository interfaces.
24-06-20.16:04:46.734 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-20.16:04:46.739 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-20.16:04:46.740 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-20.16:04:46.740 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-20.16:04:46.798 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-20.16:04:46.798 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1057 ms
24-06-20.16:04:47.191 [main            ] INFO  Version                - Redisson 3.26.0
24-06-20.16:04:47.207 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-20.16:04:47.290 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.16:04:47.298 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.16:04:47.849 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-20.16:04:48.000 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.16:04:48.036 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.16:04:48.036 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.16:04:48.036 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718870688035
24-06-20.16:04:48.044 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-20.16:04:48.051 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.16:04:48.055 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.16:04:48.055 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.16:04:48.055 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718870688055
24-06-20.16:04:48.058 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-20.16:04:48.059 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.16:04:48.063 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.16:04:48.063 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.16:04:48.063 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718870688063
24-06-20.16:04:48.066 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-20.16:04:48.067 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
24-06-20.16:04:48.074 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-20.16:04:48.083 [main            ] INFO  Application            - Started Application in 2.568 seconds (JVM running for 2.824)
24-06-20.16:04:48.222 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-20.16:04:48.222 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-20.16:04:48.222 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-20.16:04:48.222 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.16:04:48.222 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.16:04:48.222 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.16:04:48.223 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.16:04:48.223 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.16:04:48.223 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.16:04:48.226 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.16:04:48.226 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.16:04:48.226 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.16:04:48.237 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-20.16:04:48.237 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-20.16:04:48.237 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-20.16:04:48.237 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.16:04:48.237 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.16:04:48.237 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.16:04:48.552 [RMI TCP Connection(4)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
24-06-20.16:04:48.552 [RMI TCP Connection(4)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
24-06-20.16:04:48.553 [RMI TCP Connection(5)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.16:04:48.553 [RMI TCP Connection(4)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 1 ms
24-06-20.16:04:48.708 [RMI TCP Connection(5)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.16:04:48.717 [RMI TCP Connection(5)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.16:04:48.737 [RMI TCP Connection(5)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.16:04:51.247 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=27, memberId='consumer-send-rebate-group-1-68b5e69d-d6d3-419a-936d-da1208959358', protocol='range'}
24-06-20.16:04:51.248 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=281, memberId='consumer-sku-clear-group-3-cff47766-435d-4bcc-9603-f4ee95be854e', protocol='range'}
24-06-20.16:04:51.247 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=279, memberId='consumer-sku-deduct-group-2-96450a25-ce16-40e4-98f6-ff67042e9a04', protocol='range'}
24-06-20.16:04:51.253 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 281: {consumer-sku-clear-group-3-cff47766-435d-4bcc-9603-f4ee95be854e=Assignment(partitions=[sku-clear-topic-0])}
24-06-20.16:04:51.253 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 27: {consumer-send-rebate-group-1-68b5e69d-d6d3-419a-936d-da1208959358=Assignment(partitions=[send-rebate-topic-0])}
24-06-20.16:04:51.253 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 279: {consumer-sku-deduct-group-2-96450a25-ce16-40e4-98f6-ff67042e9a04=Assignment(partitions=[sku-deduct-topic-0])}
24-06-20.16:04:51.271 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=27, memberId='consumer-send-rebate-group-1-68b5e69d-d6d3-419a-936d-da1208959358', protocol='range'}
24-06-20.16:04:51.271 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-20.16:04:51.273 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=279, memberId='consumer-sku-deduct-group-2-96450a25-ce16-40e4-98f6-ff67042e9a04', protocol='range'}
24-06-20.16:04:51.273 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=281, memberId='consumer-sku-clear-group-3-cff47766-435d-4bcc-9603-f4ee95be854e', protocol='range'}
24-06-20.16:04:51.273 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-20.16:04:51.273 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-20.16:04:51.274 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-20.16:04:51.274 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-20.16:04:51.274 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-20.16:04:51.287 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=84, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.16:04:51.287 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Setting offset for partition send-rebate-topic-0 to the committed offset FetchPosition{offset=7, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.16:04:51.287 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.16:04:51.288 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-20.16:04:51.288 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-20.16:04:51.288 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-20.16:04:51.315 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.16:04:51.366 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - rebateMessage:sign,
24-06-20.16:04:51.366 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户行为返利消息 - 非 sku 奖励暂时不处理 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.16:04:51.366 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_sku_20240618","rebateConfig":"999","rebateDesc":"签到返利-sku额度","rebateType":"sku","userId":"matthew"},"id":"66659538015","timestamp":1718696688011}]
24-06-20.16:04:51.366 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 999 outBusinessNo: matthew_sku_20240618
24-06-20.16:04:51.375 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.16:04:51.393 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.16:04:51.424 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单 SKU 查询结果：{"activityCountId":100001,"activityId":100001,"sku":999,"stockCount":1000000,"stockCountSurplus":999996} {"activityId":100001,"activityName":"测试活动","beginDateTime":1709979310000,"endDateTime":2025512110000,"state":"open","strategyId":100006} {"activityCountId":100001,"dayCount":1,"monthCount":1,"totalCount":1}
24-06-20.16:04:51.424 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ActivityBaseChainNode  - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:999 activityId:100001
24-06-20.16:04:51.424 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ActivitySkuStockActionChainNode - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:999 activityId:100001
24-06-20.16:04:51.427 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ActivitySkuStockActionChainNode - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:999 activityId:100001
24-06-20.16:04:51.432 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ProducerConfig         - Idempotence will be disabled because acks is set to 1, not set to 'all'.
24-06-20.16:04:51.432 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ProducerConfig         - ProducerConfig values: 
	acks = 1
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-1
	compression.type = none
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = false
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.class = class org.apache.kafka.clients.producer.internals.DefaultPartitioner
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 1
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

24-06-20.16:04:51.438 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.16:04:51.438 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.16:04:51.438 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - Kafka startTimeMs: 1718870691438
24-06-20.16:04:51.441 [kafka-producer-network-thread | producer-1] INFO  Metadata               - [Producer clientId=producer-1] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.16:04:51.443 [kafka-producer-network-thread | producer-1] INFO  Metadata               - [Producer clientId=producer-1] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-20.16:04:51.447 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  EventPublisher         - 发送MQ消息 topic:sku-deduct-topic message:{"data":{"activityId":100001,"sku":999},"id":"90525959654","timestamp":1718870691428}
24-06-20.16:04:51.505 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR ActivityRepository     - 写入订单记录，唯一索引冲突 userId: matthew activityId: 100001 sku: 999
org.springframework.dao.DuplicateKeyException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'matthew_sku_20240618' for key 'raffle_activity_order_000.uq_out_business_no'
### The error may exist in file [/Users/matthew/Desktop/lottery/lottery-app/target/classes/mybatis/mapper/ActivityOrderMapper.xml]
### The error may involve cn.matthew.infrastructure.persistent.dao.IRaffleActivityOrderDao.insert-Inline
### The error occurred while setting parameters
### SQL: insert into raffle_activity_order_000         (user_id, sku, activity_id, activity_name, strategy_id, order_id, order_time, state, out_business_no, total_count, day_count, month_count,          create_time, update_time)         values             (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,              now(), now())
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'matthew_sku_20240618' for key 'raffle_activity_order_000.uq_out_business_no'
; Duplicate entry 'matthew_sku_20240618' for key 'raffle_activity_order_000.uq_out_business_no'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'matthew_sku_20240618' for key 'raffle_activity_order_000.uq_out_business_no'
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:247)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy104.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy115.insert(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.bugstack.middleware.db.router.DBRouterJoinPoint.doRouter(DBRouterJoinPoint.java:65)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:220)
	at com.sun.proxy.$Proxy116.insert(Unknown Source)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.lambda$doSaveOrder$0(ActivityRepository.java:209)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.doSaveOrder(ActivityRepository.java:206)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.doSaveOrder(<generated>)
	at cn.matthew.domain.activity.service.ActivityService.doSaveOrder(ActivityService.java:70)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:56)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:56)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'matthew_sku_20240618' for key 'raffle_activity_order_000.uq_out_business_no'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy178.update(Unknown Source)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 65 common frames omitted
24-06-20.16:04:51.511 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ActivitySkuStockConsumeMessageListener - Kafka库存扣减消费成功! Topic:sku-deduct-topic,Message:{"data":{"activityId":100001,"sku":999},"id":"90525959654","timestamp":1718870691428}
24-06-20.16:04:51.514 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] WARN  RebateMessageListener  - 监听用户行为返利消息，消费重复 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_sku_20240618","rebateConfig":"999","rebateDesc":"签到返利-sku额度","rebateType":"sku","userId":"matthew"},"id":"66659538015","timestamp":1718696688011}]
cn.matthew.types.exception.AppException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.lambda$doSaveOrder$0(ActivityRepository.java:224)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.doSaveOrder(ActivityRepository.java:206)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.doSaveOrder(<generated>)
	at cn.matthew.domain.activity.service.ActivityService.doSaveOrder(ActivityService.java:70)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivityService.java:56)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:56)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.dao.DuplicateKeyException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'matthew_sku_20240618' for key 'raffle_activity_order_000.uq_out_business_no'
### The error may exist in file [/Users/matthew/Desktop/lottery/lottery-app/target/classes/mybatis/mapper/ActivityOrderMapper.xml]
### The error may involve cn.matthew.infrastructure.persistent.dao.IRaffleActivityOrderDao.insert-Inline
### The error occurred while setting parameters
### SQL: insert into raffle_activity_order_000         (user_id, sku, activity_id, activity_name, strategy_id, order_id, order_time, state, out_business_no, total_count, day_count, month_count,          create_time, update_time)         values             (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,              now(), now())
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'matthew_sku_20240618' for key 'raffle_activity_order_000.uq_out_business_no'
; Duplicate entry 'matthew_sku_20240618' for key 'raffle_activity_order_000.uq_out_business_no'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'matthew_sku_20240618' for key 'raffle_activity_order_000.uq_out_business_no'
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:247)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy104.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy115.insert(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.bugstack.middleware.db.router.DBRouterJoinPoint.doRouter(DBRouterJoinPoint.java:65)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:220)
	at com.sun.proxy.$Proxy116.insert(Unknown Source)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.lambda$doSaveOrder$0(ActivityRepository.java:209)
	... 37 common frames omitted
Caused by: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'matthew_sku_20240618' for key 'raffle_activity_order_000.uq_out_business_no'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy178.update(Unknown Source)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 65 common frames omitted
24-06-20.16:04:51.514 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"integral","userId":"matthew"},"id":"52032248913","timestamp":1718696688012}]
24-06-20.16:04:51.515 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - rebateMessage:integral,
24-06-20.16:04:51.515 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户行为返利消息 - 非 sku 奖励暂时不处理 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"integral","userId":"matthew"},"id":"52032248913","timestamp":1718696688012}]
24-06-20.16:07:19.568 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Revoke previously assigned partitions sku-deduct-topic-0
24-06-20.16:07:19.568 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Revoke previously assigned partitions send-rebate-topic-0
24-06-20.16:07:19.568 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Revoke previously assigned partitions sku-clear-topic-0
24-06-20.16:07:19.568 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-20.16:07:19.568 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-20.16:07:19.568 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-20.16:07:19.569 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-96450a25-ce16-40e4-98f6-ff67042e9a04 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.16:07:19.569 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-68b5e69d-d6d3-419a-936d-da1208959358 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.16:07:19.569 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-cff47766-435d-4bcc-9603-f4ee95be854e sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.16:07:19.571 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:07:19.571 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:07:19.571 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:07:19.571 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:07:19.571 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.16:07:19.571 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:07:19.571 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.16:07:19.571 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:07:19.571 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.16:07:19.573 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:07:19.573 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:07:19.574 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:07:19.574 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:07:19.574 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:07:19.574 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:07:19.589 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.16:07:19.589 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.16:07:19.589 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.16:07:19.589 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.16:07:19.589 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.16:07:19.589 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.16:07:19.589 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.16:07:19.589 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.16:07:19.589 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.16:07:19.593 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-20.16:07:19.593 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-20.16:07:19.594 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-20.16:07:19.594 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-20.16:07:19.594 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-20.16:07:19.594 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-20.16:07:19.599 [SpringApplicationShutdownHook] INFO  KafkaProducer          - [Producer clientId=producer-1] Closing the Kafka producer with timeoutMillis = 30000 ms.
24-06-20.16:07:19.600 [SpringApplicationShutdownHook] INFO  Metrics                - Metrics scheduler closed
24-06-20.16:07:19.600 [SpringApplicationShutdownHook] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.16:07:19.600 [SpringApplicationShutdownHook] INFO  Metrics                - Metrics reporters closed
24-06-20.16:07:19.601 [SpringApplicationShutdownHook] INFO  AppInfoParser          - App info kafka.producer for producer-1 unregistered
24-06-20.16:08:23.943 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 98335 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-20.16:08:23.944 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-20.16:08:24.428 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-20.16:08:24.429 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-20.16:08:24.446 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 10 ms. Found 0 Redis repository interfaces.
24-06-20.16:08:24.905 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-20.16:08:24.909 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-20.16:08:24.909 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-20.16:08:24.910 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-20.16:08:24.954 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-20.16:08:24.954 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 991 ms
24-06-20.16:08:25.306 [main            ] INFO  Version                - Redisson 3.26.0
24-06-20.16:08:25.325 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-20.16:08:25.403 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.16:08:25.411 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.16:08:25.942 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-20.16:08:26.072 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.16:08:26.105 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.16:08:26.105 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.16:08:26.105 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718870906104
24-06-20.16:08:26.112 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-20.16:08:26.118 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.16:08:26.122 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.16:08:26.122 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.16:08:26.122 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718870906122
24-06-20.16:08:26.126 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-20.16:08:26.127 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.16:08:26.131 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.16:08:26.131 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.16:08:26.131 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718870906131
24-06-20.16:08:26.134 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-20.16:08:26.135 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
24-06-20.16:08:26.141 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-20.16:08:26.151 [main            ] INFO  Application            - Started Application in 2.415 seconds (JVM running for 2.707)
24-06-20.16:08:26.261 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.16:08:26.261 [RMI TCP Connection(3)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
24-06-20.16:08:26.261 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
24-06-20.16:08:26.262 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 1 ms
24-06-20.16:08:26.303 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-20.16:08:26.303 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-20.16:08:26.303 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-20.16:08:26.304 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.16:08:26.304 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.16:08:26.304 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.16:08:26.305 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.16:08:26.305 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.16:08:26.305 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.16:08:26.307 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.16:08:26.307 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.16:08:26.308 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.16:08:26.320 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-20.16:08:26.320 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-20.16:08:26.320 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-20.16:08:26.321 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.16:08:26.321 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.16:08:26.321 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.16:08:26.421 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.16:08:26.433 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.16:08:26.451 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.16:08:29.331 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=281, memberId='consumer-sku-deduct-group-2-86c2d6f7-0fb1-490e-b344-06a54b591556', protocol='range'}
24-06-20.16:08:29.331 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=29, memberId='consumer-send-rebate-group-1-57f9b9a7-12ab-4919-83a3-321708dd2f94', protocol='range'}
24-06-20.16:08:29.331 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=283, memberId='consumer-sku-clear-group-3-82bfbc01-a847-4d2e-a89d-2886b1a20692', protocol='range'}
24-06-20.16:08:29.336 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 283: {consumer-sku-clear-group-3-82bfbc01-a847-4d2e-a89d-2886b1a20692=Assignment(partitions=[sku-clear-topic-0])}
24-06-20.16:08:29.336 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 29: {consumer-send-rebate-group-1-57f9b9a7-12ab-4919-83a3-321708dd2f94=Assignment(partitions=[send-rebate-topic-0])}
24-06-20.16:08:29.336 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 281: {consumer-sku-deduct-group-2-86c2d6f7-0fb1-490e-b344-06a54b591556=Assignment(partitions=[sku-deduct-topic-0])}
24-06-20.16:08:29.357 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=283, memberId='consumer-sku-clear-group-3-82bfbc01-a847-4d2e-a89d-2886b1a20692', protocol='range'}
24-06-20.16:08:29.357 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=29, memberId='consumer-send-rebate-group-1-57f9b9a7-12ab-4919-83a3-321708dd2f94', protocol='range'}
24-06-20.16:08:29.357 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=281, memberId='consumer-sku-deduct-group-2-86c2d6f7-0fb1-490e-b344-06a54b591556', protocol='range'}
24-06-20.16:08:29.357 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-20.16:08:29.357 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-20.16:08:29.357 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-20.16:08:29.361 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-20.16:08:29.361 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-20.16:08:29.361 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-20.16:08:29.374 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=85, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.16:08:29.374 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Setting offset for partition send-rebate-topic-0 to the committed offset FetchPosition{offset=7, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.16:08:29.374 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.16:08:29.375 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-20.16:08:29.375 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-20.16:08:29.375 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-20.16:08:29.404 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.16:08:29.454 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户行为返利消息 - 非 sku 奖励暂时不处理 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-20.16:08:29.455 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_sku_20240618","rebateConfig":"999","rebateDesc":"签到返利-sku额度","rebateType":"sku","userId":"matthew"},"id":"66659538015","timestamp":1718696688011}]
24-06-20.16:08:29.455 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 999 outBusinessNo: matthew_sku_20240618
24-06-20.16:08:29.471 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.16:08:29.488 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.16:08:29.519 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单 SKU 查询结果：{"activityCountId":100001,"activityId":100001,"sku":999,"stockCount":1000000,"stockCountSurplus":999995} {"activityId":100001,"activityName":"测试活动","beginDateTime":1709979310000,"endDateTime":2025512110000,"state":"open","strategyId":100006} {"activityCountId":100001,"dayCount":1,"monthCount":1,"totalCount":1}
24-06-20.16:08:29.519 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ActivityBaseChainNode  - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:999 activityId:100001
24-06-20.16:08:29.519 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ActivitySkuStockActionChainNode - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:999 activityId:100001
24-06-20.16:08:29.522 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ActivitySkuStockActionChainNode - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:999 activityId:100001
24-06-20.16:08:29.526 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ProducerConfig         - Idempotence will be disabled because acks is set to 1, not set to 'all'.
24-06-20.16:08:29.526 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ProducerConfig         - ProducerConfig values: 
	acks = 1
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-1
	compression.type = none
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = false
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.class = class org.apache.kafka.clients.producer.internals.DefaultPartitioner
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 1
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

24-06-20.16:08:29.533 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.16:08:29.533 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.16:08:29.533 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - Kafka startTimeMs: 1718870909533
24-06-20.16:08:29.535 [kafka-producer-network-thread | producer-1] INFO  Metadata               - [Producer clientId=producer-1] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.16:08:29.538 [kafka-producer-network-thread | producer-1] INFO  Metadata               - [Producer clientId=producer-1] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-20.16:08:29.542 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  EventPublisher         - 发送MQ消息 topic:sku-deduct-topic message:{"data":{"activityId":100001,"sku":999},"id":"97106092329","timestamp":1718870909523}
24-06-20.16:08:29.573 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ActivitySkuStockConsumeMessageListener - Kafka库存扣减消费成功! Topic:sku-deduct-topic,Message:{"data":{"activityId":100001,"sku":999},"id":"97106092329","timestamp":1718870909523}
24-06-20.16:08:29.574 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户行为返利消息消费成功! Topic:send-rebate-topic,Message:{"data":{"bizId":"matthew_sku_20240618","rebateConfig":"999","rebateDesc":"签到返利-sku额度","rebateType":"sku","userId":"matthew"},"id":"66659538015","timestamp":1718696688011}
24-06-20.16:08:29.575 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"integral","userId":"matthew"},"id":"52032248913","timestamp":1718696688012}]
24-06-20.16:08:29.575 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户行为返利消息 - 非 sku 奖励暂时不处理 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"integral","userId":"matthew"},"id":"52032248913","timestamp":1718696688012}]
24-06-20.16:11:17.062 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Revoke previously assigned partitions send-rebate-topic-0
24-06-20.16:11:17.062 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Revoke previously assigned partitions sku-deduct-topic-0
24-06-20.16:11:17.062 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Revoke previously assigned partitions sku-clear-topic-0
24-06-20.16:11:17.063 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-20.16:11:17.063 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-20.16:11:17.063 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-20.16:11:17.063 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-57f9b9a7-12ab-4919-83a3-321708dd2f94 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.16:11:17.063 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-86c2d6f7-0fb1-490e-b344-06a54b591556 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.16:11:17.063 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-82bfbc01-a847-4d2e-a89d-2886b1a20692 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.16:11:17.067 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:11:17.067 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:11:17.067 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:11:17.067 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:11:17.067 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.16:11:17.067 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:11:17.067 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.16:11:17.067 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:11:17.067 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.16:11:17.068 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:11:17.069 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:11:17.069 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:11:17.069 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:11:17.069 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:11:17.069 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:11:17.083 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.16:11:17.083 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.16:11:17.083 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.16:11:17.083 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.16:11:17.083 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.16:11:17.083 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.16:11:17.084 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.16:11:17.084 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.16:11:17.084 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.16:11:17.089 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-20.16:11:17.089 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-20.16:11:17.090 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-20.16:11:17.090 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-20.16:11:17.091 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-20.16:11:17.091 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-20.16:11:17.097 [SpringApplicationShutdownHook] INFO  KafkaProducer          - [Producer clientId=producer-1] Closing the Kafka producer with timeoutMillis = 30000 ms.
24-06-20.16:11:17.099 [SpringApplicationShutdownHook] INFO  Metrics                - Metrics scheduler closed
24-06-20.16:11:17.099 [SpringApplicationShutdownHook] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.16:11:17.099 [SpringApplicationShutdownHook] INFO  Metrics                - Metrics reporters closed
24-06-20.16:11:17.099 [SpringApplicationShutdownHook] INFO  AppInfoParser          - App info kafka.producer for producer-1 unregistered
24-06-20.16:11:20.483 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 98787 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-20.16:11:20.485 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-20.16:11:21.008 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-20.16:11:21.014 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-20.16:11:21.035 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 13 ms. Found 0 Redis repository interfaces.
24-06-20.16:11:21.463 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-20.16:11:21.467 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-20.16:11:21.467 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-20.16:11:21.468 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-20.16:11:21.508 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-20.16:11:21.508 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1001 ms
24-06-20.16:11:21.872 [main            ] INFO  Version                - Redisson 3.26.0
24-06-20.16:11:21.886 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-20.16:11:21.952 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.16:11:21.960 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.16:11:22.511 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-20.16:11:22.645 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.16:11:22.678 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.16:11:22.678 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.16:11:22.678 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718871082678
24-06-20.16:11:22.686 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-20.16:11:22.692 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.16:11:22.695 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.16:11:22.695 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.16:11:22.695 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718871082695
24-06-20.16:11:22.699 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-20.16:11:22.700 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.16:11:22.703 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.16:11:22.703 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.16:11:22.703 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718871082703
24-06-20.16:11:22.705 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-20.16:11:22.706 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
24-06-20.16:11:22.712 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-20.16:11:22.721 [main            ] INFO  Application            - Started Application in 2.499 seconds (JVM running for 2.774)
24-06-20.16:11:22.853 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-20.16:11:22.853 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-20.16:11:22.853 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-20.16:11:22.854 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.16:11:22.854 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.16:11:22.854 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.16:11:22.854 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.16:11:22.854 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.16:11:22.854 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.16:11:22.857 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.16:11:22.857 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.16:11:22.857 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.16:11:22.868 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-20.16:11:22.868 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-20.16:11:22.868 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-20.16:11:22.868 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.16:11:22.868 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.16:11:22.868 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.16:11:23.263 [RMI TCP Connection(3)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
24-06-20.16:11:23.263 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
24-06-20.16:11:23.263 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.16:11:23.264 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 1 ms
24-06-20.16:11:23.409 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.16:11:23.417 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.16:11:23.435 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.16:11:25.873 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=285, memberId='consumer-sku-clear-group-3-16c4c4c8-056f-4f34-b6cf-078f8d0760a8', protocol='range'}
24-06-20.16:11:25.873 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=31, memberId='consumer-send-rebate-group-1-ac3336e7-3763-421e-b777-ab0148fa7b25', protocol='range'}
24-06-20.16:11:25.873 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=283, memberId='consumer-sku-deduct-group-2-04aaa95d-e754-4b3e-a220-fd67e380a888', protocol='range'}
24-06-20.16:11:25.877 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 285: {consumer-sku-clear-group-3-16c4c4c8-056f-4f34-b6cf-078f8d0760a8=Assignment(partitions=[sku-clear-topic-0])}
24-06-20.16:11:25.877 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 283: {consumer-sku-deduct-group-2-04aaa95d-e754-4b3e-a220-fd67e380a888=Assignment(partitions=[sku-deduct-topic-0])}
24-06-20.16:11:25.877 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 31: {consumer-send-rebate-group-1-ac3336e7-3763-421e-b777-ab0148fa7b25=Assignment(partitions=[send-rebate-topic-0])}
24-06-20.16:11:25.887 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=283, memberId='consumer-sku-deduct-group-2-04aaa95d-e754-4b3e-a220-fd67e380a888', protocol='range'}
24-06-20.16:11:25.887 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=31, memberId='consumer-send-rebate-group-1-ac3336e7-3763-421e-b777-ab0148fa7b25', protocol='range'}
24-06-20.16:11:25.887 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=285, memberId='consumer-sku-clear-group-3-16c4c4c8-056f-4f34-b6cf-078f8d0760a8', protocol='range'}
24-06-20.16:11:25.887 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-20.16:11:25.887 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-20.16:11:25.887 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-20.16:11:25.889 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-20.16:11:25.889 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-20.16:11:25.889 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-20.16:11:25.895 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Setting offset for partition send-rebate-topic-0 to the committed offset FetchPosition{offset=9, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.16:11:25.895 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=86, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.16:11:25.895 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.16:11:25.895 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-20.16:11:25.895 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-20.16:11:25.896 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-20.16:11:25.924 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"integral","userId":"matthew"},"id":"52032248913","timestamp":1718696688012}]
24-06-20.16:11:25.977 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户行为返利消息 - 非 sku 奖励暂时不处理 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"integral","userId":"matthew"},"id":"52032248913","timestamp":1718696688012}]
24-06-20.16:12:32.747 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Revoke previously assigned partitions sku-clear-topic-0
24-06-20.16:12:32.747 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Revoke previously assigned partitions sku-deduct-topic-0
24-06-20.16:12:32.747 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Revoke previously assigned partitions send-rebate-topic-0
24-06-20.16:12:32.749 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-20.16:12:32.749 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-20.16:12:32.749 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-20.16:12:32.749 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-ac3336e7-3763-421e-b777-ab0148fa7b25 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.16:12:32.749 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-16c4c4c8-056f-4f34-b6cf-078f8d0760a8 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.16:12:32.749 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-04aaa95d-e754-4b3e-a220-fd67e380a888 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.16:12:32.752 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:12:32.752 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:12:32.752 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:12:32.752 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:12:32.752 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:12:32.752 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:12:32.752 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.16:12:32.752 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.16:12:32.752 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.16:12:32.757 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:12:32.757 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:12:32.758 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:12:32.758 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:12:32.758 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:12:32.758 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:12:32.769 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.16:12:32.769 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.16:12:32.769 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.16:12:32.769 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.16:12:32.770 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.16:12:32.770 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.16:12:32.771 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.16:12:32.772 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.16:12:32.772 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.16:12:32.786 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-20.16:12:32.786 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-20.16:12:32.787 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-20.16:12:32.787 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-20.16:12:32.787 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-20.16:12:32.787 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-20.16:12:35.461 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 98981 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-20.16:12:35.463 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-20.16:12:36.090 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-20.16:12:36.092 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-20.16:12:36.120 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 18 ms. Found 0 Redis repository interfaces.
24-06-20.16:12:36.534 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-20.16:12:36.538 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-20.16:12:36.538 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-20.16:12:36.538 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-20.16:12:36.580 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-20.16:12:36.580 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1092 ms
24-06-20.16:12:36.921 [main            ] INFO  Version                - Redisson 3.26.0
24-06-20.16:12:36.935 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-20.16:12:37.002 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.16:12:37.011 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.16:12:37.511 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-20.16:12:37.637 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.16:12:37.669 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.16:12:37.669 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.16:12:37.669 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718871157669
24-06-20.16:12:37.676 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-20.16:12:37.682 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.16:12:37.685 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.16:12:37.685 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.16:12:37.685 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718871157685
24-06-20.16:12:37.688 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-20.16:12:37.689 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.16:12:37.691 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.16:12:37.691 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.16:12:37.691 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718871157691
24-06-20.16:12:37.693 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-20.16:12:37.694 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
24-06-20.16:12:37.699 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-20.16:12:37.707 [main            ] INFO  Application            - Started Application in 2.577 seconds (JVM running for 2.939)
24-06-20.16:12:37.842 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-20.16:12:37.842 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-20.16:12:37.842 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-20.16:12:37.843 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.16:12:37.843 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.16:12:37.843 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.16:12:37.849 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.16:12:37.849 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.16:12:37.849 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.16:12:37.851 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.16:12:37.851 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.16:12:37.852 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.16:12:37.863 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-20.16:12:37.863 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-20.16:12:37.863 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-20.16:12:37.863 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.16:12:37.863 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.16:12:37.863 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.16:12:38.177 [RMI TCP Connection(1)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
24-06-20.16:12:38.177 [RMI TCP Connection(1)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
24-06-20.16:12:38.178 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.16:12:38.179 [RMI TCP Connection(1)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 2 ms
24-06-20.16:12:38.309 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.16:12:38.317 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.16:12:38.328 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.16:12:40.873 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=287, memberId='consumer-sku-clear-group-3-7fd8ef19-ff3a-4a31-91c2-93b3e71c8cea', protocol='range'}
24-06-20.16:12:40.873 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=33, memberId='consumer-send-rebate-group-1-ba87f497-0df7-4c67-897b-c8f960b528b5', protocol='range'}
24-06-20.16:12:40.873 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=285, memberId='consumer-sku-deduct-group-2-4d899437-2b54-4767-8167-4e9878dce7c4', protocol='range'}
24-06-20.16:12:40.879 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 285: {consumer-sku-deduct-group-2-4d899437-2b54-4767-8167-4e9878dce7c4=Assignment(partitions=[sku-deduct-topic-0])}
24-06-20.16:12:40.879 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 33: {consumer-send-rebate-group-1-ba87f497-0df7-4c67-897b-c8f960b528b5=Assignment(partitions=[send-rebate-topic-0])}
24-06-20.16:12:40.879 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 287: {consumer-sku-clear-group-3-7fd8ef19-ff3a-4a31-91c2-93b3e71c8cea=Assignment(partitions=[sku-clear-topic-0])}
24-06-20.16:12:40.895 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=287, memberId='consumer-sku-clear-group-3-7fd8ef19-ff3a-4a31-91c2-93b3e71c8cea', protocol='range'}
24-06-20.16:12:40.895 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=285, memberId='consumer-sku-deduct-group-2-4d899437-2b54-4767-8167-4e9878dce7c4', protocol='range'}
24-06-20.16:12:40.895 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=33, memberId='consumer-send-rebate-group-1-ba87f497-0df7-4c67-897b-c8f960b528b5', protocol='range'}
24-06-20.16:12:40.896 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-20.16:12:40.896 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-20.16:12:40.896 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-20.16:12:40.899 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-20.16:12:40.899 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-20.16:12:40.899 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-20.16:12:40.913 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=86, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.16:12:40.913 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Setting offset for partition send-rebate-topic-0 to the committed offset FetchPosition{offset=9, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.16:12:40.913 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.16:12:40.914 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-20.16:12:40.914 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-20.16:12:40.914 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-20.16:12:40.943 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"integral","userId":"matthew"},"id":"52032248913","timestamp":1718696688012}]
24-06-20.16:12:40.994 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户行为返利消息 - 非 sku 奖励暂时不处理 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"integral","userId":"matthew"},"id":"52032248913","timestamp":1718696688012}]
24-06-20.16:21:37.865 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Node -1 disconnected.
24-06-20.16:21:37.923 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Node -1 disconnected.
24-06-20.16:21:38.042 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Node -1 disconnected.
24-06-20.16:25:58.160 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Revoke previously assigned partitions sku-deduct-topic-0
24-06-20.16:25:58.160 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Revoke previously assigned partitions sku-clear-topic-0
24-06-20.16:25:58.160 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Revoke previously assigned partitions send-rebate-topic-0
24-06-20.16:25:58.161 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-20.16:25:58.161 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-20.16:25:58.161 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-20.16:25:58.161 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-4d899437-2b54-4767-8167-4e9878dce7c4 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.16:25:58.161 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-ba87f497-0df7-4c67-897b-c8f960b528b5 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.16:25:58.161 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-7fd8ef19-ff3a-4a31-91c2-93b3e71c8cea sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.16:25:58.163 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:25:58.163 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:25:58.163 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:25:58.163 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:25:58.163 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.16:25:58.163 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:25:58.163 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.16:25:58.163 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:25:58.163 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.16:25:58.166 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:25:58.166 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:25:58.166 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:25:58.166 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:25:58.167 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:25:58.167 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:25:58.177 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.16:25:58.177 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.16:25:58.177 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.16:25:58.177 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.16:25:58.177 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.16:25:58.177 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.16:25:58.177 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.16:25:58.177 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.16:25:58.177 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.16:25:58.185 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-20.16:25:58.185 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-20.16:25:58.186 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-20.16:25:58.187 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-20.16:25:58.187 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-20.16:25:58.187 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-20.16:26:02.244 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 1264 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-20.16:26:02.245 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-20.16:26:02.721 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-20.16:26:02.722 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-20.16:26:02.743 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 14 ms. Found 0 Redis repository interfaces.
24-06-20.16:26:03.119 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-20.16:26:03.123 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-20.16:26:03.123 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-20.16:26:03.123 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-20.16:26:03.163 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-20.16:26:03.163 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 897 ms
24-06-20.16:26:03.480 [main            ] INFO  Version                - Redisson 3.26.0
24-06-20.16:26:03.494 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-20.16:26:03.570 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.16:26:03.580 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.16:26:04.094 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-20.16:26:04.238 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.16:26:04.268 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.16:26:04.268 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.16:26:04.268 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718871964268
24-06-20.16:26:04.275 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-20.16:26:04.280 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.16:26:04.284 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.16:26:04.284 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.16:26:04.284 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718871964284
24-06-20.16:26:04.287 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-20.16:26:04.288 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.16:26:04.290 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.16:26:04.290 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.16:26:04.290 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718871964290
24-06-20.16:26:04.292 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-20.16:26:04.293 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
24-06-20.16:26:04.298 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-20.16:26:04.308 [main            ] INFO  Application            - Started Application in 2.405 seconds (JVM running for 2.723)
24-06-20.16:26:04.430 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-20.16:26:04.430 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-20.16:26:04.430 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-20.16:26:04.431 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.16:26:04.431 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.16:26:04.431 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.16:26:04.431 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.16:26:04.431 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.16:26:04.431 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.16:26:04.434 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.16:26:04.434 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.16:26:04.434 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.16:26:04.444 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-20.16:26:04.444 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-20.16:26:04.444 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-20.16:26:04.444 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.16:26:04.444 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.16:26:04.444 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.16:26:04.811 [RMI TCP Connection(3)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
24-06-20.16:26:04.813 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
24-06-20.16:26:04.814 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 1 ms
24-06-20.16:26:04.822 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.16:26:04.964 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.16:26:04.972 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.16:26:04.983 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.16:26:07.452 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=289, memberId='consumer-sku-clear-group-3-269d49e1-3b61-4298-89bb-bc05fbde5c23', protocol='range'}
24-06-20.16:26:07.452 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=287, memberId='consumer-sku-deduct-group-2-79c2eea5-1b26-4742-8a6d-780d309b70c0', protocol='range'}
24-06-20.16:26:07.452 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=35, memberId='consumer-send-rebate-group-1-57e4733a-4a66-46fd-a27f-e91322991703', protocol='range'}
24-06-20.16:26:07.458 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 289: {consumer-sku-clear-group-3-269d49e1-3b61-4298-89bb-bc05fbde5c23=Assignment(partitions=[sku-clear-topic-0])}
24-06-20.16:26:07.458 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 287: {consumer-sku-deduct-group-2-79c2eea5-1b26-4742-8a6d-780d309b70c0=Assignment(partitions=[sku-deduct-topic-0])}
24-06-20.16:26:07.458 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 35: {consumer-send-rebate-group-1-57e4733a-4a66-46fd-a27f-e91322991703=Assignment(partitions=[send-rebate-topic-0])}
24-06-20.16:26:07.471 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=35, memberId='consumer-send-rebate-group-1-57e4733a-4a66-46fd-a27f-e91322991703', protocol='range'}
24-06-20.16:26:07.471 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=287, memberId='consumer-sku-deduct-group-2-79c2eea5-1b26-4742-8a6d-780d309b70c0', protocol='range'}
24-06-20.16:26:07.471 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=289, memberId='consumer-sku-clear-group-3-269d49e1-3b61-4298-89bb-bc05fbde5c23', protocol='range'}
24-06-20.16:26:07.471 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-20.16:26:07.471 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-20.16:26:07.471 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-20.16:26:07.474 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-20.16:26:07.474 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-20.16:26:07.474 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-20.16:26:07.487 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=86, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.16:26:07.487 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.16:26:07.487 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Setting offset for partition send-rebate-topic-0 to the committed offset FetchPosition{offset=9, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.16:26:07.488 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-20.16:26:07.488 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-20.16:26:07.488 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-20.16:26:07.514 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"integral","userId":"matthew"},"id":"52032248913","timestamp":1718696688012}]
24-06-20.16:26:07.565 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户行为返利消息 - 非 sku 奖励暂时不处理 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"integral","userId":"matthew"},"id":"52032248913","timestamp":1718696688012}]
24-06-20.16:26:27.106 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Revoke previously assigned partitions sku-deduct-topic-0
24-06-20.16:26:27.106 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Revoke previously assigned partitions send-rebate-topic-0
24-06-20.16:26:27.106 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Revoke previously assigned partitions sku-clear-topic-0
24-06-20.16:26:27.106 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-20.16:26:27.106 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-20.16:26:27.106 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-20.16:26:27.107 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-79c2eea5-1b26-4742-8a6d-780d309b70c0 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.16:26:27.107 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-269d49e1-3b61-4298-89bb-bc05fbde5c23 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.16:26:27.107 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-57e4733a-4a66-46fd-a27f-e91322991703 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.16:26:27.109 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:26:27.109 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:26:27.109 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:26:27.109 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:26:27.109 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.16:26:27.109 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:26:27.109 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.16:26:27.109 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:26:27.109 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.16:26:27.112 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:26:27.112 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:26:27.112 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:26:27.112 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:26:27.112 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.16:26:27.112 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.16:26:27.123 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.16:26:27.124 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.16:26:27.124 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.16:26:27.124 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.16:26:27.124 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.16:26:27.124 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.16:26:27.124 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.16:26:27.124 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.16:26:27.124 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.16:26:27.129 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-20.16:26:27.129 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-20.16:26:27.129 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-20.16:26:27.129 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-20.16:26:27.130 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-20.16:26:27.130 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-20.16:26:30.442 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 1334 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-20.16:26:30.443 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-20.16:26:30.917 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-20.16:26:30.919 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-20.16:26:30.937 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 11 ms. Found 0 Redis repository interfaces.
24-06-20.16:26:31.314 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-20.16:26:31.317 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-20.16:26:31.318 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-20.16:26:31.318 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-20.16:26:31.361 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-20.16:26:31.361 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 900 ms
24-06-20.16:26:31.686 [main            ] INFO  Version                - Redisson 3.26.0
24-06-20.16:26:31.699 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-20.16:26:31.765 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.16:26:31.773 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.16:26:32.293 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-20.16:26:32.439 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.16:26:32.469 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.16:26:32.469 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.16:26:32.469 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718871992468
24-06-20.16:26:32.476 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-20.16:26:32.481 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.16:26:32.485 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.16:26:32.485 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.16:26:32.485 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718871992485
24-06-20.16:26:32.488 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-20.16:26:32.489 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.16:26:32.491 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.16:26:32.491 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.16:26:32.491 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718871992491
24-06-20.16:26:32.493 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-20.16:26:32.494 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
24-06-20.16:26:32.499 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-20.16:26:32.509 [main            ] INFO  Application            - Started Application in 2.27 seconds (JVM running for 2.561)
24-06-20.16:26:32.643 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-20.16:26:32.643 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-20.16:26:32.643 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-20.16:26:32.644 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.16:26:32.644 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.16:26:32.645 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.16:26:32.645 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.16:26:32.645 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.16:26:32.645 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.16:26:32.649 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.16:26:32.649 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.16:26:32.649 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.16:26:32.660 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-20.16:26:32.660 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-20.16:26:32.660 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-20.16:26:32.660 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.16:26:32.660 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.16:26:32.661 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.16:26:32.668 [RMI TCP Connection(2)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
24-06-20.16:26:32.669 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
24-06-20.16:26:32.672 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 3 ms
24-06-20.16:26:32.673 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.16:26:32.863 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.16:26:32.871 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.16:26:32.891 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.16:26:35.673 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=289, memberId='consumer-sku-deduct-group-2-884256d1-6721-4622-969a-54407ea143dc', protocol='range'}
24-06-20.16:26:35.673 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=291, memberId='consumer-sku-clear-group-3-3b903869-ee9b-4e3e-bfb8-fab67ba3d6fc', protocol='range'}
24-06-20.16:26:35.676 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=37, memberId='consumer-send-rebate-group-1-27b23c23-5e84-4c27-a3aa-9ab13d070203', protocol='range'}
24-06-20.16:26:35.680 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 289: {consumer-sku-deduct-group-2-884256d1-6721-4622-969a-54407ea143dc=Assignment(partitions=[sku-deduct-topic-0])}
24-06-20.16:26:35.680 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 37: {consumer-send-rebate-group-1-27b23c23-5e84-4c27-a3aa-9ab13d070203=Assignment(partitions=[send-rebate-topic-0])}
24-06-20.16:26:35.680 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 291: {consumer-sku-clear-group-3-3b903869-ee9b-4e3e-bfb8-fab67ba3d6fc=Assignment(partitions=[sku-clear-topic-0])}
24-06-20.16:26:35.693 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=291, memberId='consumer-sku-clear-group-3-3b903869-ee9b-4e3e-bfb8-fab67ba3d6fc', protocol='range'}
24-06-20.16:26:35.693 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=289, memberId='consumer-sku-deduct-group-2-884256d1-6721-4622-969a-54407ea143dc', protocol='range'}
24-06-20.16:26:35.694 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=37, memberId='consumer-send-rebate-group-1-27b23c23-5e84-4c27-a3aa-9ab13d070203', protocol='range'}
24-06-20.16:26:35.694 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-20.16:26:35.694 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-20.16:26:35.694 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-20.16:26:35.698 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-20.16:26:35.698 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-20.16:26:35.698 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-20.16:26:35.712 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Setting offset for partition send-rebate-topic-0 to the committed offset FetchPosition{offset=10, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.16:26:35.712 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=86, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.16:26:35.712 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.16:26:35.712 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-20.16:26:35.712 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-20.16:26:35.712 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-20.16:35:32.668 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Node -1 disconnected.
24-06-20.16:35:32.668 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Node -1 disconnected.
24-06-20.16:35:32.668 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Node -1 disconnected.
24-06-20.17:03:52.384 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.17:03:52.383 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=15m49s87ms).
24-06-20.17:03:52.383 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=15m49s72ms).
24-06-20.17:03:52.386 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.17:03:52.384 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.17:03:52.386 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.17:03:52.384 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.17:03:52.386 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.17:03:52.392 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Client requested disconnect from node 2147483646
24-06-20.17:03:52.392 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Client requested disconnect from node 2147483646
24-06-20.17:03:52.392 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Client requested disconnect from node 2147483646
24-06-20.17:03:52.396 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.17:03:52.396 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.17:03:52.396 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.17:03:52.396 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.17:03:52.396 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.17:03:52.396 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.17:03:52.396 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.17:03:52.396 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.17:03:52.396 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.17:03:52.396 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.17:03:52.396 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.17:03:52.396 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.17:03:52.511 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.17:03:52.512 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.17:03:52.512 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:00:16.447 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=53s545ms).
24-06-20.18:00:16.469 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=53s544ms).
24-06-20.18:02:38.766 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.18:02:38.766 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.18:02:38.766 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:02:38.766 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:02:38.766 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.18:02:38.766 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:02:38.766 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Client requested disconnect from node 2147483646
24-06-20.18:02:38.766 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Client requested disconnect from node 2147483646
24-06-20.18:02:38.766 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Client requested disconnect from node 2147483646
24-06-20.18:02:38.768 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:02:38.768 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:02:38.768 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:02:38.768 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:02:38.768 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:02:38.768 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.18:02:38.768 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:02:38.769 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:02:38.769 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:02:38.769 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.18:02:38.769 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:02:38.769 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:02:38.769 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.18:02:38.769 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:02:38.870 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:02:38.873 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:02:38.874 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:03:03.395 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=2m16s947ms).
24-06-20.18:03:03.423 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=2m16s954ms).
24-06-20.18:20:22.384 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.18:20:22.384 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.18:20:22.384 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.18:20:22.385 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:20:22.385 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:20:22.385 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Client requested disconnect from node 2147483646
24-06-20.18:20:22.385 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Client requested disconnect from node 2147483646
24-06-20.18:20:22.385 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:20:22.385 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Client requested disconnect from node 2147483646
24-06-20.18:20:22.387 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:20:22.387 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:20:22.387 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:20:22.387 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:20:22.387 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.18:20:22.387 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.18:20:22.387 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:20:22.387 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:20:22.387 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:20:22.387 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:20:22.387 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.18:20:22.387 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:20:22.490 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:20:22.490 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:20:22.490 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:20:29.902 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=17m26s507ms).
24-06-20.18:20:29.931 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=17m26s508ms).
24-06-20.18:26:03.793 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.18:26:03.793 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.18:26:03.793 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:26:03.793 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.18:26:03.793 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:26:03.793 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Client requested disconnect from node 2147483646
24-06-20.18:26:03.793 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:26:03.793 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Client requested disconnect from node 2147483646
24-06-20.18:26:03.793 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Client requested disconnect from node 2147483646
24-06-20.18:26:03.795 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:26:03.795 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:26:03.795 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.18:26:03.795 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:26:03.795 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:26:03.795 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.18:26:03.795 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:26:03.795 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:26:03.795 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:26:03.795 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.18:26:03.795 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:26:03.899 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:26:03.899 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:26:03.899 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:26:24.253 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=5m24s336ms).
24-06-20.18:26:24.293 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=5m24s342ms).
24-06-20.18:32:00.620 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.18:32:00.620 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.18:32:00.620 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.18:32:00.621 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:32:00.621 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Client requested disconnect from node 2147483646
24-06-20.18:32:00.621 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:32:00.622 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Client requested disconnect from node 2147483646
24-06-20.18:32:00.623 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:32:00.623 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Client requested disconnect from node 2147483646
24-06-20.18:32:00.629 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:32:00.629 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:32:00.631 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:32:00.631 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:32:00.631 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:32:00.631 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.18:32:00.631 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:32:00.631 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:32:00.631 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.18:32:00.631 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:32:00.631 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:32:00.631 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.18:32:00.631 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:32:00.755 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:32:00.759 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:32:00.759 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:32:12.672 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=3m18s379ms).
24-06-20.18:32:12.701 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=3m18s373ms).
24-06-20.18:34:25.093 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询今日是否签到 userId:null
24-06-20.18:34:25.093 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询今日是否签到 userId:null
24-06-20.18:34:25.104 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:null, activityId:0
24-06-20.18:34:25.104 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:null, activityId:0
24-06-20.18:34:25.161 [http-nio-8091-exec-8] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.18:34:25.212 [http-nio-8091-exec-8] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.18:34:25.223 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询今日是否签到完成 userId:null
24-06-20.18:34:25.223 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询今日是否签到完成 userId:null
24-06-20.18:34:25.308 [http-nio-8091-exec-8] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:null activityId:0 responseDto:{"dayCount":0,"dayCountSurplus":0,"monthCount":0,"monthCountSurplus":0,"totalCount":0,"totalCountSurplus":0}
24-06-20.18:34:25.308 [http-nio-8091-exec-7] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:null activityId:0 responseDto:{"dayCount":0,"dayCountSurplus":0,"monthCount":0,"monthCountSurplus":0,"totalCount":0,"totalCountSurplus":0}
24-06-20.18:34:45.132 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询今日是否签到 userId:null
24-06-20.18:34:45.133 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:null, activityId:100001
24-06-20.18:34:45.133 [http-nio-8091-exec-9] INFO  RaffleActivityController - 开始查询今日是否签到 userId:null
24-06-20.18:34:45.133 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:null, activityId:100001
24-06-20.18:34:45.156 [http-nio-8091-exec-10] INFO  RaffleActivityController - 查询今日是否签到完成 userId:null
24-06-20.18:34:45.156 [http-nio-8091-exec-9] INFO  RaffleActivityController - 查询今日是否签到完成 userId:null
24-06-20.18:34:45.157 [http-nio-8091-exec-7] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:null activityId:100001 responseDto:{"dayCount":0,"dayCountSurplus":0,"monthCount":0,"monthCountSurplus":0,"totalCount":0,"totalCountSurplus":0}
24-06-20.18:34:45.160 [http-nio-8091-exec-8] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:null activityId:100001 responseDto:{"dayCount":0,"dayCountSurplus":0,"monthCount":0,"monthCountSurplus":0,"totalCount":0,"totalCountSurplus":0}
24-06-20.18:35:01.991 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.18:35:01.993 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.18:35:01.993 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.18:35:01.994 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.18:35:02.004 [http-nio-8091-exec-8] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.18:35:02.004 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.18:35:02.009 [http-nio-8091-exec-7] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":0,"dayCountSurplus":0,"monthCount":0,"monthCountSurplus":0,"totalCount":0,"totalCountSurplus":0}
24-06-20.18:35:02.010 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":0,"dayCountSurplus":0,"monthCount":0,"monthCountSurplus":0,"totalCount":0,"totalCountSurplus":0}
24-06-20.18:35:55.302 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.18:35:55.302 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.18:35:55.322 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.18:35:55.322 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.18:35:55.327 [http-nio-8091-exec-7] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.18:35:55.328 [http-nio-8091-exec-5] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":0,"dayCountSurplus":0,"monthCount":0,"monthCountSurplus":0,"totalCount":0,"totalCountSurplus":0}
24-06-20.18:35:55.328 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":0,"dayCountSurplus":0,"monthCount":0,"monthCountSurplus":0,"totalCount":0,"totalCountSurplus":0}
24-06-20.18:35:55.328 [http-nio-8091-exec-2] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.18:36:43.929 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.18:36:43.929 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.18:36:43.931 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.18:36:43.931 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.18:36:43.946 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.18:36:43.946 [http-nio-8091-exec-10] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.18:36:43.946 [http-nio-8091-exec-2] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":0,"dayCountSurplus":0,"monthCount":0,"monthCountSurplus":0,"totalCount":0,"totalCountSurplus":0}
24-06-20.18:36:43.946 [http-nio-8091-exec-5] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":0,"dayCountSurplus":0,"monthCount":0,"monthCountSurplus":0,"totalCount":0,"totalCountSurplus":0}
24-06-20.18:37:42.918 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Revoke previously assigned partitions sku-deduct-topic-0
24-06-20.18:37:42.918 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Revoke previously assigned partitions send-rebate-topic-0
24-06-20.18:37:42.918 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Revoke previously assigned partitions sku-clear-topic-0
24-06-20.18:37:42.920 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-20.18:37:42.920 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-20.18:37:42.920 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-20.18:37:42.921 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-884256d1-6721-4622-969a-54407ea143dc sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.18:37:42.921 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-3b903869-ee9b-4e3e-bfb8-fab67ba3d6fc sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.18:37:42.921 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-27b23c23-5e84-4c27-a3aa-9ab13d070203 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.18:37:42.924 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:37:42.924 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:37:42.924 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:37:42.924 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:37:42.924 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:37:42.924 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:37:42.924 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.18:37:42.924 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.18:37:42.924 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.18:37:42.926 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:37:42.926 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:37:42.926 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:37:42.926 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:37:42.926 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:37:42.926 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:37:42.961 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.18:37:42.961 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.18:37:42.961 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.18:37:42.961 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.18:37:42.961 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.18:37:42.961 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.18:37:42.961 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.18:37:42.961 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.18:37:42.961 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.18:37:42.966 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-20.18:37:42.966 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-20.18:37:42.966 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-20.18:37:42.966 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-20.18:37:42.967 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-20.18:37:42.967 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-20.18:37:47.615 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 15259 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-20.18:37:47.616 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-20.18:37:48.129 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-20.18:37:48.130 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-20.18:37:48.148 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 10 ms. Found 0 Redis repository interfaces.
24-06-20.18:37:48.549 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-20.18:37:48.554 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-20.18:37:48.554 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-20.18:37:48.554 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-20.18:37:48.601 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-20.18:37:48.602 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 961 ms
24-06-20.18:37:48.995 [main            ] INFO  Version                - Redisson 3.26.0
24-06-20.18:37:49.012 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-20.18:37:49.093 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.18:37:49.100 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.18:37:49.730 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-20.18:37:49.858 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.18:37:49.890 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.18:37:49.891 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.18:37:49.891 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718879869890
24-06-20.18:37:49.898 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-20.18:37:49.904 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.18:37:49.907 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.18:37:49.907 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.18:37:49.907 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718879869907
24-06-20.18:37:49.910 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-20.18:37:49.911 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.18:37:49.914 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.18:37:49.914 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.18:37:49.914 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718879869914
24-06-20.18:37:49.916 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-20.18:37:49.916 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
24-06-20.18:37:49.922 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-20.18:37:49.930 [main            ] INFO  Application            - Started Application in 2.625 seconds (JVM running for 3.044)
24-06-20.18:37:50.085 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-20.18:37:50.085 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-20.18:37:50.085 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-20.18:37:50.085 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.18:37:50.085 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.18:37:50.085 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.18:37:50.086 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:37:50.086 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:37:50.086 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:37:50.089 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.18:37:50.089 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.18:37:50.090 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.18:37:50.103 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-20.18:37:50.103 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-20.18:37:50.104 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.18:37:50.104 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.18:37:50.104 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-20.18:37:50.104 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.18:37:50.197 [RMI TCP Connection(1)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
24-06-20.18:37:50.197 [RMI TCP Connection(1)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
24-06-20.18:37:50.198 [RMI TCP Connection(1)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 1 ms
24-06-20.18:37:50.204 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.18:37:50.522 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.18:37:50.545 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.18:37:50.579 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.18:37:53.122 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=291, memberId='consumer-sku-deduct-group-2-6d9b1bf8-bd34-442f-a270-ef14b8b85bb4', protocol='range'}
24-06-20.18:37:53.122 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=293, memberId='consumer-sku-clear-group-3-00e4dd30-5bce-4642-b321-b61aec9f5fe2', protocol='range'}
24-06-20.18:37:53.125 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=39, memberId='consumer-send-rebate-group-1-5894e9af-fe97-4fcd-8cf7-bc745ea94871', protocol='range'}
24-06-20.18:37:53.129 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 293: {consumer-sku-clear-group-3-00e4dd30-5bce-4642-b321-b61aec9f5fe2=Assignment(partitions=[sku-clear-topic-0])}
24-06-20.18:37:53.129 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 291: {consumer-sku-deduct-group-2-6d9b1bf8-bd34-442f-a270-ef14b8b85bb4=Assignment(partitions=[sku-deduct-topic-0])}
24-06-20.18:37:53.129 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 39: {consumer-send-rebate-group-1-5894e9af-fe97-4fcd-8cf7-bc745ea94871=Assignment(partitions=[send-rebate-topic-0])}
24-06-20.18:37:53.155 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=39, memberId='consumer-send-rebate-group-1-5894e9af-fe97-4fcd-8cf7-bc745ea94871', protocol='range'}
24-06-20.18:37:53.155 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=293, memberId='consumer-sku-clear-group-3-00e4dd30-5bce-4642-b321-b61aec9f5fe2', protocol='range'}
24-06-20.18:37:53.155 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=291, memberId='consumer-sku-deduct-group-2-6d9b1bf8-bd34-442f-a270-ef14b8b85bb4', protocol='range'}
24-06-20.18:37:53.156 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-20.18:37:53.156 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-20.18:37:53.156 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-20.18:37:53.159 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-20.18:37:53.159 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-20.18:37:53.159 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-20.18:37:53.180 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Setting offset for partition send-rebate-topic-0 to the committed offset FetchPosition{offset=10, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.18:37:53.180 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.18:37:53.180 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=86, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.18:37:53.183 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-20.18:37:53.183 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-20.18:37:53.183 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-20.18:38:25.610 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.18:38:25.610 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.18:38:25.671 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.18:38:25.671 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.18:38:25.685 [http-nio-8091-exec-4] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.18:38:25.729 [http-nio-8091-exec-5] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.18:38:25.729 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.18:38:25.732 [http-nio-8091-exec-4] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.18:38:25.900 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":0,"dayCountSurplus":0,"monthCount":0,"monthCountSurplus":0,"totalCount":0,"totalCountSurplus":0}
24-06-20.18:38:25.900 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":0,"dayCountSurplus":0,"monthCount":0,"monthCountSurplus":0,"totalCount":0,"totalCountSurplus":0}
24-06-20.18:39:45.936 [http-nio-8091-exec-1] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.18:39:45.936 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.18:39:45.938 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.18:39:45.938 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.18:39:45.983 [http-nio-8091-exec-1] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.18:39:45.983 [http-nio-8091-exec-10] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.18:39:45.983 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":0,"dayCountSurplus":0,"monthCount":0,"monthCountSurplus":0,"totalCount":0,"totalCountSurplus":0}
24-06-20.18:39:45.983 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":0,"dayCountSurplus":0,"monthCount":0,"monthCountSurplus":0,"totalCount":0,"totalCountSurplus":0}
24-06-20.18:42:23.787 [http-nio-8091-exec-1] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:null, 用户ID为：matthew
24-06-20.18:42:23.798 [http-nio-8091-exec-1] ERROR RaffleActivityController - 查询抽奖奖品列表配置失败 userId:matthew activityId：null
cn.matthew.types.exception.AppException: null
	at cn.matthew.trigger.http.RaffleActivityController.queryAwardList(RaffleActivityController.java:189)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.18:42:38.626 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.18:42:38.686 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":false,"sort":5,"waitUnLockCount":3},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":false,"sort":6,"waitUnLockCount":2},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":false,"sort":7,"waitUnLockCount":1},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.18:42:59.633 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.18:42:59.633 [http-nio-8091-exec-9] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.18:42:59.636 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.18:42:59.640 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.18:42:59.666 [http-nio-8091-exec-7] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.18:42:59.666 [http-nio-8091-exec-10] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.18:42:59.667 [http-nio-8091-exec-9] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":0,"dayCountSurplus":0,"monthCount":0,"monthCountSurplus":0,"totalCount":0,"totalCountSurplus":0}
24-06-20.18:42:59.668 [http-nio-8091-exec-5] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":0,"dayCountSurplus":0,"monthCount":0,"monthCountSurplus":0,"totalCount":0,"totalCountSurplus":0}
24-06-20.18:43:56.096 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.18:43:56.096 [http-nio-8091-exec-1] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.18:43:56.098 [http-nio-8091-exec-9] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.18:43:56.098 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.18:43:56.109 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.18:43:56.109 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.18:43:56.157 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.18:43:56.157 [http-nio-8091-exec-1] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.18:43:56.159 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":0,"dayCountSurplus":0,"monthCount":0,"monthCountSurplus":0,"totalCount":0,"totalCountSurplus":0}
24-06-20.18:43:56.160 [http-nio-8091-exec-9] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":0,"dayCountSurplus":0,"monthCount":0,"monthCountSurplus":0,"totalCount":0,"totalCountSurplus":0}
24-06-20.18:43:56.184 [http-nio-8091-exec-7] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":false,"sort":5,"waitUnLockCount":3},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":false,"sort":6,"waitUnLockCount":2},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":false,"sort":7,"waitUnLockCount":1},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.18:43:56.184 [http-nio-8091-exec-2] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":false,"sort":5,"waitUnLockCount":3},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":false,"sort":6,"waitUnLockCount":2},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":false,"sort":7,"waitUnLockCount":1},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.18:44:12.821 [http-nio-8091-exec-9] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.18:44:12.821 [http-nio-8091-exec-1] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.18:44:12.837 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.18:44:12.838 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.18:44:12.839 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.18:44:12.843 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.18:44:12.847 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.18:44:12.847 [http-nio-8091-exec-7] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":0,"dayCountSurplus":0,"monthCount":0,"monthCountSurplus":0,"totalCount":0,"totalCountSurplus":0}
24-06-20.18:44:12.849 [http-nio-8091-exec-5] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.18:44:12.872 [http-nio-8091-exec-2] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":0,"dayCountSurplus":0,"monthCount":0,"monthCountSurplus":0,"totalCount":0,"totalCountSurplus":0}
24-06-20.18:44:12.885 [http-nio-8091-exec-9] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":false,"sort":5,"waitUnLockCount":3},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":false,"sort":6,"waitUnLockCount":2},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":false,"sort":7,"waitUnLockCount":1},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.18:44:12.889 [http-nio-8091-exec-1] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":false,"sort":5,"waitUnLockCount":3},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":false,"sort":6,"waitUnLockCount":2},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":false,"sort":7,"waitUnLockCount":1},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.18:46:32.646 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.18:46:32.655 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":0,"dayCountSurplus":0,"monthCount":0,"monthCountSurplus":0,"totalCount":0,"totalCountSurplus":0}
24-06-20.18:46:50.147 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Node -1 disconnected.
24-06-20.18:46:50.375 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Node -1 disconnected.
24-06-20.18:46:50.375 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Node -1 disconnected.
24-06-20.18:48:38.758 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Revoke previously assigned partitions send-rebate-topic-0
24-06-20.18:48:38.758 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Revoke previously assigned partitions sku-clear-topic-0
24-06-20.18:48:38.758 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Revoke previously assigned partitions sku-deduct-topic-0
24-06-20.18:48:38.758 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-20.18:48:38.758 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-20.18:48:38.759 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-20.18:48:38.759 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-5894e9af-fe97-4fcd-8cf7-bc745ea94871 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.18:48:38.759 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-00e4dd30-5bce-4642-b321-b61aec9f5fe2 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.18:48:38.759 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-6d9b1bf8-bd34-442f-a270-ef14b8b85bb4 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.18:48:38.761 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:48:38.761 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:48:38.761 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:48:38.761 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:48:38.761 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:48:38.761 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:48:38.761 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.18:48:38.761 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.18:48:38.761 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.18:48:38.762 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:48:38.762 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:48:38.763 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:48:38.763 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:48:38.763 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:48:38.763 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:48:38.791 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.18:48:38.791 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.18:48:38.792 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.18:48:38.792 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.18:48:38.792 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.18:48:38.792 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.18:48:38.792 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.18:48:38.792 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.18:48:38.792 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.18:48:38.800 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-20.18:48:38.801 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-20.18:48:38.801 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-20.18:48:38.802 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-20.18:48:38.802 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-20.18:48:38.802 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-20.18:48:42.021 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 16997 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-20.18:48:42.022 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-20.18:48:42.614 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-20.18:48:42.616 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-20.18:48:42.635 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 11 ms. Found 0 Redis repository interfaces.
24-06-20.18:48:43.047 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-20.18:48:43.050 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-20.18:48:43.051 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-20.18:48:43.051 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-20.18:48:43.093 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-20.18:48:43.093 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1049 ms
24-06-20.18:48:43.478 [main            ] INFO  Version                - Redisson 3.26.0
24-06-20.18:48:43.498 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-20.18:48:43.579 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.18:48:43.587 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.18:48:44.230 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-20.18:48:44.373 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.18:48:44.409 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.18:48:44.409 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.18:48:44.409 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718880524408
24-06-20.18:48:44.417 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-20.18:48:44.425 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.18:48:44.429 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.18:48:44.429 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.18:48:44.429 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718880524429
24-06-20.18:48:44.432 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-20.18:48:44.434 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.18:48:44.436 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.18:48:44.436 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.18:48:44.437 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718880524436
24-06-20.18:48:44.439 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-20.18:48:44.440 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
24-06-20.18:48:44.448 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-20.18:48:44.457 [main            ] INFO  Application            - Started Application in 2.737 seconds (JVM running for 3.6)
24-06-20.18:48:44.595 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-20.18:48:44.595 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-20.18:48:44.595 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-20.18:48:44.596 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.18:48:44.596 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.18:48:44.596 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.18:48:44.597 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:48:44.597 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:48:44.597 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:48:44.600 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.18:48:44.601 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.18:48:44.601 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.18:48:44.614 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-20.18:48:44.614 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-20.18:48:44.614 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-20.18:48:44.614 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.18:48:44.614 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.18:48:44.614 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.18:48:44.903 [RMI TCP Connection(2)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
24-06-20.18:48:44.903 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
24-06-20.18:48:44.906 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 2 ms
24-06-20.18:48:44.905 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.18:48:45.277 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.18:48:45.289 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.18:48:45.306 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.18:48:47.628 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=295, memberId='consumer-sku-clear-group-3-55d5f726-f716-4ac3-9c46-11080a49c842', protocol='range'}
24-06-20.18:48:47.628 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=41, memberId='consumer-send-rebate-group-1-4bf87ed2-811c-425b-a804-1a8bf244b799', protocol='range'}
24-06-20.18:48:47.628 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=293, memberId='consumer-sku-deduct-group-2-c6514f99-75a4-4770-89bc-c3056d0b2a2b', protocol='range'}
24-06-20.18:48:47.645 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 41: {consumer-send-rebate-group-1-4bf87ed2-811c-425b-a804-1a8bf244b799=Assignment(partitions=[send-rebate-topic-0])}
24-06-20.18:48:47.645 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 295: {consumer-sku-clear-group-3-55d5f726-f716-4ac3-9c46-11080a49c842=Assignment(partitions=[sku-clear-topic-0])}
24-06-20.18:48:47.645 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 293: {consumer-sku-deduct-group-2-c6514f99-75a4-4770-89bc-c3056d0b2a2b=Assignment(partitions=[sku-deduct-topic-0])}
24-06-20.18:48:47.674 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=41, memberId='consumer-send-rebate-group-1-4bf87ed2-811c-425b-a804-1a8bf244b799', protocol='range'}
24-06-20.18:48:47.674 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=293, memberId='consumer-sku-deduct-group-2-c6514f99-75a4-4770-89bc-c3056d0b2a2b', protocol='range'}
24-06-20.18:48:47.674 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=295, memberId='consumer-sku-clear-group-3-55d5f726-f716-4ac3-9c46-11080a49c842', protocol='range'}
24-06-20.18:48:47.674 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-20.18:48:47.674 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-20.18:48:47.675 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-20.18:48:47.679 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-20.18:48:47.679 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-20.18:48:47.679 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-20.18:48:47.688 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=86, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.18:48:47.689 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Setting offset for partition send-rebate-topic-0 to the committed offset FetchPosition{offset=10, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.18:48:47.689 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.18:48:47.689 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-20.18:48:47.689 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-20.18:48:47.689 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-20.18:49:02.368 [http-nio-8091-exec-1] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.18:49:02.387 [http-nio-8091-exec-1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.18:49:02.428 [http-nio-8091-exec-1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.18:51:41.186 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=2m55s773ms).
24-06-20.18:51:41.188 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=3m8s754ms).
24-06-20.18:51:41.186 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=2m55s801ms).
24-06-20.18:51:41.258 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Disconnecting from node 1 due to request timeout.
24-06-20.18:51:41.258 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Disconnecting from node 1 due to request timeout.
24-06-20.18:51:41.258 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Disconnecting from node 1 due to request timeout.
24-06-20.18:51:41.259 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cancelled in-flight FETCH request with correlation id 42 due to node 1 being disconnected (elapsed time since creation: 158807ms, elapsed time since send: 158807ms, request timeout: 30000ms)
24-06-20.18:51:41.260 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cancelled in-flight FETCH request with correlation id 42 due to node 1 being disconnected (elapsed time since creation: 158810ms, elapsed time since send: 158810ms, request timeout: 30000ms)
24-06-20.18:51:41.260 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cancelled in-flight FETCH request with correlation id 42 due to node 1 being disconnected (elapsed time since creation: 158806ms, elapsed time since send: 158806ms, request timeout: 30000ms)
24-06-20.18:51:41.260 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.18:51:41.260 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:51:41.260 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Client requested disconnect from node 2147483646
24-06-20.18:51:41.260 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.18:51:41.260 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:51:41.260 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Client requested disconnect from node 2147483646
24-06-20.18:51:41.260 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.18:51:41.261 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:51:41.261 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Client requested disconnect from node 2147483646
24-06-20.18:51:41.263 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  FetchSessionHandler    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Error sending fetch request (sessionId=1721757796, epoch=29) to node 1:
org.apache.kafka.common.errors.DisconnectException: null
24-06-20.18:51:41.263 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  FetchSessionHandler    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Error sending fetch request (sessionId=1944421070, epoch=29) to node 1:
org.apache.kafka.common.errors.DisconnectException: null
24-06-20.18:51:41.263 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  FetchSessionHandler    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Error sending fetch request (sessionId=543847581, epoch=29) to node 1:
org.apache.kafka.common.errors.DisconnectException: null
24-06-20.18:51:41.274 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:51:41.274 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:51:41.274 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:51:41.274 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.18:51:41.274 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:51:41.274 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:51:41.274 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:51:41.274 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.18:51:41.274 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:51:41.274 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:51:41.274 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.18:51:41.274 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:51:41.348 [http-nio-8091-exec-1] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":0,"dayCountSurplus":0,"monthCount":0,"monthCountSurplus":0,"totalCount":0,"totalCountSurplus":0}
24-06-20.18:51:41.380 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:51:41.380 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:51:41.380 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:51:41.388 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Attempt to heartbeat with Generation{generationId=41, memberId='consumer-send-rebate-group-1-4bf87ed2-811c-425b-a804-1a8bf244b799', protocol='range'} and group instance id Optional.empty failed due to UNKNOWN_MEMBER_ID, resetting generation
24-06-20.18:51:41.387 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Attempt to heartbeat with Generation{generationId=295, memberId='consumer-sku-clear-group-3-55d5f726-f716-4ac3-9c46-11080a49c842', protocol='range'} and group instance id Optional.empty failed due to UNKNOWN_MEMBER_ID, resetting generation
24-06-20.18:51:41.388 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Attempt to heartbeat with Generation{generationId=293, memberId='consumer-sku-deduct-group-2-c6514f99-75a4-4770-89bc-c3056d0b2a2b', protocol='range'} and group instance id Optional.empty failed due to UNKNOWN_MEMBER_ID, resetting generation
24-06-20.18:51:41.388 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: encountered UNKNOWN_MEMBER_ID from HEARTBEAT response
24-06-20.18:51:41.389 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: encountered UNKNOWN_MEMBER_ID from HEARTBEAT response
24-06-20.18:51:41.389 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: encountered UNKNOWN_MEMBER_ID from HEARTBEAT response
24-06-20.18:51:41.389 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: encountered UNKNOWN_MEMBER_ID from HEARTBEAT response
24-06-20.18:51:41.389 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: encountered UNKNOWN_MEMBER_ID from HEARTBEAT response
24-06-20.18:51:41.389 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: encountered UNKNOWN_MEMBER_ID from HEARTBEAT response
24-06-20.18:51:41.389 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Giving away all assigned partitions as lost since generation has been reset,indicating that consumer is no longer part of the group
24-06-20.18:51:41.389 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Giving away all assigned partitions as lost since generation has been reset,indicating that consumer is no longer part of the group
24-06-20.18:51:41.389 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Lost previously assigned partitions send-rebate-topic-0
24-06-20.18:51:41.389 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Giving away all assigned partitions as lost since generation has been reset,indicating that consumer is no longer part of the group
24-06-20.18:51:41.389 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Lost previously assigned partitions sku-deduct-topic-0
24-06-20.18:51:41.389 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Lost previously assigned partitions sku-clear-topic-0
24-06-20.18:51:41.392 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions lost: [sku-deduct-topic-0]
24-06-20.18:51:41.392 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-20.18:51:41.392 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions lost: [sku-clear-topic-0]
24-06-20.18:51:41.392 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-20.18:51:41.392 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions lost: [send-rebate-topic-0]
24-06-20.18:51:41.392 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-20.18:51:41.393 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.18:51:41.393 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.18:51:41.393 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.18:51:41.406 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-20.18:51:41.406 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-20.18:51:41.406 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-20.18:51:41.406 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.18:51:41.406 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.18:51:41.406 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.18:51:42.302 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-7638d461-72fb-4318-8203-cadd12f098a5 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.18:51:42.302 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-6b01d329-de37-4054-ac60-971c712e73b9 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.18:51:42.302 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-8cc15c0e-d208-4df6-9edc-229bf26af0e4 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.18:51:42.306 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:51:42.306 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:51:42.306 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:51:42.306 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:51:42.306 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:51:42.306 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:51:42.306 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.18:51:42.306 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.18:51:42.306 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.18:51:42.308 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:51:42.308 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:51:42.309 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:51:42.309 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:51:42.309 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:51:42.309 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:51:44.438 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.18:51:44.438 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.18:51:44.438 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.18:51:44.438 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.18:51:44.438 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.18:51:44.439 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.18:51:44.439 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.18:51:44.439 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.18:51:44.439 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.18:51:44.447 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-20.18:51:44.448 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-20.18:51:44.448 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-20.18:51:44.448 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-20.18:51:44.449 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-20.18:51:44.449 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-20.18:51:47.656 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 17467 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-20.18:51:47.659 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-20.18:51:48.197 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-20.18:51:48.199 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-20.18:51:48.216 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 10 ms. Found 0 Redis repository interfaces.
24-06-20.18:51:48.619 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-20.18:51:48.624 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-20.18:51:48.624 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-20.18:51:48.625 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-20.18:51:48.669 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-20.18:51:48.669 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 986 ms
24-06-20.18:51:49.047 [main            ] INFO  Version                - Redisson 3.26.0
24-06-20.18:51:49.068 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-20.18:51:49.150 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.18:51:49.159 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.18:51:49.892 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-20.18:51:49.950 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.18:51:49.984 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.18:51:49.984 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.18:51:49.984 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718880709983
24-06-20.18:51:49.992 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-20.18:51:49.998 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.18:51:50.002 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.18:51:50.002 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.18:51:50.002 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718880710002
24-06-20.18:51:50.005 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-20.18:51:50.006 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.18:51:50.009 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.18:51:50.009 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.18:51:50.009 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718880710009
24-06-20.18:51:50.011 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-20.18:51:50.011 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
24-06-20.18:51:50.018 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-20.18:51:50.027 [main            ] INFO  Application            - Started Application in 2.659 seconds (JVM running for 2.925)
24-06-20.18:51:50.174 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-20.18:51:50.174 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-20.18:51:50.177 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-20.18:51:50.181 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.18:51:50.181 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.18:51:50.181 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.18:51:50.183 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:51:50.183 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:51:50.183 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:51:50.190 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.18:51:50.190 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.18:51:50.191 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.18:51:50.211 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-20.18:51:50.211 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-20.18:51:50.211 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-20.18:51:50.211 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.18:51:50.211 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.18:51:50.211 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.18:51:50.348 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.18:51:50.348 [RMI TCP Connection(3)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
24-06-20.18:51:50.348 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
24-06-20.18:51:50.349 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 1 ms
24-06-20.18:51:50.605 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.18:51:50.614 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.18:51:50.630 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.18:51:53.216 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=297, memberId='consumer-sku-deduct-group-2-de5c6a98-cc33-4b69-b38f-6dd4dd06968f', protocol='range'}
24-06-20.18:51:53.218 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=299, memberId='consumer-sku-clear-group-3-c8816293-c8dc-4217-b397-97b25e3da985', protocol='range'}
24-06-20.18:51:53.219 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=45, memberId='consumer-send-rebate-group-1-0787518e-5171-4bdc-affe-5084db896b41', protocol='range'}
24-06-20.18:51:53.223 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 45: {consumer-send-rebate-group-1-0787518e-5171-4bdc-affe-5084db896b41=Assignment(partitions=[send-rebate-topic-0])}
24-06-20.18:51:53.223 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 297: {consumer-sku-deduct-group-2-de5c6a98-cc33-4b69-b38f-6dd4dd06968f=Assignment(partitions=[sku-deduct-topic-0])}
24-06-20.18:51:53.223 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 299: {consumer-sku-clear-group-3-c8816293-c8dc-4217-b397-97b25e3da985=Assignment(partitions=[sku-clear-topic-0])}
24-06-20.18:51:53.236 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=297, memberId='consumer-sku-deduct-group-2-de5c6a98-cc33-4b69-b38f-6dd4dd06968f', protocol='range'}
24-06-20.18:51:53.236 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=45, memberId='consumer-send-rebate-group-1-0787518e-5171-4bdc-affe-5084db896b41', protocol='range'}
24-06-20.18:51:53.236 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=299, memberId='consumer-sku-clear-group-3-c8816293-c8dc-4217-b397-97b25e3da985', protocol='range'}
24-06-20.18:51:53.236 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-20.18:51:53.236 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-20.18:51:53.236 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-20.18:51:53.239 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-20.18:51:53.239 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-20.18:51:53.239 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-20.18:51:53.246 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.18:51:53.246 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=86, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.18:51:53.246 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Setting offset for partition send-rebate-topic-0 to the committed offset FetchPosition{offset=10, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.18:51:53.246 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-20.18:51:53.246 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-20.18:51:53.247 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-20.18:52:21.843 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.18:53:03.537 [http-nio-8091-exec-2] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":0,"dayCountSurplus":0,"monthCount":0,"monthCountSurplus":0,"totalCount":0,"totalCountSurplus":0}
24-06-20.18:53:04.507 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Revoke previously assigned partitions sku-clear-topic-0
24-06-20.18:53:04.507 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Revoke previously assigned partitions send-rebate-topic-0
24-06-20.18:53:04.507 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Revoke previously assigned partitions sku-deduct-topic-0
24-06-20.18:53:04.507 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-20.18:53:04.507 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-20.18:53:04.507 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-20.18:53:04.507 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-0787518e-5171-4bdc-affe-5084db896b41 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.18:53:04.507 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-de5c6a98-cc33-4b69-b38f-6dd4dd06968f sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.18:53:04.507 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-c8816293-c8dc-4217-b397-97b25e3da985 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.18:53:04.510 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:53:04.510 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:53:04.510 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:53:04.510 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:53:04.511 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.18:53:04.511 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:53:04.511 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.18:53:04.511 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:53:04.511 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.18:53:04.513 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:53:04.513 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:53:04.513 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:53:04.513 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:53:04.513 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:53:04.513 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:53:04.532 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.18:53:04.532 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.18:53:04.532 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.18:53:04.532 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.18:53:04.532 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.18:53:04.532 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.18:53:04.532 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.18:53:04.532 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.18:53:04.532 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.18:53:04.540 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-20.18:53:04.540 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-20.18:53:04.541 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-20.18:53:04.541 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-20.18:53:04.541 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-20.18:53:04.541 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-20.18:53:13.235 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 17685 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-20.18:53:13.236 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-20.18:53:13.800 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-20.18:53:13.801 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-20.18:53:13.823 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 13 ms. Found 0 Redis repository interfaces.
24-06-20.18:53:14.312 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-20.18:53:14.316 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-20.18:53:14.317 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-20.18:53:14.317 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-20.18:53:14.365 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-20.18:53:14.365 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1107 ms
24-06-20.18:53:14.903 [main            ] INFO  Version                - Redisson 3.26.0
24-06-20.18:53:14.919 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-20.18:53:14.995 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.18:53:15.003 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.18:53:15.683 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-20.18:53:15.837 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.18:53:15.873 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.18:53:15.873 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.18:53:15.873 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718880795873
24-06-20.18:53:15.881 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-20.18:53:15.890 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.18:53:15.895 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.18:53:15.895 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.18:53:15.895 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718880795895
24-06-20.18:53:15.901 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-20.18:53:15.903 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.18:53:15.908 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.18:53:15.908 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.18:53:15.908 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718880795908
24-06-20.18:53:15.911 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-20.18:53:15.920 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-20.18:53:15.933 [main            ] INFO  Application            - Started Application in 2.914 seconds (JVM running for 3.171)
24-06-20.18:53:16.116 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-20.18:53:16.116 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-20.18:53:16.116 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-20.18:53:16.117 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.18:53:16.117 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.18:53:16.117 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.18:53:16.118 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:53:16.118 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:53:16.118 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:53:16.123 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.18:53:16.123 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.18:53:16.123 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.18:53:16.153 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-20.18:53:16.153 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-20.18:53:16.153 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-20.18:53:16.154 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.18:53:16.154 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.18:53:16.154 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.18:53:16.954 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-3ccf1261-9102-4398-b7e2-b13de80f618d sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.18:53:16.954 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-a65b3d9c-6939-4914-bf67-4fa52ee832b6 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.18:53:16.954 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-9fa5e6f1-2052-4f29-8b68-bf4e4c7ecd6f sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.18:53:16.955 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:53:16.955 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:53:16.955 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:53:16.955 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:53:16.955 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:53:16.955 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.18:53:16.955 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:53:16.955 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.18:53:16.956 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.18:53:16.957 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:53:16.957 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:53:16.957 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:53:16.957 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:53:16.958 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:53:16.958 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:53:19.184 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.18:53:19.184 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.18:53:19.185 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.18:53:19.185 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.18:53:19.184 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.18:53:19.185 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.18:53:19.185 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.18:53:19.185 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.18:53:19.185 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.18:53:19.192 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-20.18:53:19.192 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-20.18:53:19.193 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-20.18:53:19.193 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-20.18:53:19.193 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-20.18:53:19.193 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-20.18:53:21.395 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 17707 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-20.18:53:21.396 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-20.18:53:21.973 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-20.18:53:21.975 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-20.18:53:22.001 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 15 ms. Found 0 Redis repository interfaces.
24-06-20.18:53:22.479 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-20.18:53:22.483 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-20.18:53:22.484 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-20.18:53:22.484 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-20.18:53:22.526 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-20.18:53:22.526 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1108 ms
24-06-20.18:53:22.897 [main            ] INFO  Version                - Redisson 3.26.0
24-06-20.18:53:22.916 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-20.18:53:23.030 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.18:53:23.039 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.18:53:23.604 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-20.18:53:23.746 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.18:53:23.780 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.18:53:23.780 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.18:53:23.780 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718880803780
24-06-20.18:53:23.788 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-20.18:53:23.795 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.18:53:23.798 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.18:53:23.798 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.18:53:23.798 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718880803798
24-06-20.18:53:23.801 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-20.18:53:23.802 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.18:53:23.805 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.18:53:23.805 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.18:53:23.805 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718880803805
24-06-20.18:53:23.808 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-20.18:53:23.809 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
24-06-20.18:53:23.817 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-20.18:53:23.827 [main            ] INFO  Application            - Started Application in 2.709 seconds (JVM running for 3.032)
24-06-20.18:53:23.976 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-20.18:53:23.976 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-20.18:53:23.976 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-20.18:53:23.977 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.18:53:23.977 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.18:53:23.977 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.18:53:23.977 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:53:23.977 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:53:23.977 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:53:23.980 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.18:53:23.980 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.18:53:23.980 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.18:53:23.991 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-20.18:53:23.991 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-20.18:53:23.991 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-20.18:53:23.991 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.18:53:23.991 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.18:53:23.991 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.18:53:24.016 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.18:53:24.017 [RMI TCP Connection(2)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
24-06-20.18:53:24.017 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
24-06-20.18:53:24.018 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 1 ms
24-06-20.18:53:24.277 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.18:53:24.287 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.18:53:24.308 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.18:53:27.004 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=303, memberId='consumer-sku-clear-group-3-4e64dc88-e1a3-4747-83ca-8c42fe9ecb85', protocol='range'}
24-06-20.18:53:27.004 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=49, memberId='consumer-send-rebate-group-1-e753b8bf-0743-4192-bf24-7fac0a19e311', protocol='range'}
24-06-20.18:53:27.004 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=301, memberId='consumer-sku-deduct-group-2-7fa71841-4f7c-4c8b-9a19-fe22a9a4b37e', protocol='range'}
24-06-20.18:53:27.016 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 303: {consumer-sku-clear-group-3-4e64dc88-e1a3-4747-83ca-8c42fe9ecb85=Assignment(partitions=[sku-clear-topic-0])}
24-06-20.18:53:27.016 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 301: {consumer-sku-deduct-group-2-7fa71841-4f7c-4c8b-9a19-fe22a9a4b37e=Assignment(partitions=[sku-deduct-topic-0])}
24-06-20.18:53:27.016 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 49: {consumer-send-rebate-group-1-e753b8bf-0743-4192-bf24-7fac0a19e311=Assignment(partitions=[send-rebate-topic-0])}
24-06-20.18:53:27.044 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=301, memberId='consumer-sku-deduct-group-2-7fa71841-4f7c-4c8b-9a19-fe22a9a4b37e', protocol='range'}
24-06-20.18:53:27.044 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=303, memberId='consumer-sku-clear-group-3-4e64dc88-e1a3-4747-83ca-8c42fe9ecb85', protocol='range'}
24-06-20.18:53:27.045 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=49, memberId='consumer-send-rebate-group-1-e753b8bf-0743-4192-bf24-7fac0a19e311', protocol='range'}
24-06-20.18:53:27.045 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-20.18:53:27.045 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-20.18:53:27.045 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-20.18:53:27.051 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-20.18:53:27.051 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-20.18:53:27.051 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-20.18:53:27.066 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=86, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.18:53:27.066 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Setting offset for partition send-rebate-topic-0 to the committed offset FetchPosition{offset=10, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.18:53:27.066 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.18:53:27.067 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-20.18:53:27.067 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-20.18:53:27.067 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-20.18:53:53.443 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.18:53:57.951 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":1000000,"dayCountSurplus":1000000,"monthCount":100003,"monthCountSurplus":97698,"totalCount":1000000,"totalCountSurplus":1000000}
24-06-20.18:54:12.648 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.18:54:12.648 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.18:54:12.652 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.18:54:12.652 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.18:54:12.673 [http-nio-8091-exec-4] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.18:54:25.065 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.18:54:25.065 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.18:54:25.087 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.18:54:25.087 [http-nio-8091-exec-12] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.18:54:25.089 [http-nio-8091-exec-11] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.18:54:25.089 [http-nio-8091-exec-1] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.18:54:25.096 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":1000000,"dayCountSurplus":1000000,"monthCount":100003,"monthCountSurplus":97698,"totalCount":1000000,"totalCountSurplus":1000000}
24-06-20.18:54:25.096 [http-nio-8091-exec-5] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":1000000,"dayCountSurplus":1000000,"monthCount":100003,"monthCountSurplus":97698,"totalCount":1000000,"totalCountSurplus":1000000}
24-06-20.18:54:25.112 [http-nio-8091-exec-12] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":1000000,"dayCountSurplus":1000000,"monthCount":100003,"monthCountSurplus":97698,"totalCount":1000000,"totalCountSurplus":1000000}
24-06-20.18:54:25.112 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.18:54:25.113 [http-nio-8091-exec-9] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.18:54:25.113 [http-nio-8091-exec-8] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.18:54:25.114 [http-nio-8091-exec-7] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.18:54:25.115 [http-nio-8091-exec-5] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.18:54:25.115 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":1000000,"dayCountSurplus":1000000,"monthCount":100003,"monthCountSurplus":97698,"totalCount":1000000,"totalCountSurplus":1000000}
24-06-20.18:54:25.115 [http-nio-8091-exec-4] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.18:54:25.116 [http-nio-8091-exec-9] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.18:54:25.256 [http-nio-8091-exec-2] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":false,"sort":5,"waitUnLockCount":3},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":false,"sort":6,"waitUnLockCount":2},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":false,"sort":7,"waitUnLockCount":1},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.18:54:25.256 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":false,"sort":5,"waitUnLockCount":3},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":false,"sort":6,"waitUnLockCount":2},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":false,"sort":7,"waitUnLockCount":1},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.18:54:25.257 [http-nio-8091-exec-11] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":false,"sort":5,"waitUnLockCount":3},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":false,"sort":6,"waitUnLockCount":2},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":false,"sort":7,"waitUnLockCount":1},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.18:54:25.258 [http-nio-8091-exec-1] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":false,"sort":5,"waitUnLockCount":3},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":false,"sort":6,"waitUnLockCount":2},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":false,"sort":7,"waitUnLockCount":1},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.18:54:32.905 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Revoke previously assigned partitions sku-clear-topic-0
24-06-20.18:54:32.905 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Revoke previously assigned partitions sku-deduct-topic-0
24-06-20.18:54:32.905 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-20.18:54:32.905 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Revoke previously assigned partitions send-rebate-topic-0
24-06-20.18:54:32.905 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-20.18:54:32.905 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-20.18:54:32.905 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-7fa71841-4f7c-4c8b-9a19-fe22a9a4b37e sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.18:54:32.905 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-4e64dc88-e1a3-4747-83ca-8c42fe9ecb85 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.18:54:32.905 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-e753b8bf-0743-4192-bf24-7fac0a19e311 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.18:54:32.907 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:54:32.907 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:54:32.907 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.18:54:32.907 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:54:32.907 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:54:32.907 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.18:54:32.908 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:54:32.908 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:54:32.908 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.18:54:32.909 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:54:32.909 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:54:32.909 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:54:32.909 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:54:32.909 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:54:32.910 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:54:32.954 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.18:54:32.954 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.18:54:32.955 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.18:54:32.955 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.18:54:32.955 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.18:54:32.955 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.18:54:32.955 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.18:54:32.955 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.18:54:32.955 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.18:54:32.963 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-20.18:54:32.964 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-20.18:54:32.965 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-20.18:54:32.965 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-20.18:54:32.965 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-20.18:54:32.965 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-20.18:54:35.514 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 17897 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-20.18:54:35.515 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-20.18:54:36.012 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-20.18:54:36.014 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-20.18:54:36.033 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 12 ms. Found 0 Redis repository interfaces.
24-06-20.18:54:36.500 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-20.18:54:36.505 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-20.18:54:36.505 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-20.18:54:36.505 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-20.18:54:36.556 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-20.18:54:36.556 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1021 ms
24-06-20.18:54:36.947 [main            ] INFO  Version                - Redisson 3.26.0
24-06-20.18:54:36.965 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-20.18:54:37.043 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.18:54:37.053 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.18:54:37.577 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-20.18:54:37.728 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.18:54:37.758 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.18:54:37.758 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.18:54:37.758 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718880877757
24-06-20.18:54:37.765 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-20.18:54:37.771 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.18:54:37.774 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.18:54:37.774 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.18:54:37.774 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718880877774
24-06-20.18:54:37.777 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-20.18:54:37.778 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.18:54:37.781 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.18:54:37.781 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.18:54:37.781 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718880877781
24-06-20.18:54:37.784 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-20.18:54:37.785 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
24-06-20.18:54:37.793 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-20.18:54:37.803 [main            ] INFO  Application            - Started Application in 2.541 seconds (JVM running for 2.981)
24-06-20.18:54:37.955 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-20.18:54:37.955 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-20.18:54:37.955 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-20.18:54:37.956 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.18:54:37.956 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.18:54:37.956 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.18:54:37.957 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:54:37.957 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:54:37.957 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:54:37.960 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.18:54:37.960 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.18:54:37.960 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.18:54:37.972 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-20.18:54:37.972 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-20.18:54:37.972 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-20.18:54:37.972 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.18:54:37.972 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.18:54:37.972 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.18:54:38.124 [RMI TCP Connection(3)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
24-06-20.18:54:38.124 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
24-06-20.18:54:38.126 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 2 ms
24-06-20.18:54:38.134 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.18:54:38.489 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.18:54:38.501 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.18:54:38.521 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.18:54:40.981 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=51, memberId='consumer-send-rebate-group-1-9c9b99a4-d9cb-46d1-9812-e64c7d8af4a3', protocol='range'}
24-06-20.18:54:40.981 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=305, memberId='consumer-sku-clear-group-3-f98f0684-f99f-4837-b50e-c83458f3db5a', protocol='range'}
24-06-20.18:54:40.981 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=303, memberId='consumer-sku-deduct-group-2-aa06e5d8-f0eb-44b8-bc86-ead8ec525cad', protocol='range'}
24-06-20.18:54:40.984 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 303: {consumer-sku-deduct-group-2-aa06e5d8-f0eb-44b8-bc86-ead8ec525cad=Assignment(partitions=[sku-deduct-topic-0])}
24-06-20.18:54:40.984 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 305: {consumer-sku-clear-group-3-f98f0684-f99f-4837-b50e-c83458f3db5a=Assignment(partitions=[sku-clear-topic-0])}
24-06-20.18:54:40.984 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 51: {consumer-send-rebate-group-1-9c9b99a4-d9cb-46d1-9812-e64c7d8af4a3=Assignment(partitions=[send-rebate-topic-0])}
24-06-20.18:54:40.997 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=303, memberId='consumer-sku-deduct-group-2-aa06e5d8-f0eb-44b8-bc86-ead8ec525cad', protocol='range'}
24-06-20.18:54:40.997 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=305, memberId='consumer-sku-clear-group-3-f98f0684-f99f-4837-b50e-c83458f3db5a', protocol='range'}
24-06-20.18:54:40.997 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=51, memberId='consumer-send-rebate-group-1-9c9b99a4-d9cb-46d1-9812-e64c7d8af4a3', protocol='range'}
24-06-20.18:54:40.997 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-20.18:54:40.997 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-20.18:54:40.997 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-20.18:54:40.999 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-20.18:54:40.999 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-20.18:54:40.999 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-20.18:54:41.011 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=86, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.18:54:41.011 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.18:54:41.011 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Setting offset for partition send-rebate-topic-0 to the committed offset FetchPosition{offset=10, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.18:54:41.012 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-20.18:54:41.012 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-20.18:54:41.012 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-20.18:54:45.526 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.18:54:45.526 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.18:54:45.540 [http-nio-8091-exec-1] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.18:54:45.540 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.18:54:45.540 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.18:54:45.540 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.18:54:45.553 [http-nio-8091-exec-1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.18:54:45.570 [http-nio-8091-exec-5] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.18:54:45.570 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.18:54:45.575 [http-nio-8091-exec-1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.18:54:45.759 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":1000000,"dayCountSurplus":1000000,"monthCount":100003,"monthCountSurplus":97698,"totalCount":1000000,"totalCountSurplus":1000000}
24-06-20.18:54:45.759 [http-nio-8091-exec-2] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":1000000,"dayCountSurplus":1000000,"monthCount":100003,"monthCountSurplus":97698,"totalCount":1000000,"totalCountSurplus":1000000}
24-06-20.18:54:45.769 [http-nio-8091-exec-1] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":false,"sort":5,"waitUnLockCount":3},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":false,"sort":6,"waitUnLockCount":2},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":false,"sort":7,"waitUnLockCount":1},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.18:54:45.769 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":false,"sort":5,"waitUnLockCount":3},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":false,"sort":6,"waitUnLockCount":2},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":false,"sort":7,"waitUnLockCount":1},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.18:55:19.777 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Revoke previously assigned partitions sku-deduct-topic-0
24-06-20.18:55:19.777 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Revoke previously assigned partitions sku-clear-topic-0
24-06-20.18:55:19.777 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Revoke previously assigned partitions send-rebate-topic-0
24-06-20.18:55:19.778 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-20.18:55:19.778 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-20.18:55:19.778 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-20.18:55:19.779 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-aa06e5d8-f0eb-44b8-bc86-ead8ec525cad sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.18:55:19.779 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-f98f0684-f99f-4837-b50e-c83458f3db5a sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.18:55:19.779 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-9c9b99a4-d9cb-46d1-9812-e64c7d8af4a3 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.18:55:19.781 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:55:19.781 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:55:19.781 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:55:19.781 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:55:19.781 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:55:19.781 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.18:55:19.781 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:55:19.781 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.18:55:19.781 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.18:55:19.782 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:55:19.782 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:55:19.783 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:55:19.783 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:55:19.783 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:55:19.783 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:55:19.802 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.18:55:19.802 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.18:55:19.803 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.18:55:19.803 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.18:55:19.803 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.18:55:19.803 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.18:55:19.803 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.18:55:19.803 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.18:55:19.803 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.18:55:19.810 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-20.18:55:19.810 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-20.18:55:19.810 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-20.18:55:19.810 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-20.18:55:19.810 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-20.18:55:19.810 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-20.18:55:23.869 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 18021 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-20.18:55:23.871 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-20.18:55:24.580 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-20.18:55:24.581 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-20.18:55:24.599 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 11 ms. Found 0 Redis repository interfaces.
24-06-20.18:55:25.187 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-20.18:55:25.192 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-20.18:55:25.192 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-20.18:55:25.192 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-20.18:55:25.240 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-20.18:55:25.240 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1330 ms
24-06-20.18:55:25.686 [main            ] INFO  Version                - Redisson 3.26.0
24-06-20.18:55:25.707 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-20.18:55:25.787 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.18:55:25.796 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.18:55:26.321 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-20.18:55:26.460 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.18:55:26.494 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.18:55:26.494 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.18:55:26.494 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718880926493
24-06-20.18:55:26.501 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-20.18:55:26.507 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.18:55:26.511 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.18:55:26.511 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.18:55:26.511 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718880926511
24-06-20.18:55:26.513 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-20.18:55:26.514 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.18:55:26.517 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.18:55:26.517 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.18:55:26.517 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718880926517
24-06-20.18:55:26.519 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-20.18:55:26.519 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
24-06-20.18:55:26.524 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-20.18:55:26.534 [main            ] INFO  Application            - Started Application in 2.909 seconds (JVM running for 3.2)
24-06-20.18:55:26.576 [RMI TCP Connection(2)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
24-06-20.18:55:26.576 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
24-06-20.18:55:26.576 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.18:55:26.577 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 1 ms
24-06-20.18:55:26.775 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-20.18:55:26.778 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.18:55:26.779 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:55:26.787 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.18:55:26.795 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-20.18:55:26.795 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.18:55:26.796 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:55:26.796 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.18:55:26.802 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-20.18:55:26.802 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.18:55:26.802 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-20.18:55:26.802 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-20.18:55:26.802 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.18:55:26.802 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.18:55:26.802 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:55:26.803 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.18:55:26.820 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-20.18:55:26.821 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.18:55:26.942 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.18:55:26.950 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.18:55:26.967 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.18:55:29.808 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=307, memberId='consumer-sku-clear-group-3-c8301c74-e204-44be-8d17-f30e4ae78a93', protocol='range'}
24-06-20.18:55:29.808 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=305, memberId='consumer-sku-deduct-group-2-dd0496c7-595a-42f4-85bc-e3e2d64d90c8', protocol='range'}
24-06-20.18:55:29.811 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 307: {consumer-sku-clear-group-3-c8301c74-e204-44be-8d17-f30e4ae78a93=Assignment(partitions=[sku-clear-topic-0])}
24-06-20.18:55:29.811 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 305: {consumer-sku-deduct-group-2-dd0496c7-595a-42f4-85bc-e3e2d64d90c8=Assignment(partitions=[sku-deduct-topic-0])}
24-06-20.18:55:29.825 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=53, memberId='consumer-send-rebate-group-1-aa6c6665-7f22-4a1f-98df-08d93d65a9a7', protocol='range'}
24-06-20.18:55:29.825 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 53: {consumer-send-rebate-group-1-aa6c6665-7f22-4a1f-98df-08d93d65a9a7=Assignment(partitions=[send-rebate-topic-0])}
24-06-20.18:55:29.825 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=307, memberId='consumer-sku-clear-group-3-c8301c74-e204-44be-8d17-f30e4ae78a93', protocol='range'}
24-06-20.18:55:29.825 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=305, memberId='consumer-sku-deduct-group-2-dd0496c7-595a-42f4-85bc-e3e2d64d90c8', protocol='range'}
24-06-20.18:55:29.825 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-20.18:55:29.826 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-20.18:55:29.827 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=53, memberId='consumer-send-rebate-group-1-aa6c6665-7f22-4a1f-98df-08d93d65a9a7', protocol='range'}
24-06-20.18:55:29.827 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-20.18:55:29.827 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-20.18:55:29.827 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-20.18:55:29.827 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-20.18:55:29.837 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.18:55:29.837 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Setting offset for partition send-rebate-topic-0 to the committed offset FetchPosition{offset=10, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.18:55:29.837 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=86, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.18:55:29.838 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-20.18:55:29.838 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-20.18:55:29.838 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-20.18:55:30.209 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.18:55:30.209 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.18:55:30.222 [http-nio-8091-exec-1] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.18:55:30.222 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.18:55:30.222 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.18:55:30.223 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.18:55:30.238 [http-nio-8091-exec-1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.18:55:30.262 [http-nio-8091-exec-5] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.18:55:30.262 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.18:55:30.266 [http-nio-8091-exec-1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.18:55:30.451 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":1000000,"dayCountSurplus":1000000,"monthCount":100003,"monthCountSurplus":97698,"totalCount":1000000,"totalCountSurplus":1000000}
24-06-20.18:55:30.460 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":1000000,"dayCountSurplus":1000000,"monthCount":100003,"monthCountSurplus":97698,"totalCount":1000000,"totalCountSurplus":1000000}
24-06-20.18:55:30.463 [http-nio-8091-exec-2] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":false,"sort":5,"waitUnLockCount":3},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":false,"sort":6,"waitUnLockCount":2},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":false,"sort":7,"waitUnLockCount":1},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.18:55:30.467 [http-nio-8091-exec-1] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":false,"sort":5,"waitUnLockCount":3},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":false,"sort":6,"waitUnLockCount":2},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":false,"sort":7,"waitUnLockCount":1},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.18:55:36.612 [http-nio-8091-exec-3] INFO  RaffleActivityController - 日历签到返利开始 userId:matthew
24-06-20.18:55:36.614 [http-nio-8091-exec-3] INFO  BehaviorRebateService  - 开始创建返利订单 userId:matthew 
24-06-20.18:55:36.699 [http-nio-8091-exec-3] INFO  ProducerConfig         - Idempotence will be disabled because acks is set to 1, not set to 'all'.
24-06-20.18:55:36.699 [http-nio-8091-exec-3] INFO  ProducerConfig         - ProducerConfig values: 
	acks = 1
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-1
	compression.type = none
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = false
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.class = class org.apache.kafka.clients.producer.internals.DefaultPartitioner
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 1
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

24-06-20.18:55:36.712 [http-nio-8091-exec-3] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.18:55:36.712 [http-nio-8091-exec-3] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.18:55:36.712 [http-nio-8091-exec-3] INFO  AppInfoParser          - Kafka startTimeMs: 1718880936712
24-06-20.18:55:36.717 [kafka-producer-network-thread | producer-1] INFO  Metadata               - [Producer clientId=producer-1] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.18:55:36.721 [kafka-producer-network-thread | producer-1] INFO  Metadata               - [Producer clientId=producer-1] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-20.18:55:36.728 [http-nio-8091-exec-3] INFO  EventPublisher         - 发送MQ消息 topic:send-rebate-topic message:{"data":{"bizId":"matthew_sku_20240620","rebateConfig":"999","rebateDesc":"签到返利-sku额度","rebateType":"sku","userId":"matthew"},"id":"70146525021","timestamp":1718880936632}
24-06-20.18:55:36.735 [http-nio-8091-exec-3] INFO  EventPublisher         - 发送MQ消息 topic:send-rebate-topic message:{"data":{"bizId":"matthew_integral_20240620","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"integral","userId":"matthew"},"id":"59931364964","timestamp":1718880936634}
24-06-20.18:55:36.737 [http-nio-8091-exec-3] INFO  RaffleActivityController - 日历签到返利完成 userId:matthew orderIds: ["709544175294","961717687769"]
24-06-20.18:55:36.749 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_sku_20240620","rebateConfig":"999","rebateDesc":"签到返利-sku额度","rebateType":"sku","userId":"matthew"},"id":"70146525021","timestamp":1718880936632}]
24-06-20.18:55:36.779 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单，userId: matthew sku: 999 outBusinessNo: matthew_sku_20240620
24-06-20.18:55:36.802 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivityService - 创建充值订单 SKU 查询结果：{"activityCountId":100001,"activityId":100001,"sku":999,"stockCount":1000000,"stockCountSurplus":999994} {"activityId":100001,"activityName":"测试活动","beginDateTime":1709979310000,"endDateTime":2025512110000,"state":"open","strategyId":100006} {"activityCountId":100001,"dayCount":1,"monthCount":1,"totalCount":1}
24-06-20.18:55:36.802 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ActivityBaseChainNode  - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:999 activityId:100001
24-06-20.18:55:36.802 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ActivitySkuStockActionChainNode - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:999 activityId:100001
24-06-20.18:55:36.809 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ActivitySkuStockActionChainNode - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:999 activityId:100001
24-06-20.18:55:36.813 [kafka-producer-network-thread | producer-1] INFO  Metadata               - [Producer clientId=producer-1] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-20.18:55:36.814 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  EventPublisher         - 发送MQ消息 topic:sku-deduct-topic message:{"data":{"activityId":100001,"sku":999},"id":"62635874706","timestamp":1718880936812}
24-06-20.18:55:36.845 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户行为返利消息消费成功! Topic:send-rebate-topic,Message:{"data":{"bizId":"matthew_sku_20240620","rebateConfig":"999","rebateDesc":"签到返利-sku额度","rebateType":"sku","userId":"matthew"},"id":"70146525021","timestamp":1718880936632}
24-06-20.18:55:36.845 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ActivitySkuStockConsumeMessageListener - Kafka库存扣减消费成功! Topic:sku-deduct-topic,Message:{"data":{"activityId":100001,"sku":999},"id":"62635874706","timestamp":1718880936812}
24-06-20.18:55:36.846 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240620","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"integral","userId":"matthew"},"id":"59931364964","timestamp":1718880936634}]
24-06-20.18:55:36.849 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户行为返利消息 - 非 sku 奖励暂时不处理 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240620","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"integral","userId":"matthew"},"id":"59931364964","timestamp":1718880936634}]
24-06-20.18:57:41.765 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Revoke previously assigned partitions sku-clear-topic-0
24-06-20.18:57:41.765 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Revoke previously assigned partitions send-rebate-topic-0
24-06-20.18:57:41.765 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Revoke previously assigned partitions sku-deduct-topic-0
24-06-20.18:57:41.766 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-20.18:57:41.766 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-20.18:57:41.766 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-20.18:57:41.767 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-aa6c6665-7f22-4a1f-98df-08d93d65a9a7 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.18:57:41.767 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-c8301c74-e204-44be-8d17-f30e4ae78a93 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.18:57:41.767 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-dd0496c7-595a-42f4-85bc-e3e2d64d90c8 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.18:57:41.769 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:57:41.769 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:57:41.769 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:57:41.769 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:57:41.769 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:57:41.769 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:57:41.769 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.18:57:41.769 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.18:57:41.769 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.18:57:41.771 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:57:41.771 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:57:41.771 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:57:41.771 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:57:41.772 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.18:57:41.772 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.18:57:41.784 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.18:57:41.784 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.18:57:41.784 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.18:57:41.784 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.18:57:41.784 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.18:57:41.784 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.18:57:41.784 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.18:57:41.785 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.18:57:41.785 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.18:57:41.790 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-20.18:57:41.790 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-20.18:57:41.790 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-20.18:57:41.790 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-20.18:57:41.790 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-20.18:57:41.790 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-20.18:57:41.798 [SpringApplicationShutdownHook] INFO  KafkaProducer          - [Producer clientId=producer-1] Closing the Kafka producer with timeoutMillis = 30000 ms.
24-06-20.18:57:41.800 [SpringApplicationShutdownHook] INFO  Metrics                - Metrics scheduler closed
24-06-20.18:57:41.800 [SpringApplicationShutdownHook] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.18:57:41.800 [SpringApplicationShutdownHook] INFO  Metrics                - Metrics reporters closed
24-06-20.18:57:41.800 [SpringApplicationShutdownHook] INFO  AppInfoParser          - App info kafka.producer for producer-1 unregistered
24-06-20.18:57:45.570 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 18365 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-20.18:57:45.571 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-20.18:57:46.076 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-20.18:57:46.077 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-20.18:57:46.095 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 11 ms. Found 0 Redis repository interfaces.
24-06-20.18:57:46.473 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-20.18:57:46.476 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-20.18:57:46.477 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-20.18:57:46.477 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-20.18:57:46.515 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-20.18:57:46.515 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 926 ms
24-06-20.18:57:46.867 [main            ] INFO  Version                - Redisson 3.26.0
24-06-20.18:57:46.882 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-20.18:57:46.948 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.18:57:46.956 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.18:57:47.457 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-20.18:57:47.584 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.18:57:47.614 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.18:57:47.615 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.18:57:47.615 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718881067614
24-06-20.18:57:47.622 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-20.18:57:47.627 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.18:57:47.631 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.18:57:47.631 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.18:57:47.631 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718881067631
24-06-20.18:57:47.634 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-20.18:57:47.635 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.18:57:47.638 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.18:57:47.638 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.18:57:47.638 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718881067638
24-06-20.18:57:47.640 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-20.18:57:47.640 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
24-06-20.18:57:47.646 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-20.18:57:47.654 [main            ] INFO  Application            - Started Application in 2.287 seconds (JVM running for 2.576)
24-06-20.18:57:47.787 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-20.18:57:47.787 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-20.18:57:47.787 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-20.18:57:47.788 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.18:57:47.788 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.18:57:47.788 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.18:57:47.789 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:57:47.789 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:57:47.789 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.18:57:47.793 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.18:57:47.793 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.18:57:47.793 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.18:57:47.804 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-20.18:57:47.804 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.18:57:47.806 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-20.18:57:47.806 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-20.18:57:47.806 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.18:57:47.806 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.18:57:47.863 [RMI TCP Connection(2)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
24-06-20.18:57:47.863 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
24-06-20.18:57:47.863 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.18:57:47.864 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 1 ms
24-06-20.18:57:48.161 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.18:57:48.170 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.18:57:48.186 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.18:57:50.822 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=55, memberId='consumer-send-rebate-group-1-8a4adfdd-f1f1-491d-aa54-764818607e02', protocol='range'}
24-06-20.18:57:50.822 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=307, memberId='consumer-sku-deduct-group-2-1a2c2845-52cb-4b51-a99f-4a7faadacc2d', protocol='range'}
24-06-20.18:57:50.822 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=309, memberId='consumer-sku-clear-group-3-f23b6d9d-c4f4-4039-91af-00a6487de434', protocol='range'}
24-06-20.18:57:50.827 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 55: {consumer-send-rebate-group-1-8a4adfdd-f1f1-491d-aa54-764818607e02=Assignment(partitions=[send-rebate-topic-0])}
24-06-20.18:57:50.827 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 309: {consumer-sku-clear-group-3-f23b6d9d-c4f4-4039-91af-00a6487de434=Assignment(partitions=[sku-clear-topic-0])}
24-06-20.18:57:50.827 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 307: {consumer-sku-deduct-group-2-1a2c2845-52cb-4b51-a99f-4a7faadacc2d=Assignment(partitions=[sku-deduct-topic-0])}
24-06-20.18:57:50.876 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=307, memberId='consumer-sku-deduct-group-2-1a2c2845-52cb-4b51-a99f-4a7faadacc2d', protocol='range'}
24-06-20.18:57:50.876 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=309, memberId='consumer-sku-clear-group-3-f23b6d9d-c4f4-4039-91af-00a6487de434', protocol='range'}
24-06-20.18:57:50.876 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=55, memberId='consumer-send-rebate-group-1-8a4adfdd-f1f1-491d-aa54-764818607e02', protocol='range'}
24-06-20.18:57:50.877 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-20.18:57:50.877 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-20.18:57:50.877 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-20.18:57:50.881 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-20.18:57:50.881 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-20.18:57:50.881 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-20.18:57:50.895 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Setting offset for partition send-rebate-topic-0 to the committed offset FetchPosition{offset=12, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.18:57:50.895 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=87, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.18:57:50.895 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.18:57:50.896 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-20.18:57:50.896 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-20.18:57:50.896 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-20.18:58:05.024 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.18:58:05.024 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.18:58:05.041 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.18:58:05.041 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.18:58:05.041 [http-nio-8091-exec-1] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.18:58:05.041 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.18:58:05.059 [http-nio-8091-exec-1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.18:58:05.078 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.18:58:05.078 [http-nio-8091-exec-5] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.18:58:05.087 [http-nio-8091-exec-1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.18:58:05.421 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":1000000,"dayCountSurplus":1000000,"monthCount":100004,"monthCountSurplus":97699,"totalCount":1000000,"totalCountSurplus":1000000}
24-06-20.18:58:05.425 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":1000000,"dayCountSurplus":1000000,"monthCount":100004,"monthCountSurplus":97699,"totalCount":1000000,"totalCountSurplus":1000000}
24-06-20.18:58:05.427 [http-nio-8091-exec-1] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":false,"sort":5,"waitUnLockCount":3},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":false,"sort":6,"waitUnLockCount":2},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":false,"sort":7,"waitUnLockCount":1},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.18:58:05.439 [http-nio-8091-exec-2] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":false,"sort":5,"waitUnLockCount":3},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":false,"sort":6,"waitUnLockCount":2},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":false,"sort":7,"waitUnLockCount":1},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.18:59:41.776 [http-nio-8091-exec-7] WARN  DefaultHandlerExceptionResolver - Resolved [org.springframework.web.HttpRequestMethodNotSupportedException: Request method 'GET' not supported]
24-06-20.18:59:51.876 [http-nio-8091-exec-9] INFO  RaffleActivityController - 开始查询权重配置 userId:null activityId:null
24-06-20.18:59:51.880 [http-nio-8091-exec-9] INFO  RaffleActivityController - 规则权重查询失败，userId:null activityId:null
cn.matthew.types.exception.AppException: null
	at cn.matthew.trigger.http.RaffleActivityController.queryRaffleRuleWeight(RaffleActivityController.java:333)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.19:00:12.768 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Revoke previously assigned partitions sku-clear-topic-0
24-06-20.19:00:12.768 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Revoke previously assigned partitions sku-deduct-topic-0
24-06-20.19:00:12.768 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Revoke previously assigned partitions send-rebate-topic-0
24-06-20.19:00:12.769 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-20.19:00:12.769 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-20.19:00:12.769 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-20.19:00:12.769 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-8a4adfdd-f1f1-491d-aa54-764818607e02 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.19:00:12.769 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-f23b6d9d-c4f4-4039-91af-00a6487de434 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.19:00:12.769 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-1a2c2845-52cb-4b51-a99f-4a7faadacc2d sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.19:00:12.770 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.19:00:12.770 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.19:00:12.770 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.19:00:12.770 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.19:00:12.770 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.19:00:12.770 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.19:00:12.770 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.19:00:12.770 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.19:00:12.770 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.19:00:12.771 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.19:00:12.771 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.19:00:12.771 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.19:00:12.771 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.19:00:12.772 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.19:00:12.772 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.19:00:12.786 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.19:00:12.786 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.19:00:12.786 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.19:00:12.786 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.19:00:12.786 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.19:00:12.786 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.19:00:12.786 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.19:00:12.786 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.19:00:12.786 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.19:00:12.790 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-20.19:00:12.791 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-20.19:00:12.791 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-20.19:00:12.791 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-20.19:00:12.791 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-20.19:00:12.791 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-20.19:00:16.755 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 18760 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-20.19:00:16.757 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-20.19:00:17.277 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-20.19:00:17.278 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-20.19:00:17.297 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 12 ms. Found 0 Redis repository interfaces.
24-06-20.19:00:17.716 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-20.19:00:17.720 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-20.19:00:17.721 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-20.19:00:17.721 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-20.19:00:17.764 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-20.19:00:17.764 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 983 ms
24-06-20.19:00:18.203 [main            ] INFO  Version                - Redisson 3.26.0
24-06-20.19:00:18.223 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-20.19:00:18.303 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.19:00:18.323 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.19:00:18.849 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-20.19:00:18.987 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.19:00:19.017 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.19:00:19.017 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.19:00:19.017 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718881219016
24-06-20.19:00:19.024 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-20.19:00:19.029 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.19:00:19.033 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.19:00:19.033 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.19:00:19.033 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718881219033
24-06-20.19:00:19.036 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-20.19:00:19.037 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.19:00:19.040 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.19:00:19.040 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.19:00:19.040 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718881219040
24-06-20.19:00:19.042 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-20.19:00:19.043 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
24-06-20.19:00:19.049 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-20.19:00:19.057 [main            ] INFO  Application            - Started Application in 2.626 seconds (JVM running for 2.956)
24-06-20.19:00:19.199 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-20.19:00:19.199 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-20.19:00:19.199 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-20.19:00:19.199 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.19:00:19.199 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.19:00:19.199 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.19:00:19.200 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.19:00:19.200 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.19:00:19.200 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.19:00:19.203 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.19:00:19.203 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.19:00:19.203 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.19:00:19.215 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-20.19:00:19.215 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-20.19:00:19.215 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-20.19:00:19.215 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.19:00:19.215 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.19:00:19.215 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.19:00:19.381 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.19:00:19.385 [RMI TCP Connection(2)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
24-06-20.19:00:19.385 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
24-06-20.19:00:19.386 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 1 ms
24-06-20.19:00:19.715 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.19:00:19.724 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.19:00:19.745 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.19:00:22.226 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=309, memberId='consumer-sku-deduct-group-2-27eca89d-24fe-40b9-9a40-6304bfafe0b8', protocol='range'}
24-06-20.19:00:22.226 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=311, memberId='consumer-sku-clear-group-3-04b99446-5138-4066-8ca0-2ddce391af57', protocol='range'}
24-06-20.19:00:22.226 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=57, memberId='consumer-send-rebate-group-1-88c6cbfc-7bae-45fd-b00b-69a120452ab0', protocol='range'}
24-06-20.19:00:22.231 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 309: {consumer-sku-deduct-group-2-27eca89d-24fe-40b9-9a40-6304bfafe0b8=Assignment(partitions=[sku-deduct-topic-0])}
24-06-20.19:00:22.231 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 311: {consumer-sku-clear-group-3-04b99446-5138-4066-8ca0-2ddce391af57=Assignment(partitions=[sku-clear-topic-0])}
24-06-20.19:00:22.231 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 57: {consumer-send-rebate-group-1-88c6cbfc-7bae-45fd-b00b-69a120452ab0=Assignment(partitions=[send-rebate-topic-0])}
24-06-20.19:00:22.251 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=57, memberId='consumer-send-rebate-group-1-88c6cbfc-7bae-45fd-b00b-69a120452ab0', protocol='range'}
24-06-20.19:00:22.251 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=311, memberId='consumer-sku-clear-group-3-04b99446-5138-4066-8ca0-2ddce391af57', protocol='range'}
24-06-20.19:00:22.251 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=309, memberId='consumer-sku-deduct-group-2-27eca89d-24fe-40b9-9a40-6304bfafe0b8', protocol='range'}
24-06-20.19:00:22.252 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-20.19:00:22.252 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-20.19:00:22.252 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-20.19:00:22.255 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-20.19:00:22.255 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-20.19:00:22.255 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-20.19:00:22.269 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=87, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.19:00:22.269 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.19:00:22.269 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Setting offset for partition send-rebate-topic-0 to the committed offset FetchPosition{offset=12, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.19:00:22.270 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-20.19:00:22.270 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-20.19:00:22.270 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-20.19:00:40.284 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:00:40.339 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.19:00:40.354 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.19:00:40.369 [http-nio-8091-exec-2] INFO  RaffleActivityController - 规则权重查询失败，userId:matthew activityId:100001
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.StrategyRepository.queryRaffleRuleWeightByStrategyId(StrategyRepository.java:333)
	at cn.matthew.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$48135f4a.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$c0f29fa7.queryRaffleRuleWeightByStrategyId(<generated>)
	at cn.matthew.domain.strategy.service.raffle.DefaultRaffleStrategy.queryRaffleRuleWeightByStrategyId(DefaultRaffleStrategy.java:84)
	at cn.matthew.domain.strategy.service.raffle.DefaultRaffleStrategy.queryRaffleRuleWeightByActivityId(DefaultRaffleStrategy.java:80)
	at cn.matthew.trigger.http.RaffleActivityController.queryRaffleRuleWeight(RaffleActivityController.java:340)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.19:01:37.150 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:01:37.265 [http-nio-8091-exec-3] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"},{"awardId":104,"awardTitle":"小米台灯"},{"awardId":105,"awardTitle":"小米su7周体验"},{"awardId":106,"awardTitle":"轻奢办公椅"},{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"},{"awardId":104,"awardTitle":"小米台灯"},{"awardId":105,"awardTitle":"小米su7周体验"}],"ruleWeightCount":100,"userUsedCount":0},{"awardList":[{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"},{"awardId":104,"awardTitle":"小米台灯"},{"awardId":105,"awardTitle":"小米su7周体验"},{"awardId":106,"awardTitle":"轻奢办公椅"},{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"},{"awardId":104,"awardTitle":"小米台灯"},{"awardId":105,"awardTitle":"小米su7周体验"}],"ruleWeightCount":500,"userUsedCount":0},{"awardList":[{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"},{"awardId":104,"awardTitle":"小米台灯"},{"awardId":105,"awardTitle":"小米su7周体验"},{"awardId":106,"awardTitle":"轻奢办公椅"},{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"},{"awardId":104,"awardTitle":"小米台灯"},{"awardId":105,"awardTitle":"小米su7周体验"}],"ruleWeightCount":50,"userUsedCount":0}]
24-06-20.19:01:44.806 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:01:44.806 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:01:44.806 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:01:44.806 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:01:44.816 [http-nio-8091-exec-9] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:01:44.817 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:01:44.829 [http-nio-8091-exec-9] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:01:44.832 [http-nio-8091-exec-8] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:01:44.878 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":1000000,"dayCountSurplus":1000000,"monthCount":100004,"monthCountSurplus":97699,"totalCount":1000000,"totalCountSurplus":1000000}
24-06-20.19:01:44.878 [http-nio-8091-exec-7] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":1000000,"dayCountSurplus":1000000,"monthCount":100004,"monthCountSurplus":97699,"totalCount":1000000,"totalCountSurplus":1000000}
24-06-20.19:01:44.922 [http-nio-8091-exec-5] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":false,"sort":5,"waitUnLockCount":3},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":false,"sort":6,"waitUnLockCount":2},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":false,"sort":7,"waitUnLockCount":1},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:01:44.922 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":false,"sort":5,"waitUnLockCount":3},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":false,"sort":6,"waitUnLockCount":2},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":false,"sort":7,"waitUnLockCount":1},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:01:56.139 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:01:56.139 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:01:56.159 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:01:56.159 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:01:56.162 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:01:56.163 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:01:56.170 [http-nio-8091-exec-2] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:01:56.170 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:01:56.177 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":1000000,"dayCountSurplus":1000000,"monthCount":100004,"monthCountSurplus":97699,"totalCount":1000000,"totalCountSurplus":1000000}
24-06-20.19:01:56.177 [http-nio-8091-exec-5] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":1000000,"dayCountSurplus":1000000,"monthCount":100004,"monthCountSurplus":97699,"totalCount":1000000,"totalCountSurplus":1000000}
24-06-20.19:01:56.179 [http-nio-8091-exec-7] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":false,"sort":5,"waitUnLockCount":3},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":false,"sort":6,"waitUnLockCount":2},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":false,"sort":7,"waitUnLockCount":1},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:01:56.179 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":false,"sort":5,"waitUnLockCount":3},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":false,"sort":6,"waitUnLockCount":2},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":false,"sort":7,"waitUnLockCount":1},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:02:12.903 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:02:12.925 [http-nio-8091-exec-5] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"},{"awardId":104,"awardTitle":"小米台灯"},{"awardId":105,"awardTitle":"小米su7周体验"},{"awardId":106,"awardTitle":"轻奢办公椅"},{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"},{"awardId":104,"awardTitle":"小米台灯"},{"awardId":105,"awardTitle":"小米su7周体验"}],"ruleWeightCount":100,"userUsedCount":0},{"awardList":[{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"},{"awardId":104,"awardTitle":"小米台灯"},{"awardId":105,"awardTitle":"小米su7周体验"},{"awardId":106,"awardTitle":"轻奢办公椅"},{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"},{"awardId":104,"awardTitle":"小米台灯"},{"awardId":105,"awardTitle":"小米su7周体验"}],"ruleWeightCount":500,"userUsedCount":0},{"awardList":[{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"},{"awardId":104,"awardTitle":"小米台灯"},{"awardId":105,"awardTitle":"小米su7周体验"},{"awardId":106,"awardTitle":"轻奢办公椅"},{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"},{"awardId":104,"awardTitle":"小米台灯"},{"awardId":105,"awardTitle":"小米su7周体验"}],"ruleWeightCount":50,"userUsedCount":0}]
24-06-20.19:04:31.024 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:04:31.062 [http-nio-8091-exec-6] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":108,"awardTitle":"暴走玩偶"},{"awardId":102,"awardTitle":"OpenAI会员卡"}],"ruleWeightCount":500,"userUsedCount":0},{"awardList":[{"awardId":108,"awardTitle":"暴走玩偶"},{"awardId":102,"awardTitle":"OpenAI会员卡"}],"ruleWeightCount":50,"userUsedCount":0}]
24-06-20.19:09:05.732 [http-nio-8091-exec-1] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:09:05.732 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:09:05.747 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:09:05.748 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:09:05.749 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:09:05.749 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:09:05.794 [http-nio-8091-exec-7] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:09:05.795 [http-nio-8091-exec-2] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:09:05.807 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":1000000,"dayCountSurplus":1000000,"monthCount":100004,"monthCountSurplus":97699,"totalCount":1000000,"totalCountSurplus":1000000}
24-06-20.19:09:05.808 [http-nio-8091-exec-10] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":false,"sort":5,"waitUnLockCount":3},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":false,"sort":6,"waitUnLockCount":2},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":false,"sort":7,"waitUnLockCount":1},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:09:05.809 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":1000000,"dayCountSurplus":1000000,"monthCount":100004,"monthCountSurplus":97699,"totalCount":1000000,"totalCountSurplus":1000000}
24-06-20.19:09:05.821 [http-nio-8091-exec-1] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":false,"sort":5,"waitUnLockCount":3},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":false,"sort":6,"waitUnLockCount":2},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":false,"sort":7,"waitUnLockCount":1},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:09:19.360 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Node -1 disconnected.
24-06-20.19:09:19.360 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Node -1 disconnected.
24-06-20.19:09:19.360 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Node -1 disconnected.
24-06-20.19:12:01.518 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Revoke previously assigned partitions send-rebate-topic-0
24-06-20.19:12:01.520 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-20.19:12:01.520 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Revoke previously assigned partitions sku-deduct-topic-0
24-06-20.19:12:01.520 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Revoke previously assigned partitions sku-clear-topic-0
24-06-20.19:12:01.520 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-20.19:12:01.520 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-04b99446-5138-4066-8ca0-2ddce391af57 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.19:12:01.520 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-20.19:12:01.522 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-27eca89d-24fe-40b9-9a40-6304bfafe0b8 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.19:12:01.522 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-88c6cbfc-7bae-45fd-b00b-69a120452ab0 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.19:12:01.523 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.19:12:01.523 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.19:12:01.523 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.19:12:01.523 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.19:12:01.523 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.19:12:01.523 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.19:12:01.523 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.19:12:01.523 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.19:12:01.523 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.19:12:01.524 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.19:12:01.524 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.19:12:01.525 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.19:12:01.525 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.19:12:01.526 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.19:12:01.526 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.19:12:01.535 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.19:12:01.535 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.19:12:01.535 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.19:12:01.535 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.19:12:01.535 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.19:12:01.535 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.19:12:01.535 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.19:12:01.535 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.19:12:01.535 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.19:12:01.542 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-20.19:12:01.542 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-20.19:12:01.543 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-20.19:12:01.543 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-20.19:12:01.543 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-20.19:12:01.543 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-20.19:12:03.951 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 20543 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-20.19:12:03.952 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-20.19:12:04.483 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-20.19:12:04.484 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-20.19:12:04.503 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 11 ms. Found 0 Redis repository interfaces.
24-06-20.19:12:04.931 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-20.19:12:04.936 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-20.19:12:04.936 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-20.19:12:04.936 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-20.19:12:04.980 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-20.19:12:04.980 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1005 ms
24-06-20.19:12:05.362 [main            ] INFO  Version                - Redisson 3.26.0
24-06-20.19:12:05.440 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-20.19:12:05.520 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.19:12:05.529 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.19:12:06.178 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-20.19:12:06.238 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.19:12:06.271 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.19:12:06.271 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.19:12:06.271 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718881926271
24-06-20.19:12:06.279 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-20.19:12:06.286 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.19:12:06.290 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.19:12:06.290 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.19:12:06.290 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718881926290
24-06-20.19:12:06.293 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-20.19:12:06.294 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.19:12:06.296 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.19:12:06.296 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.19:12:06.296 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718881926296
24-06-20.19:12:06.299 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-20.19:12:06.299 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
24-06-20.19:12:06.305 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-20.19:12:06.314 [main            ] INFO  Application            - Started Application in 2.716 seconds (JVM running for 3.15)
24-06-20.19:12:06.421 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.19:12:06.450 [RMI TCP Connection(2)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
24-06-20.19:12:06.450 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
24-06-20.19:12:06.456 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 6 ms
24-06-20.19:12:06.554 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-20.19:12:06.554 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-20.19:12:06.555 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-20.19:12:06.556 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.19:12:06.556 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.19:12:06.556 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.19:12:06.556 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.19:12:06.556 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.19:12:06.556 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.19:12:06.561 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.19:12:06.563 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.19:12:06.563 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.19:12:06.579 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-20.19:12:06.579 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.19:12:06.581 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-20.19:12:06.581 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.19:12:06.586 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-20.19:12:06.587 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.19:12:06.873 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.19:12:06.884 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.19:12:06.901 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.19:12:09.595 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=311, memberId='consumer-sku-deduct-group-2-051d8300-75bd-49b1-9ea1-11a06914951e', protocol='range'}
24-06-20.19:12:09.595 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=313, memberId='consumer-sku-clear-group-3-3e9b5903-fa41-4d70-921b-c9197f5e580d', protocol='range'}
24-06-20.19:12:09.595 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=59, memberId='consumer-send-rebate-group-1-760ab965-543a-4023-a047-d2db1066bedf', protocol='range'}
24-06-20.19:12:09.604 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 311: {consumer-sku-deduct-group-2-051d8300-75bd-49b1-9ea1-11a06914951e=Assignment(partitions=[sku-deduct-topic-0])}
24-06-20.19:12:09.604 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 59: {consumer-send-rebate-group-1-760ab965-543a-4023-a047-d2db1066bedf=Assignment(partitions=[send-rebate-topic-0])}
24-06-20.19:12:09.604 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 313: {consumer-sku-clear-group-3-3e9b5903-fa41-4d70-921b-c9197f5e580d=Assignment(partitions=[sku-clear-topic-0])}
24-06-20.19:12:09.646 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=59, memberId='consumer-send-rebate-group-1-760ab965-543a-4023-a047-d2db1066bedf', protocol='range'}
24-06-20.19:12:09.646 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=311, memberId='consumer-sku-deduct-group-2-051d8300-75bd-49b1-9ea1-11a06914951e', protocol='range'}
24-06-20.19:12:09.646 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=313, memberId='consumer-sku-clear-group-3-3e9b5903-fa41-4d70-921b-c9197f5e580d', protocol='range'}
24-06-20.19:12:09.647 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-20.19:12:09.647 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-20.19:12:09.647 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-20.19:12:09.650 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-20.19:12:09.650 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-20.19:12:09.650 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-20.19:12:09.660 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Setting offset for partition send-rebate-topic-0 to the committed offset FetchPosition{offset=12, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.19:12:09.660 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.19:12:09.660 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=87, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.19:12:09.660 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-20.19:12:09.660 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-20.19:12:09.660 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-20.19:12:31.057 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:12:52.551 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=45s570ms).
24-06-20.19:12:52.551 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=45s547ms).
24-06-20.19:12:52.582 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.19:12:52.602 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.19:12:52.721 [http-nio-8091-exec-2] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":108,"awardTitle":"暴走玩偶"},{"awardId":102,"awardTitle":"OpenAI会员卡"}],"ruleWeightCount":500,"userUsedCount":0},{"awardList":[{"awardId":108,"awardTitle":"暴走玩偶"},{"awardId":102,"awardTitle":"OpenAI会员卡"}],"ruleWeightCount":50,"userUsedCount":0}]
24-06-20.19:13:21.273 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:13:21.414 [http-nio-8091-exec-3] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":108,"awardTitle":"暴走玩偶"},{"awardId":102,"awardTitle":"OpenAI会员卡"}],"ruleWeightCount":500,"userUsedCount":0},{"awardList":[{"awardId":108,"awardTitle":"暴走玩偶"},{"awardId":102,"awardTitle":"OpenAI会员卡"}],"ruleWeightCount":50,"userUsedCount":0}]
24-06-20.19:13:25.708 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:13:25.743 [http-nio-8091-exec-5] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":108,"awardTitle":"暴走玩偶"},{"awardId":102,"awardTitle":"OpenAI会员卡"}],"ruleWeightCount":500,"userUsedCount":0},{"awardList":[{"awardId":108,"awardTitle":"暴走玩偶"},{"awardId":102,"awardTitle":"OpenAI会员卡"}],"ruleWeightCount":50,"userUsedCount":0}]
24-06-20.19:13:50.467 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Revoke previously assigned partitions sku-clear-topic-0
24-06-20.19:13:50.467 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Revoke previously assigned partitions sku-deduct-topic-0
24-06-20.19:13:50.467 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Revoke previously assigned partitions send-rebate-topic-0
24-06-20.19:13:50.468 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-20.19:13:50.468 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-20.19:13:50.468 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-20.19:13:50.468 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-051d8300-75bd-49b1-9ea1-11a06914951e sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.19:13:50.468 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-760ab965-543a-4023-a047-d2db1066bedf sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.19:13:50.468 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-3e9b5903-fa41-4d70-921b-c9197f5e580d sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.19:13:50.470 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.19:13:50.470 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.19:13:50.470 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.19:13:50.470 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.19:13:50.470 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.19:13:50.470 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.19:13:50.470 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.19:13:50.470 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.19:13:50.470 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.19:13:50.471 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.19:13:50.471 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.19:13:50.472 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.19:13:50.472 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.19:13:50.472 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.19:13:50.472 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.19:13:50.487 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.19:13:50.487 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.19:13:50.488 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.19:13:50.488 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.19:13:50.488 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.19:13:50.488 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.19:13:50.488 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.19:13:50.488 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.19:13:50.488 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.19:13:50.493 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-20.19:13:50.493 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-20.19:13:50.493 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-20.19:13:50.493 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-20.19:13:50.493 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-20.19:13:50.493 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-20.19:14:09.509 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 20869 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-20.19:14:09.511 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-20.19:14:10.039 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-20.19:14:10.040 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-20.19:14:10.058 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 11 ms. Found 0 Redis repository interfaces.
24-06-20.19:14:10.457 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-20.19:14:10.460 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-20.19:14:10.461 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-20.19:14:10.461 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-20.19:14:10.499 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-20.19:14:10.499 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 967 ms
24-06-20.19:14:10.874 [main            ] INFO  Version                - Redisson 3.26.0
24-06-20.19:14:10.893 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-20.19:14:10.973 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.19:14:10.983 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.19:14:11.558 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-20.19:14:11.701 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.19:14:11.736 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.19:14:11.736 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.19:14:11.736 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718882051735
24-06-20.19:14:11.744 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-20.19:14:11.750 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.19:14:11.754 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.19:14:11.754 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.19:14:11.754 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718882051754
24-06-20.19:14:11.757 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-20.19:14:11.758 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.19:14:11.761 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.19:14:11.761 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.19:14:11.761 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718882051761
24-06-20.19:14:11.763 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-20.19:14:11.764 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
24-06-20.19:14:11.770 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-20.19:14:11.780 [main            ] INFO  Application            - Started Application in 2.507 seconds (JVM running for 2.805)
24-06-20.19:14:11.927 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-20.19:14:11.927 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-20.19:14:11.927 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-20.19:14:11.928 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.19:14:11.928 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.19:14:11.928 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.19:14:11.929 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.19:14:11.929 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.19:14:11.929 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.19:14:11.932 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.19:14:11.932 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.19:14:11.932 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.19:14:11.944 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-20.19:14:11.944 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-20.19:14:11.944 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-20.19:14:11.944 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.19:14:11.944 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.19:14:11.944 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.19:14:12.231 [RMI TCP Connection(3)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
24-06-20.19:14:12.231 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
24-06-20.19:14:12.232 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.19:14:12.232 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 1 ms
24-06-20.19:14:12.446 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.19:14:12.460 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.19:14:12.491 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.19:14:14.957 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=61, memberId='consumer-send-rebate-group-1-be4bcb32-179d-4f19-8663-fa4637436042', protocol='range'}
24-06-20.19:14:14.958 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=313, memberId='consumer-sku-deduct-group-2-02bb18c3-c9e7-4d46-ac7d-7ca82e835bfb', protocol='range'}
24-06-20.19:14:14.958 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=315, memberId='consumer-sku-clear-group-3-f5379fd8-ae27-4bb9-aa49-3cfa70bf5545', protocol='range'}
24-06-20.19:14:14.966 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 313: {consumer-sku-deduct-group-2-02bb18c3-c9e7-4d46-ac7d-7ca82e835bfb=Assignment(partitions=[sku-deduct-topic-0])}
24-06-20.19:14:14.966 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 315: {consumer-sku-clear-group-3-f5379fd8-ae27-4bb9-aa49-3cfa70bf5545=Assignment(partitions=[sku-clear-topic-0])}
24-06-20.19:14:14.966 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 61: {consumer-send-rebate-group-1-be4bcb32-179d-4f19-8663-fa4637436042=Assignment(partitions=[send-rebate-topic-0])}
24-06-20.19:14:14.992 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=315, memberId='consumer-sku-clear-group-3-f5379fd8-ae27-4bb9-aa49-3cfa70bf5545', protocol='range'}
24-06-20.19:14:14.992 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=61, memberId='consumer-send-rebate-group-1-be4bcb32-179d-4f19-8663-fa4637436042', protocol='range'}
24-06-20.19:14:14.992 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=313, memberId='consumer-sku-deduct-group-2-02bb18c3-c9e7-4d46-ac7d-7ca82e835bfb', protocol='range'}
24-06-20.19:14:14.992 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-20.19:14:14.992 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-20.19:14:14.992 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-20.19:14:14.996 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-20.19:14:14.996 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-20.19:14:14.996 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-20.19:14:15.008 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.19:14:15.008 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Setting offset for partition send-rebate-topic-0 to the committed offset FetchPosition{offset=12, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.19:14:15.008 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=87, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.19:14:15.008 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-20.19:14:15.008 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-20.19:14:15.008 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-20.19:14:21.010 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:14:21.137 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.19:14:21.158 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.19:16:37.033 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=2m45s873ms).
24-06-20.19:16:37.033 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=2m24s433ms).
24-06-20.19:16:37.036 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.19:16:37.036 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.19:16:37.033 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=2m24s480ms).
24-06-20.19:16:37.035 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.19:16:37.038 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.19:16:37.038 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.19:16:37.040 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.19:16:37.052 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Client requested disconnect from node 2147483646
24-06-20.19:16:37.052 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Client requested disconnect from node 2147483646
24-06-20.19:16:37.052 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Client requested disconnect from node 2147483646
24-06-20.19:16:37.071 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.19:16:37.072 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.19:16:37.071 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.19:16:37.075 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.19:16:37.075 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.19:16:37.075 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.19:16:37.075 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.19:16:37.075 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.19:16:37.075 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.19:16:37.075 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.19:16:37.075 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.19:16:37.075 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.19:22:43.011 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=5m34s265ms).
24-06-20.19:22:43.011 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=5m34s265ms).
24-06-20.19:22:43.013 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=5m34s265ms).
24-06-20.19:22:43.019 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Disconnecting from node 1 due to request timeout.
24-06-20.19:22:43.019 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Disconnecting from node 1 due to request timeout.
24-06-20.19:22:43.019 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Disconnecting from node 1 due to request timeout.
24-06-20.19:22:43.035 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cancelled in-flight FIND_COORDINATOR request with correlation id 27 due to node 1 being disconnected (elapsed time since creation: 334253ms, elapsed time since send: 334253ms, request timeout: 30000ms)
24-06-20.19:22:43.035 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cancelled in-flight FIND_COORDINATOR request with correlation id 27 due to node 1 being disconnected (elapsed time since creation: 334253ms, elapsed time since send: 334253ms, request timeout: 30000ms)
24-06-20.19:22:43.035 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cancelled in-flight FIND_COORDINATOR request with correlation id 28 due to node 1 being disconnected (elapsed time since creation: 334253ms, elapsed time since send: 334253ms, request timeout: 30000ms)
24-06-20.19:22:43.035 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cancelled in-flight FIND_COORDINATOR request with correlation id 28 due to node 1 being disconnected (elapsed time since creation: 334251ms, elapsed time since send: 334251ms, request timeout: 30000ms)
24-06-20.19:22:43.036 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cancelled in-flight FIND_COORDINATOR request with correlation id 27 due to node 1 being disconnected (elapsed time since creation: 334254ms, elapsed time since send: 334254ms, request timeout: 30000ms)
24-06-20.19:22:43.036 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cancelled in-flight FIND_COORDINATOR request with correlation id 28 due to node 1 being disconnected (elapsed time since creation: 334253ms, elapsed time since send: 334253ms, request timeout: 30000ms)
24-06-20.19:31:27.870 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Node -1 disconnected.
24-06-20.19:31:27.856 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=8m44s845ms).
24-06-20.19:31:27.856 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=8m44s846ms).
24-06-20.19:31:27.869 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Node -1 disconnected.
24-06-20.19:31:27.868 [RMI TCP Accept-0] WARN  tcp                    - RMI TCP Accept-0: accept loop for ServerSocket[addr=0.0.0.0/0.0.0.0,localport=63268] throws
java.io.IOException: The server sockets created using the LocalRMIServerSocketFactory only accept connections from clients running on the host where the RMI remote objects have been exported.
	at sun.management.jmxremote.LocalRMIServerSocketFactory$1.accept(LocalRMIServerSocketFactory.java:114)
	at sun.rmi.transport.tcp.TCPTransport$AcceptLoop.executeAcceptLoop(TCPTransport.java:405)
	at sun.rmi.transport.tcp.TCPTransport$AcceptLoop.run(TCPTransport.java:377)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.19:31:27.858 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=8m44s845ms).
24-06-20.19:31:27.876 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  FetchSessionHandler    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Error sending fetch request (sessionId=1556358742, epoch=14) to node 1:
org.apache.kafka.common.errors.DisconnectException: null
24-06-20.19:31:27.877 [RMI TCP Accept-0] WARN  tcp                    - RMI TCP Accept-0: accept loop for ServerSocket[addr=0.0.0.0/0.0.0.0,localport=63268] throws
java.io.IOException: The server sockets created using the LocalRMIServerSocketFactory only accept connections from clients running on the host where the RMI remote objects have been exported.
	at sun.management.jmxremote.LocalRMIServerSocketFactory$1.accept(LocalRMIServerSocketFactory.java:114)
	at sun.rmi.transport.tcp.TCPTransport$AcceptLoop.executeAcceptLoop(TCPTransport.java:405)
	at sun.rmi.transport.tcp.TCPTransport$AcceptLoop.run(TCPTransport.java:377)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.19:31:27.879 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Node -1 disconnected.
24-06-20.19:31:27.880 [RMI TCP Accept-0] WARN  tcp                    - RMI TCP Accept-0: accept loop for ServerSocket[addr=0.0.0.0/0.0.0.0,localport=63268] throws
java.io.IOException: The server sockets created using the LocalRMIServerSocketFactory only accept connections from clients running on the host where the RMI remote objects have been exported.
	at sun.management.jmxremote.LocalRMIServerSocketFactory$1.accept(LocalRMIServerSocketFactory.java:114)
	at sun.rmi.transport.tcp.TCPTransport$AcceptLoop.executeAcceptLoop(TCPTransport.java:405)
	at sun.rmi.transport.tcp.TCPTransport$AcceptLoop.run(TCPTransport.java:377)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.19:31:27.881 [RMI TCP Accept-0] WARN  tcp                    - RMI TCP Accept-0: accept loop for ServerSocket[addr=0.0.0.0/0.0.0.0,localport=63268] throws
java.io.IOException: The server sockets created using the LocalRMIServerSocketFactory only accept connections from clients running on the host where the RMI remote objects have been exported.
	at sun.management.jmxremote.LocalRMIServerSocketFactory$1.accept(LocalRMIServerSocketFactory.java:114)
	at sun.rmi.transport.tcp.TCPTransport$AcceptLoop.executeAcceptLoop(TCPTransport.java:405)
	at sun.rmi.transport.tcp.TCPTransport$AcceptLoop.run(TCPTransport.java:377)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.19:31:27.882 [RMI TCP Accept-0] WARN  tcp                    - RMI TCP Accept-0: accept loop for ServerSocket[addr=0.0.0.0/0.0.0.0,localport=63268] throws
java.io.IOException: The server sockets created using the LocalRMIServerSocketFactory only accept connections from clients running on the host where the RMI remote objects have been exported.
	at sun.management.jmxremote.LocalRMIServerSocketFactory$1.accept(LocalRMIServerSocketFactory.java:114)
	at sun.rmi.transport.tcp.TCPTransport$AcceptLoop.executeAcceptLoop(TCPTransport.java:405)
	at sun.rmi.transport.tcp.TCPTransport$AcceptLoop.run(TCPTransport.java:377)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.19:31:27.882 [RMI TCP Accept-0] WARN  tcp                    - RMI TCP Accept-0: accept loop for ServerSocket[addr=0.0.0.0/0.0.0.0,localport=63268] throws
java.io.IOException: The server sockets created using the LocalRMIServerSocketFactory only accept connections from clients running on the host where the RMI remote objects have been exported.
	at sun.management.jmxremote.LocalRMIServerSocketFactory$1.accept(LocalRMIServerSocketFactory.java:114)
	at sun.rmi.transport.tcp.TCPTransport$AcceptLoop.executeAcceptLoop(TCPTransport.java:405)
	at sun.rmi.transport.tcp.TCPTransport$AcceptLoop.run(TCPTransport.java:377)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.19:31:27.887 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.19:31:27.889 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.19:31:27.892 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Attempt to heartbeat with Generation{generationId=315, memberId='consumer-sku-clear-group-3-f5379fd8-ae27-4bb9-aa49-3cfa70bf5545', protocol='range'} and group instance id Optional.empty failed due to UNKNOWN_MEMBER_ID, resetting generation
24-06-20.19:31:27.893 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: encountered UNKNOWN_MEMBER_ID from HEARTBEAT response
24-06-20.19:31:27.893 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: encountered UNKNOWN_MEMBER_ID from HEARTBEAT response
24-06-20.19:31:27.893 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Giving away all assigned partitions as lost since generation has been reset,indicating that consumer is no longer part of the group
24-06-20.19:31:27.893 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Lost previously assigned partitions sku-clear-topic-0
24-06-20.19:31:27.893 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions lost: [sku-clear-topic-0]
24-06-20.19:31:27.894 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-20.19:31:27.894 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.19:31:27.899 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-20.19:31:27.899 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.19:31:27.976 [http-nio-8091-exec-2] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":108,"awardTitle":"暴走玩偶"},{"awardId":102,"awardTitle":"OpenAI会员卡"}],"ruleWeightCount":500,"userUsedCount":0},{"awardList":[{"awardId":108,"awardTitle":"暴走玩偶"},{"awardId":102,"awardTitle":"OpenAI会员卡"}],"ruleWeightCount":50,"userUsedCount":0}]
24-06-20.19:31:28.391 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.19:31:28.391 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.19:31:28.392 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.19:31:28.403 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Attempt to heartbeat with Generation{generationId=61, memberId='consumer-send-rebate-group-1-be4bcb32-179d-4f19-8663-fa4637436042', protocol='range'} and group instance id Optional.empty failed due to UNKNOWN_MEMBER_ID, resetting generation
24-06-20.19:31:28.403 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: encountered UNKNOWN_MEMBER_ID from HEARTBEAT response
24-06-20.19:31:28.403 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: encountered UNKNOWN_MEMBER_ID from HEARTBEAT response
24-06-20.19:31:28.403 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Giving away all assigned partitions as lost since generation has been reset,indicating that consumer is no longer part of the group
24-06-20.19:31:28.403 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Lost previously assigned partitions send-rebate-topic-0
24-06-20.19:31:28.403 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions lost: [send-rebate-topic-0]
24-06-20.19:31:28.403 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-20.19:31:28.403 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.19:31:28.405 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Attempt to heartbeat with Generation{generationId=313, memberId='consumer-sku-deduct-group-2-02bb18c3-c9e7-4d46-ac7d-7ca82e835bfb', protocol='range'} and group instance id Optional.empty failed due to UNKNOWN_MEMBER_ID, resetting generation
24-06-20.19:31:28.406 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: encountered UNKNOWN_MEMBER_ID from HEARTBEAT response
24-06-20.19:31:28.406 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: encountered UNKNOWN_MEMBER_ID from HEARTBEAT response
24-06-20.19:31:28.406 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Giving away all assigned partitions as lost since generation has been reset,indicating that consumer is no longer part of the group
24-06-20.19:31:28.406 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Lost previously assigned partitions sku-deduct-topic-0
24-06-20.19:31:28.406 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions lost: [sku-deduct-topic-0]
24-06-20.19:31:28.406 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-20.19:31:28.406 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.19:31:28.407 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-20.19:31:28.407 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.19:31:28.408 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-20.19:31:28.408 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.19:31:28.948 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-5e443bf1-4793-4531-9dec-b16aa069b673 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.19:31:28.948 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-e917197d-9801-4837-9063-43164c6e2b71 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.19:31:28.948 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-da79f86c-07ed-4b6a-a80a-8742a8aebabe sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.19:31:28.952 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.19:31:28.952 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.19:31:28.952 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.19:31:28.952 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.19:31:28.952 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.19:31:28.952 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.19:31:28.952 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.19:31:28.953 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.19:31:28.953 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.19:31:28.955 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.19:31:28.955 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.19:31:28.956 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.19:31:28.956 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.19:31:28.957 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.19:31:28.957 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.19:31:30.924 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.19:31:30.924 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.19:31:30.924 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.19:31:30.930 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-20.19:31:30.931 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-20.19:31:31.413 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.19:31:31.414 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.19:31:31.414 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.19:31:31.414 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.19:31:31.414 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.19:31:31.414 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.19:31:31.418 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-20.19:31:31.418 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-20.19:31:31.418 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-20.19:31:31.418 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-20.19:31:35.986 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 23398 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-20.19:31:35.988 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-20.19:31:36.641 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-20.19:31:36.643 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-20.19:31:36.671 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 16 ms. Found 0 Redis repository interfaces.
24-06-20.19:31:37.138 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-20.19:31:37.143 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-20.19:31:37.143 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-20.19:31:37.143 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-20.19:31:37.183 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-20.19:31:37.184 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1169 ms
24-06-20.19:31:37.674 [main            ] INFO  Version                - Redisson 3.26.0
24-06-20.19:31:37.714 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-20.19:31:37.850 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.19:31:37.860 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.19:31:38.532 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-20.19:31:38.657 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.19:31:38.692 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.19:31:38.692 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.19:31:38.692 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718883098691
24-06-20.19:31:38.700 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-20.19:31:38.707 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.19:31:38.710 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.19:31:38.710 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.19:31:38.711 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718883098710
24-06-20.19:31:38.713 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-20.19:31:38.714 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.19:31:38.717 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.19:31:38.718 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.19:31:38.718 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718883098717
24-06-20.19:31:38.720 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-20.19:31:38.720 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
24-06-20.19:31:38.727 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-20.19:31:38.736 [main            ] INFO  Application            - Started Application in 3.184 seconds (JVM running for 3.613)
24-06-20.19:31:38.940 [RMI TCP Connection(2)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
24-06-20.19:31:38.940 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
24-06-20.19:31:38.942 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 2 ms
24-06-20.19:31:38.947 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.19:31:39.084 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-20.19:31:39.084 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-20.19:31:39.085 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.19:31:39.085 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.19:31:39.087 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.19:31:39.087 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.19:31:39.093 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.19:31:39.094 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.19:31:39.095 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-20.19:31:39.095 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.19:31:39.096 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.19:31:39.106 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.19:31:39.113 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-20.19:31:39.113 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-20.19:31:39.113 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-20.19:31:39.113 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.19:31:39.114 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.19:31:39.114 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.19:31:39.396 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.19:31:39.425 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.19:31:39.451 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.19:31:42.136 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=65, memberId='consumer-send-rebate-group-1-a7ee6ded-e527-4a80-a3c4-df7963cd34a1', protocol='range'}
24-06-20.19:31:42.136 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=317, memberId='consumer-sku-deduct-group-2-91366196-fb71-49e0-a68a-2b0457441977', protocol='range'}
24-06-20.19:31:42.136 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=319, memberId='consumer-sku-clear-group-3-51c8d74c-a674-4c34-84c3-9ee93c08c7ec', protocol='range'}
24-06-20.19:31:42.146 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 65: {consumer-send-rebate-group-1-a7ee6ded-e527-4a80-a3c4-df7963cd34a1=Assignment(partitions=[send-rebate-topic-0])}
24-06-20.19:31:42.146 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 317: {consumer-sku-deduct-group-2-91366196-fb71-49e0-a68a-2b0457441977=Assignment(partitions=[sku-deduct-topic-0])}
24-06-20.19:31:42.146 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 319: {consumer-sku-clear-group-3-51c8d74c-a674-4c34-84c3-9ee93c08c7ec=Assignment(partitions=[sku-clear-topic-0])}
24-06-20.19:31:42.204 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=319, memberId='consumer-sku-clear-group-3-51c8d74c-a674-4c34-84c3-9ee93c08c7ec', protocol='range'}
24-06-20.19:31:42.204 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=65, memberId='consumer-send-rebate-group-1-a7ee6ded-e527-4a80-a3c4-df7963cd34a1', protocol='range'}
24-06-20.19:31:42.204 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=317, memberId='consumer-sku-deduct-group-2-91366196-fb71-49e0-a68a-2b0457441977', protocol='range'}
24-06-20.19:31:42.205 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-20.19:31:42.205 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-20.19:31:42.205 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-20.19:31:42.212 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-20.19:31:42.212 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-20.19:31:42.212 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-20.19:31:42.224 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=87, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.19:31:42.224 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.19:31:42.224 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Setting offset for partition send-rebate-topic-0 to the committed offset FetchPosition{offset=12, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.19:31:42.225 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-20.19:31:42.225 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-20.19:31:42.225 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-20.19:31:50.470 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:31:50.512 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.19:31:50.531 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.19:32:16.782 [http-nio-8091-exec-2] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":0},{"awardList":[{"awardId":102,"awardTitle":"OpenAI会员卡"}],"ruleWeightCount":50,"userUsedCount":0}]
24-06-20.19:33:03.435 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:33:06.740 [http-nio-8091-exec-3] INFO  RaffleActivityController - 规则权重查询失败，userId:matthew activityId:100001
java.lang.IllegalArgumentException: rule_weight rule_weight value invaild input format[Ljava.lang.String;@3d46496e
	at cn.matthew.domain.strategy.model.entity.StrategyRuleEntity.getRuleValues(StrategyRuleEntity.java:46)
	at cn.matthew.infrastructure.persistent.repository.StrategyRepository.queryRaffleRuleWeightByStrategyId(StrategyRepository.java:334)
	at cn.matthew.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$48135f4a.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$c5a41b83.queryRaffleRuleWeightByStrategyId(<generated>)
	at cn.matthew.domain.strategy.service.raffle.DefaultRaffleStrategy.queryRaffleRuleWeightByStrategyId(DefaultRaffleStrategy.java:79)
	at cn.matthew.domain.strategy.service.raffle.DefaultRaffleStrategy.queryRaffleRuleWeightByActivityId(DefaultRaffleStrategy.java:75)
	at cn.matthew.trigger.http.RaffleActivityController.queryRaffleRuleWeight(RaffleActivityController.java:340)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.19:34:33.832 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:34:35.689 [http-nio-8091-exec-6] INFO  RaffleActivityController - 规则权重查询失败，userId:matthew activityId:100001
java.lang.IllegalArgumentException: rule_weight rule_weight value invaild input format[Ljava.lang.String;@6cce6945
	at cn.matthew.domain.strategy.model.entity.StrategyRuleEntity.getRuleValues(StrategyRuleEntity.java:46)
	at cn.matthew.infrastructure.persistent.repository.StrategyRepository.queryRaffleRuleWeightByStrategyId(StrategyRepository.java:334)
	at cn.matthew.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$48135f4a.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$c5a41b83.queryRaffleRuleWeightByStrategyId(<generated>)
	at cn.matthew.domain.strategy.service.raffle.DefaultRaffleStrategy.queryRaffleRuleWeightByStrategyId(DefaultRaffleStrategy.java:79)
	at cn.matthew.domain.strategy.service.raffle.DefaultRaffleStrategy.queryRaffleRuleWeightByActivityId(DefaultRaffleStrategy.java:75)
	at cn.matthew.trigger.http.RaffleActivityController.queryRaffleRuleWeight(RaffleActivityController.java:340)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.19:34:45.316 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:34:51.348 [http-nio-8091-exec-7] INFO  RaffleActivityController - 规则权重查询失败，userId:matthew activityId:100001
java.lang.IllegalArgumentException: rule_weight rule_weight value invaild input format[Ljava.lang.String;@da64aef
	at cn.matthew.domain.strategy.model.entity.StrategyRuleEntity.getRuleValues(StrategyRuleEntity.java:46)
	at cn.matthew.infrastructure.persistent.repository.StrategyRepository.queryRaffleRuleWeightByStrategyId(StrategyRepository.java:334)
	at cn.matthew.infrastructure.persistent.repository.StrategyRepository$$FastClassBySpringCGLIB$$48135f4a.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.StrategyRepository$$EnhancerBySpringCGLIB$$c5a41b83.queryRaffleRuleWeightByStrategyId(<generated>)
	at cn.matthew.domain.strategy.service.raffle.DefaultRaffleStrategy.queryRaffleRuleWeightByStrategyId(DefaultRaffleStrategy.java:79)
	at cn.matthew.domain.strategy.service.raffle.DefaultRaffleStrategy.queryRaffleRuleWeightByActivityId(DefaultRaffleStrategy.java:75)
	at cn.matthew.trigger.http.RaffleActivityController.queryRaffleRuleWeight(RaffleActivityController.java:340)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.19:36:05.372 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:36:07.655 [http-nio-8091-exec-10] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":0},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":0}]
24-06-20.19:36:21.396 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Revoke previously assigned partitions send-rebate-topic-0
24-06-20.19:36:21.396 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Revoke previously assigned partitions sku-deduct-topic-0
24-06-20.19:36:21.396 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Revoke previously assigned partitions sku-clear-topic-0
24-06-20.19:36:21.396 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-20.19:36:21.396 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-20.19:36:21.396 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-20.19:36:21.396 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-91366196-fb71-49e0-a68a-2b0457441977 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.19:36:21.397 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-51c8d74c-a674-4c34-84c3-9ee93c08c7ec sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.19:36:21.397 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-a7ee6ded-e527-4a80-a3c4-df7963cd34a1 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.19:36:21.398 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.19:36:21.398 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.19:36:21.398 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.19:36:21.398 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.19:36:21.398 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.19:36:21.398 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.19:36:21.398 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.19:36:21.399 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.19:36:21.399 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.19:36:21.400 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.19:36:21.401 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.19:36:21.401 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.19:36:21.401 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.19:36:21.401 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.19:36:21.401 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.19:36:21.423 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.19:36:21.423 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.19:36:21.423 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.19:36:21.423 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.19:36:21.423 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.19:36:21.423 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.19:36:21.423 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.19:36:21.423 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.19:36:21.423 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.19:36:21.429 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-20.19:36:21.430 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-20.19:36:21.430 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-20.19:36:21.430 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-20.19:36:21.430 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-20.19:36:21.430 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-20.19:36:23.300 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 24116 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-20.19:36:23.301 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-20.19:36:23.783 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-20.19:36:23.784 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-20.19:36:23.801 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 10 ms. Found 0 Redis repository interfaces.
24-06-20.19:36:24.163 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-20.19:36:24.166 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-20.19:36:24.167 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-20.19:36:24.167 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-20.19:36:24.208 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-20.19:36:24.208 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 885 ms
24-06-20.19:36:24.541 [main            ] INFO  Version                - Redisson 3.26.0
24-06-20.19:36:24.554 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-20.19:36:24.618 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.19:36:24.628 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.19:36:25.132 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-20.19:36:25.258 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.19:36:25.289 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.19:36:25.289 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.19:36:25.289 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718883385288
24-06-20.19:36:25.296 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-20.19:36:25.302 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.19:36:25.305 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.19:36:25.305 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.19:36:25.305 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718883385305
24-06-20.19:36:25.308 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-20.19:36:25.309 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.19:36:25.312 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.19:36:25.312 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.19:36:25.312 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718883385312
24-06-20.19:36:25.314 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-20.19:36:25.314 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
24-06-20.19:36:25.319 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-20.19:36:25.328 [main            ] INFO  Application            - Started Application in 2.262 seconds (JVM running for 2.641)
24-06-20.19:36:25.420 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.19:36:25.420 [RMI TCP Connection(3)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
24-06-20.19:36:25.421 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
24-06-20.19:36:25.423 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 2 ms
24-06-20.19:36:25.511 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-20.19:36:25.511 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-20.19:36:25.511 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-20.19:36:25.512 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.19:36:25.512 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.19:36:25.512 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.19:36:25.513 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.19:36:25.513 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.19:36:25.513 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.19:36:25.516 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.19:36:25.516 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.19:36:25.516 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.19:36:25.531 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-20.19:36:25.531 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-20.19:36:25.531 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-20.19:36:25.531 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.19:36:25.531 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.19:36:25.531 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.19:36:25.611 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.19:36:25.623 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.19:36:25.644 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.19:36:28.634 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=67, memberId='consumer-send-rebate-group-1-0b734a4c-86b5-4272-9f45-a233f65483c4', protocol='range'}
24-06-20.19:36:28.634 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=321, memberId='consumer-sku-clear-group-3-e6b1bfc2-ac0b-442a-a536-540dae6b818f', protocol='range'}
24-06-20.19:36:28.635 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=319, memberId='consumer-sku-deduct-group-2-e3b13aed-56b3-49bb-9d16-282141fb014d', protocol='range'}
24-06-20.19:36:28.637 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 321: {consumer-sku-clear-group-3-e6b1bfc2-ac0b-442a-a536-540dae6b818f=Assignment(partitions=[sku-clear-topic-0])}
24-06-20.19:36:28.637 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 319: {consumer-sku-deduct-group-2-e3b13aed-56b3-49bb-9d16-282141fb014d=Assignment(partitions=[sku-deduct-topic-0])}
24-06-20.19:36:28.638 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 67: {consumer-send-rebate-group-1-0b734a4c-86b5-4272-9f45-a233f65483c4=Assignment(partitions=[send-rebate-topic-0])}
24-06-20.19:36:28.660 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=67, memberId='consumer-send-rebate-group-1-0b734a4c-86b5-4272-9f45-a233f65483c4', protocol='range'}
24-06-20.19:36:28.660 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=321, memberId='consumer-sku-clear-group-3-e6b1bfc2-ac0b-442a-a536-540dae6b818f', protocol='range'}
24-06-20.19:36:28.660 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=319, memberId='consumer-sku-deduct-group-2-e3b13aed-56b3-49bb-9d16-282141fb014d', protocol='range'}
24-06-20.19:36:28.661 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-20.19:36:28.661 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-20.19:36:28.661 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-20.19:36:28.664 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-20.19:36:28.664 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-20.19:36:28.664 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-20.19:36:28.683 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=87, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.19:36:28.683 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Setting offset for partition send-rebate-topic-0 to the committed offset FetchPosition{offset=12, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.19:36:28.683 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.19:36:28.684 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-20.19:36:28.684 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-20.19:36:28.684 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-20.19:36:29.026 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:36:29.026 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:36:29.035 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:36:29.035 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:36:29.035 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:36:29.035 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:36:29.058 [http-nio-8091-exec-8] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.19:36:29.077 [http-nio-8091-exec-5] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:36:29.077 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:36:29.082 [http-nio-8091-exec-8] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.19:36:29.157 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":10000,"monthCount":100004,"monthCountSurplus":97699,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:36:29.157 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":10000,"monthCount":100004,"monthCountSurplus":97699,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:36:29.161 [http-nio-8091-exec-8] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":false,"sort":5,"waitUnLockCount":3},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":false,"sort":6,"waitUnLockCount":2},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":false,"sort":7,"waitUnLockCount":1},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:36:29.161 [http-nio-8091-exec-7] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":false,"sort":5,"waitUnLockCount":3},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":false,"sort":6,"waitUnLockCount":2},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":false,"sort":7,"waitUnLockCount":1},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:37:13.785 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:37:13.785 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:37:13.801 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:37:13.802 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:37:13.823 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:37:13.823 [http-nio-8091-exec-9] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:37:13.827 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":false,"sort":5,"waitUnLockCount":3},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":false,"sort":6,"waitUnLockCount":2},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":false,"sort":7,"waitUnLockCount":1},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:37:13.828 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":false,"sort":5,"waitUnLockCount":3},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":false,"sort":6,"waitUnLockCount":2},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":false,"sort":7,"waitUnLockCount":1},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:37:13.828 [http-nio-8091-exec-9] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:37:13.830 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:37:13.832 [http-nio-8091-exec-7] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":10000,"monthCount":100004,"monthCountSurplus":97699,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:37:13.837 [http-nio-8091-exec-8] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":10000,"monthCount":100004,"monthCountSurplus":97699,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:37:13.838 [http-nio-8091-exec-1] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:37:13.838 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:37:13.861 [http-nio-8091-exec-10] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":0},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":0}]
24-06-20.19:37:13.861 [http-nio-8091-exec-1] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":0},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":0}]
24-06-20.19:37:22.781 [http-nio-8091-exec-8] INFO  RaffleActivityController - 活动抽奖 userId:matthew activityId:100001
24-06-20.19:37:22.842 [http-nio-8091-exec-8] INFO  RaffleActivityPartakeServiceService - orderId是：1253433536799571968
24-06-20.19:37:22.896 [http-nio-8091-exec-8] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:matthew activityId:100001 orderId:1253433536799571968
24-06-20.19:37:22.905 [http-nio-8091-exec-8] ERROR RaffleActivityController - 活动抽奖失败 userId:matthew activityId:100001
java.lang.NullPointerException: null
	at cn.matthew.domain.strategy.service.assemble.RaffleAward.getAwardId(RaffleAward.java:23)
	at cn.matthew.domain.strategy.service.rule.chain.impl.DefaultChainFilter.logic(DefaultChainFilter.java:26)
	at cn.matthew.domain.strategy.service.raffle.DefaultRaffleStrategy.raffleLogicChain(DefaultRaffleStrategy.java:42)
	at cn.matthew.domain.strategy.service.raffle.AbstractRaffleStrategy.performRaffle(AbstractRaffleStrategy.java:48)
	at cn.matthew.trigger.http.RaffleActivityController.draw(RaffleActivityController.java:133)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.19:40:24.763 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:40:24.798 [http-nio-8091-exec-10] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":false,"sort":5,"waitUnLockCount":2},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":false,"sort":6,"waitUnLockCount":1},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:45:02.388 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:45:02.388 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:45:02.406 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:45:02.406 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:45:02.409 [http-nio-8091-exec-1] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:45:02.409 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:45:02.420 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:45:02.420 [http-nio-8091-exec-5] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:45:02.428 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:45:02.430 [http-nio-8091-exec-9] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:45:02.450 [http-nio-8091-exec-9] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9999,"monthCount":100004,"monthCountSurplus":97698,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:45:02.452 [http-nio-8091-exec-1] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":1},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":1}]
24-06-20.19:45:02.454 [http-nio-8091-exec-10] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9999,"monthCount":100004,"monthCountSurplus":97698,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:45:02.455 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":false,"sort":5,"waitUnLockCount":2},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":false,"sort":6,"waitUnLockCount":1},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:45:02.456 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":false,"sort":5,"waitUnLockCount":2},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":false,"sort":6,"waitUnLockCount":1},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:45:02.458 [http-nio-8091-exec-8] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":1},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":1}]
24-06-20.19:45:04.391 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:45:04.391 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:45:04.401 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:45:04.402 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:45:04.403 [http-nio-8091-exec-1] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:45:04.403 [http-nio-8091-exec-9] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:45:04.415 [http-nio-8091-exec-9] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:45:04.419 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:45:04.423 [http-nio-8091-exec-10] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:45:04.424 [http-nio-8091-exec-5] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9999,"monthCount":100004,"monthCountSurplus":97698,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:45:04.424 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9999,"monthCount":100004,"monthCountSurplus":97698,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:45:04.424 [http-nio-8091-exec-7] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":false,"sort":5,"waitUnLockCount":2},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":false,"sort":6,"waitUnLockCount":1},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:45:04.425 [http-nio-8091-exec-1] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":1},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":1}]
24-06-20.19:45:04.425 [http-nio-8091-exec-2] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":false,"sort":5,"waitUnLockCount":2},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":false,"sort":6,"waitUnLockCount":1},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:45:04.426 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:45:04.434 [http-nio-8091-exec-6] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":1},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":1}]
24-06-20.19:45:19.026 [http-nio-8091-exec-1] INFO  RaffleActivityController - 根据活动ID装配开始，活动ID为：100001
24-06-20.19:45:19.046 [http-nio-8091-exec-1] INFO  ActivityRepository     - 预热SKU缓存成功，SKU: 999 库存总量为: 1000000
24-06-20.19:45:19.096 [http-nio-8091-exec-1] INFO  RaffleActivityController - 根据活动ID装配完毕，活动ID为：100001
24-06-20.19:45:25.256 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动抽奖 userId:matthew activityId:100001
24-06-20.19:45:25.317 [http-nio-8091-exec-2] INFO  AbstractRaffleActivityPartakeService - 创建参与活动订单 userId:matthew activityId:100001 userRaffleOrderEntity:{"activityId":100001,"activityName":"测试活动","orderId":"1253433536799571968","orderState":"create","orderTime":1718883443000,"strategyId":100006,"userId":"matthew"}
24-06-20.19:45:25.317 [http-nio-8091-exec-2] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:matthew activityId:100001 orderId:1253433536799571968
24-06-20.19:45:25.328 [http-nio-8091-exec-2] INFO  DefaultChainFilter     - 抽奖责任链-默认处理 userId: matthew strategyId: 100006 ruleModel: rule_default awardId: 102
24-06-20.19:45:25.329 [http-nio-8091-exec-2] INFO  AbstractRaffleStrategy - 完成责任链流程: userId: matthew strategyId: 100006 awardId: 102 规则: rule_default
24-06-20.19:45:25.362 [http-nio-8091-exec-2] INFO  DecisionTreeEngine     - 进入决策树处理, userId:matthew, strategyId:100006, awardId:102
24-06-20.19:45:25.362 [http-nio-8091-exec-2] INFO  RuleStockTreeNode      - 规则过滤-库存节点, userId: matthew strategy: 100006 award: 102
24-06-20.19:45:25.363 [http-nio-8091-exec-2] INFO  RuleStockTreeNode      - 规则过滤-库存扣减-成功 userId:matthew strategyId:100006 awardId:102
24-06-20.19:45:25.392 [http-nio-8091-exec-2] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:RuleTreeNodeVO(treeId=tree_luck_award, ruleKey=rule_stock, ruleDesc=库存扣减规则, ruleValue=null, treeNodeLineVOList=[RuleTreeNodeLineVO(treeId=tree_luck_award, ruleNodeFrom=rule_stock, ruleNodeTo=rule_luck_award, ruleLimitType=EQUAL, ruleLimitValue=ALLOW)]) code:0001
24-06-20.19:45:25.392 [http-nio-8091-exec-2] INFO  AbstractRaffleStrategy - 完成规则树流程: userId: matthew strategyId: 100006 awardId: 102 规则: null
24-06-20.19:45:25.431 [http-nio-8091-exec-2] INFO  ProducerConfig         - Idempotence will be disabled because acks is set to 1, not set to 'all'.
24-06-20.19:45:25.432 [http-nio-8091-exec-2] INFO  ProducerConfig         - ProducerConfig values: 
	acks = 1
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-1
	compression.type = none
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = false
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.class = class org.apache.kafka.clients.producer.internals.DefaultPartitioner
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 1
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

24-06-20.19:45:25.445 [http-nio-8091-exec-2] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.19:45:25.445 [http-nio-8091-exec-2] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.19:45:25.445 [http-nio-8091-exec-2] INFO  AppInfoParser          - Kafka startTimeMs: 1718883925445
24-06-20.19:45:25.471 [kafka-producer-network-thread | producer-1] INFO  Metadata               - [Producer clientId=producer-1] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.19:45:25.480 [kafka-producer-network-thread | producer-1] INFO  Metadata               - [Producer clientId=producer-1] Resetting the last seen epoch of partition send-award-topic-0 to 0 since the associated topicId changed from null to 7B2TfuZETI-OeTtx5TJ86g
24-06-20.19:45:25.493 [http-nio-8091-exec-2] INFO  EventPublisher         - 发送MQ消息 topic:send-award-topic message:{"data":{"awardId":102,"awardTitle":"OpenAI会员卡","userId":"matthew"},"id":"02123044077","timestamp":1718883925399}
24-06-20.19:45:25.506 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:45:25.506 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:45:25.517 [http-nio-8091-exec-5] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":1},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":1}]
24-06-20.19:45:25.518 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9999,"monthCount":100004,"monthCountSurplus":97698,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:45:25.865 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Node -1 disconnected.
24-06-20.19:45:25.891 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Node -1 disconnected.
24-06-20.19:45:25.891 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Node -1 disconnected.
24-06-20.19:45:28.053 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:45:28.072 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":false,"sort":5,"waitUnLockCount":2},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":false,"sort":6,"waitUnLockCount":1},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:45:30.962 [http-nio-8091-exec-8] INFO  RaffleActivityController - 日历签到返利开始 userId:matthew
24-06-20.19:45:30.965 [http-nio-8091-exec-8] INFO  BehaviorRebateService  - 开始创建返利订单 userId:matthew 
24-06-20.19:45:31.052 [http-nio-8091-exec-8] ERROR RebateRepository       - 写入返利记录，唯一索引冲突 userId: matthew
org.springframework.dao.DuplicateKeyException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'matthew_sku_20240620' for key 'user_behavior_rebate_order_000.uq_biz_id'
### The error may exist in file [/Users/matthew/Desktop/lottery/lottery-app/target/classes/mybatis/mapper/UserBehaviorRebateOrderMapper.xml]
### The error may involve cn.matthew.infrastructure.persistent.dao.rebate.IUserBehaviorRebateOrderDao.insert-Inline
### The error occurred while setting parameters
### SQL: insert into user_behavior_rebate_order_000(         user_id, order_id, behavior_type, rebate_desc, rebate_type, rebate_config, out_business_no, biz_id, create_time, update_time         ) values(         ?, ?, ?, ?, ?, ?, ?, ?, now(), now()         )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'matthew_sku_20240620' for key 'user_behavior_rebate_order_000.uq_biz_id'
; Duplicate entry 'matthew_sku_20240620' for key 'user_behavior_rebate_order_000.uq_biz_id'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'matthew_sku_20240620' for key 'user_behavior_rebate_order_000.uq_biz_id'
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:247)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy104.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy136.insert(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:220)
	at com.sun.proxy.$Proxy137.insert(Unknown Source)
	at cn.matthew.infrastructure.persistent.repository.RebateRepository.lambda$saveRebateRecord$0(RebateRepository.java:85)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.matthew.infrastructure.persistent.repository.RebateRepository.saveRebateRecord(RebateRepository.java:70)
	at cn.matthew.infrastructure.persistent.repository.RebateRepository$$FastClassBySpringCGLIB$$eb2d2aba.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.RebateRepository$$EnhancerBySpringCGLIB$$cb42a7f7.saveRebateRecord(<generated>)
	at cn.matthew.domain.rebate.service.BehaviorRebateService.createOrder(BehaviorRebateService.java:93)
	at cn.matthew.trigger.http.RaffleActivityController.calendarSignRebate(RaffleActivityController.java:243)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'matthew_sku_20240620' for key 'user_behavior_rebate_order_000.uq_biz_id'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy180.update(Unknown Source)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 86 common frames omitted
24-06-20.19:45:31.059 [http-nio-8091-exec-8] ERROR RaffleActivityController - 日历签到返利异常 userId:matthew 
cn.matthew.types.exception.AppException: null
	at cn.matthew.infrastructure.persistent.repository.RebateRepository.lambda$saveRebateRecord$0(RebateRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.matthew.infrastructure.persistent.repository.RebateRepository.saveRebateRecord(RebateRepository.java:70)
	at cn.matthew.infrastructure.persistent.repository.RebateRepository$$FastClassBySpringCGLIB$$eb2d2aba.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.RebateRepository$$EnhancerBySpringCGLIB$$cb42a7f7.saveRebateRecord(<generated>)
	at cn.matthew.domain.rebate.service.BehaviorRebateService.createOrder(BehaviorRebateService.java:93)
	at cn.matthew.trigger.http.RaffleActivityController.calendarSignRebate(RaffleActivityController.java:243)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.19:45:31.217 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:45:31.217 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:45:31.224 [http-nio-8091-exec-10] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9999,"monthCount":100004,"monthCountSurplus":97698,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:45:31.224 [http-nio-8091-exec-7] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":1},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":1}]
24-06-20.19:45:42.586 [http-nio-8091-exec-5] INFO  RaffleActivityController - 活动抽奖 userId:matthew activityId:100001
24-06-20.19:45:42.640 [http-nio-8091-exec-5] INFO  RaffleActivityPartakeServiceService - orderId是：1253435633104322560
24-06-20.19:45:42.681 [http-nio-8091-exec-5] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:matthew activityId:100001 orderId:1253435633104322560
24-06-20.19:45:42.690 [http-nio-8091-exec-5] INFO  DefaultChainFilter     - 抽奖责任链-默认处理 userId: matthew strategyId: 100006 ruleModel: rule_default awardId: 106
24-06-20.19:45:42.690 [http-nio-8091-exec-5] INFO  AbstractRaffleStrategy - 完成责任链流程: userId: matthew strategyId: 100006 awardId: 106 规则: rule_default
24-06-20.19:45:42.707 [http-nio-8091-exec-5] INFO  DecisionTreeEngine     - 进入决策树处理, userId:matthew, strategyId:100006, awardId:106
24-06-20.19:45:42.708 [http-nio-8091-exec-5] INFO  RuleLockTreeNode       - 规则过滤-次数锁 userId:matthew strategyId:100006 awardId:106
24-06-20.19:45:42.713 [http-nio-8091-exec-5] INFO  RuleLockTreeNode       - 决策树-用户抽奖次数满足奖品要求-次数锁节点放行
24-06-20.19:45:42.713 [http-nio-8091-exec-5] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_2 node:RuleTreeNodeVO(treeId=tree_lock_2, ruleKey=rule_lock, ruleDesc=限定用户已完成N次抽奖后解锁, ruleValue=2, treeNodeLineVOList=[RuleTreeNodeLineVO(treeId=tree_lock_2, ruleNodeFrom=rule_lock, ruleNodeTo=rule_stock, ruleLimitType=EQUAL, ruleLimitValue=ALLOW), RuleTreeNodeLineVO(treeId=tree_lock_2, ruleNodeFrom=rule_lock, ruleNodeTo=rule_luck_award, ruleLimitType=EQUAL, ruleLimitValue=TAKE_OVER)]) code:0000
24-06-20.19:45:42.713 [http-nio-8091-exec-5] INFO  RuleStockTreeNode      - 规则过滤-库存节点, userId: matthew strategy: 100006 award: 106
24-06-20.19:45:42.714 [http-nio-8091-exec-5] INFO  RuleStockTreeNode      - 规则过滤-库存扣减-成功 userId:matthew strategyId:100006 awardId:106
24-06-20.19:45:42.716 [http-nio-8091-exec-5] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_2 node:RuleTreeNodeVO(treeId=tree_lock_2, ruleKey=rule_stock, ruleDesc=库存扣减规则, ruleValue=null, treeNodeLineVOList=[RuleTreeNodeLineVO(treeId=tree_lock_2, ruleNodeFrom=rule_stock, ruleNodeTo=rule_luck_award, ruleLimitType=EQUAL, ruleLimitValue=ALLOW)]) code:0001
24-06-20.19:45:42.717 [http-nio-8091-exec-5] INFO  AbstractRaffleStrategy - 完成规则树流程: userId: matthew strategyId: 100006 awardId: 106 规则: null
24-06-20.19:45:42.734 [http-nio-8091-exec-5] INFO  EventPublisher         - 发送MQ消息 topic:send-award-topic message:{"data":{"awardId":106,"awardTitle":"轻奢办公椅","userId":"matthew"},"id":"50174657067","timestamp":1718883942719}
24-06-20.19:45:42.753 [http-nio-8091-exec-9] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:45:42.753 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:45:42.760 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9998,"monthCount":100004,"monthCountSurplus":97697,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:45:42.761 [http-nio-8091-exec-9] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":2},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":2}]
24-06-20.19:45:45.291 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:45:45.309 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":false,"sort":5,"waitUnLockCount":1},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:45:50.137 [http-nio-8091-exec-10] INFO  RaffleActivityController - 活动抽奖 userId:matthew activityId:100001
24-06-20.19:45:50.167 [http-nio-8091-exec-10] INFO  RaffleActivityPartakeServiceService - orderId是：1253435664674848768
24-06-20.19:45:50.193 [http-nio-8091-exec-10] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:matthew activityId:100001 orderId:1253435664674848768
24-06-20.19:45:50.202 [http-nio-8091-exec-10] INFO  DefaultChainFilter     - 抽奖责任链-默认处理 userId: matthew strategyId: 100006 ruleModel: rule_default awardId: 102
24-06-20.19:45:50.202 [http-nio-8091-exec-10] INFO  AbstractRaffleStrategy - 完成责任链流程: userId: matthew strategyId: 100006 awardId: 102 规则: rule_default
24-06-20.19:45:50.224 [http-nio-8091-exec-10] INFO  DecisionTreeEngine     - 进入决策树处理, userId:matthew, strategyId:100006, awardId:102
24-06-20.19:45:50.224 [http-nio-8091-exec-10] INFO  RuleStockTreeNode      - 规则过滤-库存节点, userId: matthew strategy: 100006 award: 102
24-06-20.19:45:50.226 [http-nio-8091-exec-10] INFO  RuleStockTreeNode      - 规则过滤-库存扣减-成功 userId:matthew strategyId:100006 awardId:102
24-06-20.19:45:50.227 [http-nio-8091-exec-10] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:RuleTreeNodeVO(treeId=tree_luck_award, ruleKey=rule_stock, ruleDesc=库存扣减规则, ruleValue=null, treeNodeLineVOList=[RuleTreeNodeLineVO(treeId=tree_luck_award, ruleNodeFrom=rule_stock, ruleNodeTo=rule_luck_award, ruleLimitType=EQUAL, ruleLimitValue=ALLOW)]) code:0001
24-06-20.19:45:50.227 [http-nio-8091-exec-10] INFO  AbstractRaffleStrategy - 完成规则树流程: userId: matthew strategyId: 100006 awardId: 102 规则: null
24-06-20.19:45:50.247 [http-nio-8091-exec-10] INFO  EventPublisher         - 发送MQ消息 topic:send-award-topic message:{"data":{"awardId":102,"awardTitle":"OpenAI会员卡","userId":"matthew"},"id":"35646181735","timestamp":1718883950230}
24-06-20.19:45:50.265 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:45:50.265 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:45:50.275 [http-nio-8091-exec-7] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9997,"monthCount":100004,"monthCountSurplus":97696,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:45:50.277 [http-nio-8091-exec-2] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":3},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":3}]
24-06-20.19:45:52.815 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:45:52.830 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:45:58.777 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖 userId:matthew activityId:100001
24-06-20.19:45:58.807 [http-nio-8091-exec-3] INFO  RaffleActivityPartakeServiceService - orderId是：1253435700913635328
24-06-20.19:45:58.834 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:matthew activityId:100001 orderId:1253435700913635328
24-06-20.19:45:58.841 [http-nio-8091-exec-3] INFO  DefaultChainFilter     - 抽奖责任链-默认处理 userId: matthew strategyId: 100006 ruleModel: rule_default awardId: 107
24-06-20.19:45:58.841 [http-nio-8091-exec-3] INFO  AbstractRaffleStrategy - 完成责任链流程: userId: matthew strategyId: 100006 awardId: 107 规则: rule_default
24-06-20.19:45:58.853 [http-nio-8091-exec-3] INFO  DecisionTreeEngine     - 进入决策树处理, userId:matthew, strategyId:100006, awardId:107
24-06-20.19:45:58.854 [http-nio-8091-exec-3] INFO  RuleLockTreeNode       - 规则过滤-次数锁 userId:matthew strategyId:100006 awardId:107
24-06-20.19:45:58.859 [http-nio-8091-exec-3] INFO  RuleLockTreeNode       - 决策树-用户抽奖次数满足奖品要求-次数锁节点放行
24-06-20.19:45:58.859 [http-nio-8091-exec-3] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:RuleTreeNodeVO(treeId=tree_lock_1, ruleKey=rule_lock, ruleDesc=限定用户已完成N次抽奖后解锁, ruleValue=1, treeNodeLineVOList=[RuleTreeNodeLineVO(treeId=tree_lock_1, ruleNodeFrom=rule_lock, ruleNodeTo=rule_stock, ruleLimitType=EQUAL, ruleLimitValue=ALLOW), RuleTreeNodeLineVO(treeId=tree_lock_1, ruleNodeFrom=rule_lock, ruleNodeTo=rule_luck_award, ruleLimitType=EQUAL, ruleLimitValue=TAKE_OVER)]) code:0000
24-06-20.19:45:58.859 [http-nio-8091-exec-3] INFO  RuleStockTreeNode      - 规则过滤-库存节点, userId: matthew strategy: 100006 award: 107
24-06-20.19:45:58.861 [http-nio-8091-exec-3] INFO  RuleStockTreeNode      - 规则过滤-库存扣减-成功 userId:matthew strategyId:100006 awardId:107
24-06-20.19:45:58.863 [http-nio-8091-exec-3] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:RuleTreeNodeVO(treeId=tree_lock_1, ruleKey=rule_stock, ruleDesc=库存扣减规则, ruleValue=null, treeNodeLineVOList=[RuleTreeNodeLineVO(treeId=tree_lock_1, ruleNodeFrom=rule_stock, ruleNodeTo=rule_luck_award, ruleLimitType=EQUAL, ruleLimitValue=ALLOW)]) code:0001
24-06-20.19:45:58.863 [http-nio-8091-exec-3] INFO  AbstractRaffleStrategy - 完成规则树流程: userId: matthew strategyId: 100006 awardId: 107 规则: null
24-06-20.19:45:58.883 [http-nio-8091-exec-3] INFO  EventPublisher         - 发送MQ消息 topic:send-award-topic message:{"data":{"awardId":107,"awardTitle":"小霸王游戏机","userId":"matthew"},"id":"97172897375","timestamp":1718883958866}
24-06-20.19:45:58.902 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:45:58.903 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:45:58.909 [http-nio-8091-exec-8] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9996,"monthCount":100004,"monthCountSurplus":97695,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:45:58.910 [http-nio-8091-exec-4] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":4},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":4}]
24-06-20.19:46:01.435 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:46:01.450 [http-nio-8091-exec-10] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:47:09.205 [http-nio-8091-exec-1] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:47:09.205 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:47:09.214 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:47:09.214 [http-nio-8091-exec-9] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:47:09.215 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:47:09.215 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:47:09.222 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:47:09.222 [http-nio-8091-exec-8] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:47:09.226 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:47:09.227 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:47:09.229 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9996,"monthCount":100004,"monthCountSurplus":97695,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:47:09.230 [http-nio-8091-exec-9] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9996,"monthCount":100004,"monthCountSurplus":97695,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:47:09.231 [http-nio-8091-exec-1] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:47:09.231 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:47:09.246 [http-nio-8091-exec-4] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":4},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":4}]
24-06-20.19:47:09.246 [http-nio-8091-exec-8] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":4},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":4}]
24-06-20.19:52:40.268 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:52:40.269 [http-nio-8091-exec-1] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:52:40.268 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:52:40.268 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:52:40.273 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:52:40.273 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:52:40.289 [http-nio-8091-exec-8] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9996,"monthCount":100004,"monthCountSurplus":97695,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:52:40.292 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9996,"monthCount":100004,"monthCountSurplus":97695,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:52:40.297 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:52:40.298 [http-nio-8091-exec-5] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":4},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":4}]
24-06-20.19:52:40.298 [http-nio-8091-exec-10] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":4},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":4}]
24-06-20.19:52:40.330 [http-nio-8091-exec-1] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:52:40.330 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:52:40.330 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:52:40.337 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:52:40.338 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:53:11.154 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:53:11.155 [http-nio-8091-exec-9] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:53:11.155 [http-nio-8091-exec-1] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:53:11.155 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:53:11.156 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:53:11.157 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:53:11.166 [http-nio-8091-exec-9] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:53:11.166 [http-nio-8091-exec-7] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:53:11.172 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:53:11.172 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:53:11.174 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9996,"monthCount":100004,"monthCountSurplus":97695,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:53:11.174 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9996,"monthCount":100004,"monthCountSurplus":97695,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:53:11.176 [http-nio-8091-exec-1] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:53:11.184 [http-nio-8091-exec-8] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:53:11.207 [http-nio-8091-exec-4] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":4},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":4}]
24-06-20.19:53:11.207 [http-nio-8091-exec-10] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":4},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":4}]
24-06-20.19:53:16.343 [http-nio-8091-exec-1] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:53:16.343 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:53:16.351 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:53:16.351 [http-nio-8091-exec-9] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:53:16.352 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:53:16.353 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:53:16.359 [http-nio-8091-exec-2] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:53:16.360 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:53:16.363 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:53:16.364 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:53:16.364 [http-nio-8091-exec-1] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:53:16.364 [http-nio-8091-exec-10] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9996,"monthCount":100004,"monthCountSurplus":97695,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:53:16.365 [http-nio-8091-exec-9] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9996,"monthCount":100004,"monthCountSurplus":97695,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:53:16.370 [http-nio-8091-exec-8] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:53:16.377 [http-nio-8091-exec-6] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":4},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":4}]
24-06-20.19:53:16.377 [http-nio-8091-exec-3] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":4},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":4}]
24-06-20.19:53:24.955 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:53:24.955 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:53:24.963 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:53:24.963 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:53:24.965 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:53:24.966 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:53:24.974 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:53:24.974 [http-nio-8091-exec-5] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:53:24.977 [http-nio-8091-exec-1] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:53:24.977 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:53:24.978 [http-nio-8091-exec-10] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:53:24.978 [http-nio-8091-exec-8] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:53:24.983 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9996,"monthCount":100004,"monthCountSurplus":97695,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:53:24.983 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9996,"monthCount":100004,"monthCountSurplus":97695,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:53:24.992 [http-nio-8091-exec-2] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":4},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":4}]
24-06-20.19:53:24.992 [http-nio-8091-exec-1] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":4},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":4}]
24-06-20.19:53:35.646 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:53:35.646 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:53:35.658 [http-nio-8091-exec-1] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:53:35.658 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:53:35.660 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:53:35.661 [http-nio-8091-exec-9] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:53:35.675 [http-nio-8091-exec-9] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:53:35.675 [http-nio-8091-exec-5] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:53:35.688 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:53:35.688 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:53:35.696 [http-nio-8091-exec-1] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9996,"monthCount":100004,"monthCountSurplus":97695,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:53:35.698 [http-nio-8091-exec-2] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9996,"monthCount":100004,"monthCountSurplus":97695,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:53:35.711 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:53:35.713 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:53:35.721 [http-nio-8091-exec-8] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":4},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":4}]
24-06-20.19:53:35.723 [http-nio-8091-exec-4] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":4},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":4}]
24-06-20.19:54:12.757 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:54:12.757 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:54:12.790 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:54:12.792 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:54:12.794 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:54:12.794 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:54:12.813 [http-nio-8091-exec-7] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:54:12.815 [http-nio-8091-exec-5] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:54:12.824 [http-nio-8091-exec-9] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:54:12.824 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:54:12.830 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:54:12.830 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:54:12.836 [http-nio-8091-exec-8] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9996,"monthCount":100004,"monthCountSurplus":97695,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:54:12.836 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9996,"monthCount":100004,"monthCountSurplus":97695,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:54:12.841 [http-nio-8091-exec-9] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":4},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":4}]
24-06-20.19:54:12.844 [http-nio-8091-exec-10] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":4},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":4}]
24-06-20.19:54:15.239 [http-nio-8091-exec-1] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:54:15.243 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:54:15.269 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:54:15.269 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:54:15.272 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:54:15.274 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:54:15.276 [http-nio-8091-exec-1] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:54:15.278 [http-nio-8091-exec-2] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:54:15.278 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:54:15.279 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:54:15.279 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:54:15.283 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9996,"monthCount":100004,"monthCountSurplus":97695,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:54:15.284 [http-nio-8091-exec-2] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:54:15.286 [http-nio-8091-exec-5] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":4},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":4}]
24-06-20.19:54:15.286 [http-nio-8091-exec-7] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":4},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":4}]
24-06-20.19:54:15.287 [http-nio-8091-exec-8] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9996,"monthCount":100004,"monthCountSurplus":97695,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:54:25.500 [kafka-producer-network-thread | producer-1] INFO  NetworkClient          - [Producer clientId=producer-1] Node -1 disconnected.
24-06-20.19:54:38.991 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:54:38.991 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:54:39.008 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:54:39.009 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:54:39.009 [http-nio-8091-exec-1] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:54:39.009 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:54:39.016 [http-nio-8091-exec-1] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:54:39.016 [http-nio-8091-exec-8] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:54:39.019 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:54:39.019 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:54:39.025 [http-nio-8091-exec-5] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9996,"monthCount":100004,"monthCountSurplus":97695,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:54:39.025 [http-nio-8091-exec-2] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:54:39.027 [http-nio-8091-exec-7] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:54:39.033 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9996,"monthCount":100004,"monthCountSurplus":97695,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:54:39.066 [http-nio-8091-exec-6] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":4},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":4}]
24-06-20.19:54:39.066 [http-nio-8091-exec-3] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":4},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":4}]
24-06-20.19:54:44.516 [http-nio-8091-exec-7] INFO  RaffleActivityController - 活动抽奖 userId:matthew activityId:100001
24-06-20.19:54:44.541 [http-nio-8091-exec-7] INFO  RaffleActivityPartakeServiceService - orderId是：1253437906001854464
24-06-20.19:54:44.574 [http-nio-8091-exec-7] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:matthew activityId:100001 orderId:1253437906001854464
24-06-20.19:54:44.583 [http-nio-8091-exec-7] INFO  DefaultChainFilter     - 抽奖责任链-默认处理 userId: matthew strategyId: 100006 ruleModel: rule_default awardId: 106
24-06-20.19:54:44.583 [http-nio-8091-exec-7] INFO  AbstractRaffleStrategy - 完成责任链流程: userId: matthew strategyId: 100006 awardId: 106 规则: rule_default
24-06-20.19:54:44.589 [http-nio-8091-exec-7] INFO  DecisionTreeEngine     - 进入决策树处理, userId:matthew, strategyId:100006, awardId:106
24-06-20.19:54:44.589 [http-nio-8091-exec-7] INFO  RuleLockTreeNode       - 规则过滤-次数锁 userId:matthew strategyId:100006 awardId:106
24-06-20.19:54:44.596 [http-nio-8091-exec-7] INFO  RuleLockTreeNode       - 决策树-用户抽奖次数满足奖品要求-次数锁节点放行
24-06-20.19:54:44.596 [http-nio-8091-exec-7] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_2 node:RuleTreeNodeVO(treeId=tree_lock_2, ruleKey=rule_lock, ruleDesc=限定用户已完成N次抽奖后解锁, ruleValue=2, treeNodeLineVOList=[RuleTreeNodeLineVO(treeId=tree_lock_2, ruleNodeFrom=rule_lock, ruleNodeTo=rule_stock, ruleLimitType=EQUAL, ruleLimitValue=ALLOW), RuleTreeNodeLineVO(treeId=tree_lock_2, ruleNodeFrom=rule_lock, ruleNodeTo=rule_luck_award, ruleLimitType=EQUAL, ruleLimitValue=TAKE_OVER)]) code:0000
24-06-20.19:54:44.596 [http-nio-8091-exec-7] INFO  RuleStockTreeNode      - 规则过滤-库存节点, userId: matthew strategy: 100006 award: 106
24-06-20.19:54:44.598 [http-nio-8091-exec-7] INFO  RuleStockTreeNode      - 规则过滤-库存扣减-成功 userId:matthew strategyId:100006 awardId:106
24-06-20.19:54:44.602 [http-nio-8091-exec-7] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_2 node:RuleTreeNodeVO(treeId=tree_lock_2, ruleKey=rule_stock, ruleDesc=库存扣减规则, ruleValue=null, treeNodeLineVOList=[RuleTreeNodeLineVO(treeId=tree_lock_2, ruleNodeFrom=rule_stock, ruleNodeTo=rule_luck_award, ruleLimitType=EQUAL, ruleLimitValue=ALLOW)]) code:0001
24-06-20.19:54:44.602 [http-nio-8091-exec-7] INFO  AbstractRaffleStrategy - 完成规则树流程: userId: matthew strategyId: 100006 awardId: 106 规则: null
24-06-20.19:54:44.633 [http-nio-8091-exec-7] INFO  EventPublisher         - 发送MQ消息 topic:send-award-topic message:{"data":{"awardId":106,"awardTitle":"轻奢办公椅","userId":"matthew"},"id":"97438087530","timestamp":1718884484605}
24-06-20.19:54:44.658 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:54:44.658 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:54:44.665 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:54:44.666 [http-nio-8091-exec-6] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.19:54:47.197 [http-nio-8091-exec-1] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:54:47.210 [http-nio-8091-exec-1] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:56:55.608 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:56:55.608 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:56:55.616 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:56:55.616 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:56:55.619 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:56:55.619 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:56:55.657 [http-nio-8091-exec-7] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:56:55.658 [http-nio-8091-exec-2] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:56:55.658 [http-nio-8091-exec-8] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:56:55.659 [http-nio-8091-exec-6] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.19:56:55.660 [http-nio-8091-exec-4] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.19:56:55.660 [http-nio-8091-exec-5] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:56:55.663 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:56:55.663 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:56:55.665 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:56:55.667 [http-nio-8091-exec-10] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:57:49.276 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:57:49.276 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.19:57:49.281 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:57:49.281 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.19:57:49.283 [http-nio-8091-exec-9] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:57:49.283 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.19:57:49.292 [http-nio-8091-exec-9] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:57:49.292 [http-nio-8091-exec-8] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.19:57:49.296 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:57:49.296 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.19:57:49.303 [http-nio-8091-exec-10] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:57:49.303 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.19:57:49.307 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:57:49.308 [http-nio-8091-exec-2] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.19:57:49.490 [http-nio-8091-exec-7] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.19:57:49.490 [http-nio-8091-exec-5] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.20:04:45.479 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:04:45.479 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:04:45.486 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:04:45.486 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:04:45.492 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:04:45.492 [http-nio-8091-exec-1] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:04:45.505 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:04:45.505 [http-nio-8091-exec-1] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:04:45.509 [http-nio-8091-exec-9] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:04:45.509 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:04:45.514 [http-nio-8091-exec-5] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:04:45.514 [http-nio-8091-exec-7] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:04:45.519 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:04:45.525 [http-nio-8091-exec-2] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:04:45.528 [http-nio-8091-exec-9] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.20:04:45.529 [http-nio-8091-exec-8] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.20:04:49.992 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:04:49.991 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:04:49.992 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:04:49.992 [http-nio-8091-exec-9] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:04:49.992 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:04:49.991 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:04:50.008 [http-nio-8091-exec-9] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:04:50.008 [http-nio-8091-exec-8] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:04:50.010 [http-nio-8091-exec-10] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.20:04:50.010 [http-nio-8091-exec-3] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.20:04:50.012 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:04:50.012 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:04:50.014 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:04:50.017 [http-nio-8091-exec-8] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:04:50.019 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:04:50.021 [http-nio-8091-exec-2] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:05:53.280 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:05:53.280 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:05:53.285 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:05:53.285 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:05:53.287 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:05:53.288 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:05:53.294 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:05:53.294 [http-nio-8091-exec-10] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:05:53.297 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:05:53.297 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:05:53.306 [http-nio-8091-exec-2] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:05:53.306 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:05:53.308 [http-nio-8091-exec-8] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:05:53.308 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:05:53.313 [http-nio-8091-exec-3] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.20:05:53.315 [http-nio-8091-exec-7] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.20:07:23.229 [http-nio-8091-exec-1] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:07:23.250 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:07:23.250 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:07:23.229 [http-nio-8091-exec-9] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:07:23.254 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:07:23.254 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:07:23.267 [http-nio-8091-exec-1] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:07:23.268 [http-nio-8091-exec-9] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:07:23.270 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:07:23.270 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:07:23.284 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:07:23.284 [http-nio-8091-exec-7] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:07:23.286 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:07:23.286 [http-nio-8091-exec-10] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:07:23.290 [http-nio-8091-exec-8] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.20:07:23.290 [http-nio-8091-exec-2] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.20:10:00.092 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:10:00.092 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:10:00.105 [http-nio-8091-exec-9] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:10:00.105 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:10:00.105 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:10:00.106 [http-nio-8091-exec-1] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:10:00.118 [http-nio-8091-exec-9] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:10:00.121 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:10:00.122 [http-nio-8091-exec-1] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:10:00.128 [http-nio-8091-exec-1] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:10:00.144 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:10:00.149 [http-nio-8091-exec-10] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:10:00.149 [http-nio-8091-exec-2] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:10:00.151 [http-nio-8091-exec-8] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:10:00.160 [http-nio-8091-exec-6] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.20:10:00.163 [http-nio-8091-exec-1] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.20:10:06.749 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:10:06.752 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:10:06.757 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:10:06.757 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:10:06.757 [http-nio-8091-exec-1] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:10:06.757 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:10:06.773 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:10:06.775 [http-nio-8091-exec-5] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:10:06.775 [http-nio-8091-exec-2] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:10:06.775 [http-nio-8091-exec-8] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:10:06.776 [http-nio-8091-exec-9] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:10:06.776 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:10:06.779 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:10:06.779 [http-nio-8091-exec-1] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.20:10:06.782 [http-nio-8091-exec-6] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.20:10:06.782 [http-nio-8091-exec-9] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:11:47.234 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:11:47.234 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:11:47.234 [http-nio-8091-exec-9] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:11:47.234 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:11:47.234 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:11:47.234 [http-nio-8091-exec-1] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:11:47.259 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:11:47.260 [http-nio-8091-exec-10] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:11:47.262 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:11:47.262 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:11:47.263 [http-nio-8091-exec-1] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:11:47.263 [http-nio-8091-exec-9] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.20:11:47.286 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:11:47.286 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:11:47.287 [http-nio-8091-exec-10] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:11:47.289 [http-nio-8091-exec-6] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.20:13:28.682 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:13:28.683 [http-nio-8091-exec-9] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:13:28.693 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:13:28.695 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:13:28.697 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:13:28.699 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:13:28.729 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:13:28.729 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:13:28.735 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:13:28.736 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:13:28.736 [http-nio-8091-exec-2] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.20:13:28.741 [http-nio-8091-exec-5] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:13:28.742 [http-nio-8091-exec-9] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:13:28.744 [http-nio-8091-exec-8] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.20:13:28.746 [http-nio-8091-exec-10] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:13:28.748 [http-nio-8091-exec-7] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:13:48.939 [http-nio-8091-exec-1] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:13:48.938 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:13:48.939 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:13:48.939 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:13:48.938 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:13:48.939 [http-nio-8091-exec-9] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:13:48.946 [http-nio-8091-exec-10] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:13:48.946 [http-nio-8091-exec-7] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:13:48.949 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:13:48.949 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:13:48.954 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:13:48.954 [http-nio-8091-exec-1] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:13:48.955 [http-nio-8091-exec-8] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:13:48.957 [http-nio-8091-exec-9] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:13:48.962 [http-nio-8091-exec-4] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.20:13:48.962 [http-nio-8091-exec-6] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.20:17:37.624 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:17:37.624 [http-nio-8091-exec-9] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:17:37.634 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:17:37.634 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:17:37.635 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:17:37.636 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:17:37.648 [http-nio-8091-exec-7] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:17:37.648 [http-nio-8091-exec-2] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:17:37.661 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:17:37.661 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:17:37.669 [http-nio-8091-exec-9] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:17:37.669 [http-nio-8091-exec-5] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.20:17:37.669 [http-nio-8091-exec-3] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.20:17:37.670 [http-nio-8091-exec-8] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:17:37.670 [http-nio-8091-exec-2] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:17:37.672 [http-nio-8091-exec-10] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:17:57.554 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:17:57.554 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:17:57.554 [http-nio-8091-exec-1] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:17:57.554 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:17:57.554 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:17:57.554 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:17:57.574 [http-nio-8091-exec-1] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:17:57.577 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:17:57.579 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:17:57.579 [http-nio-8091-exec-10] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:17:57.580 [http-nio-8091-exec-2] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:17:57.581 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:17:57.582 [http-nio-8091-exec-4] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.20:17:57.583 [http-nio-8091-exec-8] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:17:57.584 [http-nio-8091-exec-5] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:17:57.589 [http-nio-8091-exec-7] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.20:18:02.277 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:18:02.277 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:18:02.283 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:18:02.283 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:18:02.284 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:18:02.285 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:18:02.286 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:18:02.286 [http-nio-8091-exec-8] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:18:02.287 [http-nio-8091-exec-2] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:18:02.287 [http-nio-8091-exec-7] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:18:02.288 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:18:02.290 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:18:02.290 [http-nio-8091-exec-5] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:18:02.292 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:18:02.295 [http-nio-8091-exec-7] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.20:18:02.296 [http-nio-8091-exec-2] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.20:18:49.750 [http-nio-8091-exec-9] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:18:49.751 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:18:49.752 [http-nio-8091-exec-1] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:18:49.751 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:18:49.750 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:18:49.750 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:18:49.759 [http-nio-8091-exec-9] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:18:49.759 [http-nio-8091-exec-1] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:18:49.762 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:18:49.762 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:18:49.764 [http-nio-8091-exec-7] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:18:49.764 [http-nio-8091-exec-2] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:18:49.765 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:18:49.770 [http-nio-8091-exec-5] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:18:49.786 [http-nio-8091-exec-4] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.20:18:49.789 [http-nio-8091-exec-8] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.20:18:50.476 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:18:50.476 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:18:50.482 [http-nio-8091-exec-1] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:18:50.482 [http-nio-8091-exec-9] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:18:50.485 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:18:50.485 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:18:50.491 [http-nio-8091-exec-7] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:18:50.494 [http-nio-8091-exec-2] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:18:50.495 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:18:50.498 [http-nio-8091-exec-10] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:18:50.498 [http-nio-8091-exec-1] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:18:50.499 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:18:50.499 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:18:50.501 [http-nio-8091-exec-9] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:18:50.505 [http-nio-8091-exec-6] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.20:18:50.507 [http-nio-8091-exec-5] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.20:20:00.391 [http-nio-8091-exec-9] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:20:00.391 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:20:00.391 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:20:00.391 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:20:00.391 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:20:00.391 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:20:00.411 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:20:00.411 [http-nio-8091-exec-7] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:20:00.422 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:20:00.423 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:20:00.425 [http-nio-8091-exec-8] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:20:00.425 [http-nio-8091-exec-5] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:20:00.428 [http-nio-8091-exec-9] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:20:00.428 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:20:00.434 [http-nio-8091-exec-2] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.20:20:00.434 [http-nio-8091-exec-4] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.20:20:32.916 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:20:32.917 [http-nio-8091-exec-9] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:20:32.934 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:20:32.934 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:20:32.935 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:20:32.935 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:20:32.943 [http-nio-8091-exec-7] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:20:32.944 [http-nio-8091-exec-10] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:20:32.947 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:20:32.947 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:20:32.953 [http-nio-8091-exec-2] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:20:32.955 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9995,"monthCount":100004,"monthCountSurplus":97694,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:20:32.955 [http-nio-8091-exec-9] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:20:32.957 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:20:32.961 [http-nio-8091-exec-6] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.20:20:32.961 [http-nio-8091-exec-8] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":5},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":5}]
24-06-20.20:20:38.899 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖 userId:matthew activityId:100001
24-06-20.20:20:38.938 [http-nio-8091-exec-3] INFO  RaffleActivityPartakeServiceService - orderId是：1253444425615409152
24-06-20.20:20:38.983 [http-nio-8091-exec-3] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:matthew activityId:100001 orderId:1253444425615409152
24-06-20.20:20:38.992 [http-nio-8091-exec-3] INFO  DefaultChainFilter     - 抽奖责任链-默认处理 userId: matthew strategyId: 100006 ruleModel: rule_default awardId: 105
24-06-20.20:20:38.992 [http-nio-8091-exec-3] INFO  AbstractRaffleStrategy - 完成责任链流程: userId: matthew strategyId: 100006 awardId: 105 规则: rule_default
24-06-20.20:20:39.010 [http-nio-8091-exec-3] INFO  DecisionTreeEngine     - 进入决策树处理, userId:matthew, strategyId:100006, awardId:105
24-06-20.20:20:39.010 [http-nio-8091-exec-3] INFO  RuleLockTreeNode       - 规则过滤-次数锁 userId:matthew strategyId:100006 awardId:105
24-06-20.20:20:39.016 [http-nio-8091-exec-3] INFO  RuleLockTreeNode       - 决策树-用户抽奖次数满足奖品要求-次数锁节点放行
24-06-20.20:20:39.017 [http-nio-8091-exec-3] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_3 node:RuleTreeNodeVO(treeId=tree_lock_3, ruleKey=rule_lock, ruleDesc=限定用户已完成N次抽奖后解锁, ruleValue=3, treeNodeLineVOList=[RuleTreeNodeLineVO(treeId=tree_lock_3, ruleNodeFrom=rule_lock, ruleNodeTo=rule_luck_award, ruleLimitType=EQUAL, ruleLimitValue=ALLOW), RuleTreeNodeLineVO(treeId=tree_lock_3, ruleNodeFrom=rule_lock, ruleNodeTo=rule_luck_award, ruleLimitType=EQUAL, ruleLimitValue=TAKE_OVER)]) code:0000
24-06-20.20:20:39.017 [http-nio-8091-exec-3] INFO  RuleLuckAwardTreeNode  - 规则过滤-兜底奖品 userId:matthew strategyId:100006 awardId:105 ruleValue:101:1,100
24-06-20.20:20:39.017 [http-nio-8091-exec-3] INFO  RuleLuckAwardTreeNode  - 决策树-兜底节点接管 luckAwardId: 1,100 luckRuleValue: 1,100
24-06-20.20:20:39.017 [http-nio-8091-exec-3] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_3 node:RuleTreeNodeVO(treeId=tree_lock_3, ruleKey=rule_luck_award, ruleDesc=兜底奖品随机积分, ruleValue=101:1,100, treeNodeLineVOList=null) code:0001
24-06-20.20:20:39.018 [http-nio-8091-exec-3] INFO  AbstractRaffleStrategy - 完成规则树流程: userId: matthew strategyId: 100006 awardId: 101 规则: 1,100
24-06-20.20:20:39.047 [kafka-producer-network-thread | producer-1] INFO  Metadata               - [Producer clientId=producer-1] Resetting the last seen epoch of partition send-award-topic-0 to 0 since the associated topicId changed from null to 7B2TfuZETI-OeTtx5TJ86g
24-06-20.20:20:39.049 [http-nio-8091-exec-3] INFO  EventPublisher         - 发送MQ消息 topic:send-award-topic message:{"data":{"awardId":101,"awardTitle":"随机积分","userId":"matthew"},"id":"06235479817","timestamp":1718886039022}
24-06-20.20:20:39.081 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:20:39.081 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:20:39.090 [http-nio-8091-exec-8] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9994,"monthCount":100004,"monthCountSurplus":97693,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:20:39.090 [http-nio-8091-exec-6] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":6},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":6}]
24-06-20.20:20:41.622 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:20:41.638 [http-nio-8091-exec-10] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:20:46.258 [http-nio-8091-exec-4] INFO  RaffleActivityController - 活动抽奖 userId:matthew activityId:100001
24-06-20.20:20:46.290 [http-nio-8091-exec-4] INFO  RaffleActivityPartakeServiceService - orderId是：1253444456451932160
24-06-20.20:20:46.327 [http-nio-8091-exec-4] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:matthew activityId:100001 orderId:1253444456451932160
24-06-20.20:20:46.335 [http-nio-8091-exec-4] INFO  DefaultChainFilter     - 抽奖责任链-默认处理 userId: matthew strategyId: 100006 ruleModel: rule_default awardId: 104
24-06-20.20:20:46.335 [http-nio-8091-exec-4] INFO  AbstractRaffleStrategy - 完成责任链流程: userId: matthew strategyId: 100006 awardId: 104 规则: rule_default
24-06-20.20:20:46.340 [http-nio-8091-exec-4] INFO  DecisionTreeEngine     - 进入决策树处理, userId:matthew, strategyId:100006, awardId:104
24-06-20.20:20:46.340 [http-nio-8091-exec-4] INFO  RuleStockTreeNode      - 规则过滤-库存节点, userId: matthew strategy: 100006 award: 104
24-06-20.20:20:46.341 [http-nio-8091-exec-4] INFO  RuleStockTreeNode      - 规则过滤-库存扣减-成功 userId:matthew strategyId:100006 awardId:104
24-06-20.20:20:46.343 [http-nio-8091-exec-4] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:RuleTreeNodeVO(treeId=tree_luck_award, ruleKey=rule_stock, ruleDesc=库存扣减规则, ruleValue=null, treeNodeLineVOList=[RuleTreeNodeLineVO(treeId=tree_luck_award, ruleNodeFrom=rule_stock, ruleNodeTo=rule_luck_award, ruleLimitType=EQUAL, ruleLimitValue=ALLOW)]) code:0001
24-06-20.20:20:46.344 [http-nio-8091-exec-4] INFO  AbstractRaffleStrategy - 完成规则树流程: userId: matthew strategyId: 100006 awardId: 104 规则: null
24-06-20.20:20:46.367 [http-nio-8091-exec-4] INFO  EventPublisher         - 发送MQ消息 topic:send-award-topic message:{"data":{"awardId":104,"awardTitle":"小米台灯","userId":"matthew"},"id":"28064378153","timestamp":1718886046348}
24-06-20.20:20:46.387 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:20:46.387 [http-nio-8091-exec-9] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:20:46.395 [http-nio-8091-exec-7] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9993,"monthCount":100004,"monthCountSurplus":97692,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:20:46.398 [http-nio-8091-exec-9] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":7},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":7}]
24-06-20.20:20:48.929 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:20:48.941 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:23:38.900 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:23:38.900 [http-nio-8091-exec-1] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:23:38.921 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:23:38.921 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:23:38.921 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:23:38.921 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:23:38.929 [http-nio-8091-exec-1] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:23:38.929 [http-nio-8091-exec-5] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:23:38.933 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:23:38.933 [http-nio-8091-exec-9] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:23:38.947 [http-nio-8091-exec-2] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9993,"monthCount":100004,"monthCountSurplus":97692,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:23:38.960 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:23:38.960 [http-nio-8091-exec-9] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:23:38.965 [http-nio-8091-exec-10] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9993,"monthCount":100004,"monthCountSurplus":97692,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:23:38.972 [http-nio-8091-exec-4] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":7},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":7}]
24-06-20.20:23:38.974 [http-nio-8091-exec-7] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":7},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":7}]
24-06-20.20:26:02.266 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Revoke previously assigned partitions sku-clear-topic-0
24-06-20.20:26:02.268 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-20.20:26:02.268 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Revoke previously assigned partitions send-rebate-topic-0
24-06-20.20:26:02.268 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Revoke previously assigned partitions sku-deduct-topic-0
24-06-20.20:26:02.268 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-20.20:26:02.268 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-20.20:26:02.271 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-e3b13aed-56b3-49bb-9d16-282141fb014d sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.20:26:02.271 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-e6b1bfc2-ac0b-442a-a536-540dae6b818f sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.20:26:02.271 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-0b734a4c-86b5-4272-9f45-a233f65483c4 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.20:26:02.278 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.20:26:02.278 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.20:26:02.278 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.20:26:02.278 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.20:26:02.278 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.20:26:02.278 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.20:26:02.280 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.20:26:02.280 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.20:26:02.280 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.20:26:02.287 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.20:26:02.287 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.20:26:02.287 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.20:26:02.288 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.20:26:02.290 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.20:26:02.290 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.20:26:02.316 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.20:26:02.316 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.20:26:02.316 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.20:26:02.316 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.20:26:02.317 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.20:26:02.317 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.20:26:02.317 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.20:26:02.317 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.20:26:02.317 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.20:26:02.324 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-20.20:26:02.326 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-20.20:26:02.329 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-20.20:26:02.329 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-20.20:26:02.330 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-20.20:26:02.330 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-20.20:26:02.359 [SpringApplicationShutdownHook] INFO  KafkaProducer          - [Producer clientId=producer-1] Closing the Kafka producer with timeoutMillis = 30000 ms.
24-06-20.20:26:02.370 [SpringApplicationShutdownHook] INFO  Metrics                - Metrics scheduler closed
24-06-20.20:26:02.370 [SpringApplicationShutdownHook] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.20:26:02.370 [SpringApplicationShutdownHook] INFO  Metrics                - Metrics reporters closed
24-06-20.20:26:02.371 [SpringApplicationShutdownHook] INFO  AppInfoParser          - App info kafka.producer for producer-1 unregistered
24-06-20.20:26:07.614 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 31719 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-20.20:26:07.618 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-20.20:26:08.285 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-20.20:26:08.287 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-20.20:26:08.306 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 11 ms. Found 0 Redis repository interfaces.
24-06-20.20:26:08.725 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-20.20:26:08.729 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-20.20:26:08.729 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-20.20:26:08.729 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-20.20:26:08.773 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-20.20:26:08.773 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1088 ms
24-06-20.20:26:09.155 [main            ] INFO  Version                - Redisson 3.26.0
24-06-20.20:26:09.179 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-20.20:26:09.272 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.20:26:09.284 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.20:26:09.861 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-20.20:26:10.010 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.20:26:10.045 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.20:26:10.045 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.20:26:10.045 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718886370044
24-06-20.20:26:10.052 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-20.20:26:10.059 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.20:26:10.063 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.20:26:10.063 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.20:26:10.063 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718886370063
24-06-20.20:26:10.066 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-20.20:26:10.067 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.20:26:10.070 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.20:26:10.070 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.20:26:10.070 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718886370070
24-06-20.20:26:10.073 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-20.20:26:10.073 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
24-06-20.20:26:10.080 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-20.20:26:10.091 [main            ] INFO  Application            - Started Application in 2.849 seconds (JVM running for 3.285)
24-06-20.20:26:10.242 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-20.20:26:10.242 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-20.20:26:10.242 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-20.20:26:10.243 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.20:26:10.243 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.20:26:10.243 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.20:26:10.243 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:26:10.243 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:26:10.243 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:26:10.247 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.20:26:10.247 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.20:26:10.247 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.20:26:10.265 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-20.20:26:10.265 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-20.20:26:10.265 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-20.20:26:10.265 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.20:26:10.265 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.20:26:10.265 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.20:26:10.602 [RMI TCP Connection(3)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
24-06-20.20:26:10.602 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
24-06-20.20:26:10.603 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 1 ms
24-06-20.20:26:10.607 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.20:26:10.928 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.20:26:10.939 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.20:26:10.959 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.20:26:11.981 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:26:12.016 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.20:26:12.047 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.20:29:03.332 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=2m52s268ms).
24-06-20.20:29:03.332 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=2m52s294ms).
24-06-20.20:29:03.334 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=321, memberId='consumer-sku-deduct-group-2-604dab60-3333-4966-998f-e81abf67e4ff', protocol='range'}
24-06-20.20:29:03.335 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=323, memberId='consumer-sku-clear-group-3-20e3a3bd-7cba-4a95-a23c-5418017550d9', protocol='range'}
24-06-20.20:29:03.335 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=69, memberId='consumer-send-rebate-group-1-a7feb4b2-45d2-4c0c-b6f3-25ed4944e69f', protocol='range'}
24-06-20.20:29:03.340 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 323: {consumer-sku-clear-group-3-20e3a3bd-7cba-4a95-a23c-5418017550d9=Assignment(partitions=[sku-clear-topic-0])}
24-06-20.20:29:03.340 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 69: {consumer-send-rebate-group-1-a7feb4b2-45d2-4c0c-b6f3-25ed4944e69f=Assignment(partitions=[send-rebate-topic-0])}
24-06-20.20:29:03.340 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 321: {consumer-sku-deduct-group-2-604dab60-3333-4966-998f-e81abf67e4ff=Assignment(partitions=[sku-deduct-topic-0])}
24-06-20.20:29:03.359 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] SyncGroup failed: The coordinator is not aware of this member. Need to re-join the group. Sent generation was Generation{generationId=69, memberId='consumer-send-rebate-group-1-a7feb4b2-45d2-4c0c-b6f3-25ed4944e69f', protocol='range'}
24-06-20.20:29:03.359 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] SyncGroup failed: The coordinator is not aware of this member. Need to re-join the group. Sent generation was Generation{generationId=323, memberId='consumer-sku-clear-group-3-20e3a3bd-7cba-4a95-a23c-5418017550d9', protocol='range'}
24-06-20.20:29:03.359 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] SyncGroup failed: The coordinator is not aware of this member. Need to re-join the group. Sent generation was Generation{generationId=321, memberId='consumer-sku-deduct-group-2-604dab60-3333-4966-998f-e81abf67e4ff', protocol='range'}
24-06-20.20:29:03.359 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: encountered UNKNOWN_MEMBER_ID from SYNC_GROUP response
24-06-20.20:29:03.359 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: encountered UNKNOWN_MEMBER_ID from SYNC_GROUP response
24-06-20.20:29:03.359 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: encountered UNKNOWN_MEMBER_ID from SYNC_GROUP response
24-06-20.20:29:03.359 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: encountered UNKNOWN_MEMBER_ID from SYNC_GROUP response
24-06-20.20:29:03.360 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.20:29:03.360 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.20:29:03.360 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: encountered UNKNOWN_MEMBER_ID from SYNC_GROUP response
24-06-20.20:29:03.360 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: encountered UNKNOWN_MEMBER_ID from SYNC_GROUP response
24-06-20.20:29:03.360 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.20:29:03.365 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-20.20:29:03.365 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-20.20:29:03.366 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-20.20:29:03.366 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.20:29:03.366 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.20:29:03.366 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.20:29:03.435 [http-nio-8091-exec-2] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":7},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":7}]
24-06-20.20:29:05.847 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:29:37.099 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=3m16s473ms).
24-06-20.20:29:31.527 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=71, memberId='consumer-send-rebate-group-1-b19b146c-4629-4d14-a9da-847aa4af96fc', protocol='range'}
24-06-20.20:29:31.527 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=325, memberId='consumer-sku-clear-group-3-f766b473-9c74-4d90-bf85-cc3a37dcbe36', protocol='range'}
24-06-20.20:29:31.527 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=323, memberId='consumer-sku-deduct-group-2-bbda1102-196e-4b64-9966-3a9b51b8d8c3', protocol='range'}
24-06-20.20:29:37.834 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 71: {consumer-send-rebate-group-1-b19b146c-4629-4d14-a9da-847aa4af96fc=Assignment(partitions=[send-rebate-topic-0])}
24-06-20.20:29:37.833 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 323: {consumer-sku-deduct-group-2-bbda1102-196e-4b64-9966-3a9b51b8d8c3=Assignment(partitions=[sku-deduct-topic-0])}
24-06-20.20:29:38.991 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 325: {consumer-sku-clear-group-3-f766b473-9c74-4d90-bf85-cc3a37dcbe36=Assignment(partitions=[sku-clear-topic-0])}
24-06-20.20:29:43.975 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=323, memberId='consumer-sku-deduct-group-2-bbda1102-196e-4b64-9966-3a9b51b8d8c3', protocol='range'}
24-06-20.20:29:43.975 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=71, memberId='consumer-send-rebate-group-1-b19b146c-4629-4d14-a9da-847aa4af96fc', protocol='range'}
24-06-20.20:29:59.176 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=325, memberId='consumer-sku-clear-group-3-f766b473-9c74-4d90-bf85-cc3a37dcbe36', protocol='range'}
24-06-20.20:30:01.442 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-20.20:30:01.442 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-20.20:34:55.186 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=5m18s81ms).
24-06-20.20:34:55.186 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=5m18s81ms).
24-06-20.20:34:55.186 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=5m18s80ms).
24-06-20.20:34:55.207 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.20:34:55.207 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:34:55.207 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.20:34:55.207 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:34:55.207 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.20:34:55.207 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:34:55.208 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Client requested disconnect from node 2147483646
24-06-20.20:34:55.209 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Client requested disconnect from node 2147483646
24-06-20.20:34:55.209 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Client requested disconnect from node 2147483646
24-06-20.20:34:55.212 [RMI TCP Accept-0] WARN  tcp                    - RMI TCP Accept-0: accept loop for ServerSocket[addr=0.0.0.0/0.0.0.0,localport=51641] throws
java.io.IOException: The server sockets created using the LocalRMIServerSocketFactory only accept connections from clients running on the host where the RMI remote objects have been exported.
	at sun.management.jmxremote.LocalRMIServerSocketFactory$1.accept(LocalRMIServerSocketFactory.java:114)
	at sun.rmi.transport.tcp.TCPTransport$AcceptLoop.executeAcceptLoop(TCPTransport.java:405)
	at sun.rmi.transport.tcp.TCPTransport$AcceptLoop.run(TCPTransport.java:377)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.20:34:55.213 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-20.20:34:55.213 [http-nio-8091-exec-3] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":7},{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":7}]
24-06-20.20:34:55.213 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-20.20:34:55.214 [RMI TCP Accept-0] WARN  tcp                    - RMI TCP Accept-0: accept loop for ServerSocket[addr=0.0.0.0/0.0.0.0,localport=51641] throws
java.io.IOException: The server sockets created using the LocalRMIServerSocketFactory only accept connections from clients running on the host where the RMI remote objects have been exported.
	at sun.management.jmxremote.LocalRMIServerSocketFactory$1.accept(LocalRMIServerSocketFactory.java:114)
	at sun.rmi.transport.tcp.TCPTransport$AcceptLoop.executeAcceptLoop(TCPTransport.java:405)
	at sun.rmi.transport.tcp.TCPTransport$AcceptLoop.run(TCPTransport.java:377)
	at java.lang.Thread.run(Thread.java:750)
24-06-20.20:34:55.220 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:34:55.220 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:34:55.220 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:34:55.221 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:34:55.221 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:34:55.221 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:34:55.221 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.20:34:55.221 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:34:55.221 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.20:34:55.221 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:34:55.221 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:34:55.222 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.20:34:55.222 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:34:55.408 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:34:55.410 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:34:55.411 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-20.20:34:55.411 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-20.20:34:55.421 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:34:55.440 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Attempt to heartbeat with Generation{generationId=325, memberId='consumer-sku-clear-group-3-f766b473-9c74-4d90-bf85-cc3a37dcbe36', protocol='range'} and group instance id Optional.empty failed due to UNKNOWN_MEMBER_ID, resetting generation
24-06-20.20:34:55.440 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: encountered UNKNOWN_MEMBER_ID from HEARTBEAT response
24-06-20.20:34:55.441 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: encountered UNKNOWN_MEMBER_ID from HEARTBEAT response
24-06-20.20:34:55.461 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=87, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.20:34:55.461 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.20:34:55.461 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-20.20:34:55.462 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Giving away all assigned partitions as lost since generation has been reset,indicating that consumer is no longer part of the group
24-06-20.20:34:55.462 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Lost previously assigned partitions sku-clear-topic-0
24-06-20.20:34:55.462 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions lost: [sku-clear-topic-0]
24-06-20.20:34:55.462 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-20.20:34:55.462 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.20:34:55.465 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Setting offset for partition send-rebate-topic-0 to the committed offset FetchPosition{offset=12, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.20:34:55.466 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Attempt to heartbeat with Generation{generationId=323, memberId='consumer-sku-deduct-group-2-bbda1102-196e-4b64-9966-3a9b51b8d8c3', protocol='range'} and group instance id Optional.empty failed due to UNKNOWN_MEMBER_ID, resetting generation
24-06-20.20:34:55.466 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: encountered UNKNOWN_MEMBER_ID from HEARTBEAT response
24-06-20.20:34:55.466 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: encountered UNKNOWN_MEMBER_ID from HEARTBEAT response
24-06-20.20:34:55.466 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-20.20:34:55.466 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Giving away all assigned partitions as lost since generation has been reset,indicating that consumer is no longer part of the group
24-06-20.20:34:55.466 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Lost previously assigned partitions sku-deduct-topic-0
24-06-20.20:34:55.466 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions lost: [sku-deduct-topic-0]
24-06-20.20:34:55.466 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-20.20:34:55.466 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.20:34:55.467 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-20.20:34:55.467 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.20:34:55.470 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-20.20:34:55.470 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Attempt to heartbeat with Generation{generationId=71, memberId='consumer-send-rebate-group-1-b19b146c-4629-4d14-a9da-847aa4af96fc', protocol='range'} and group instance id Optional.empty failed due to UNKNOWN_MEMBER_ID, resetting generation
24-06-20.20:34:55.470 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: encountered UNKNOWN_MEMBER_ID from HEARTBEAT response
24-06-20.20:34:55.470 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: encountered UNKNOWN_MEMBER_ID from HEARTBEAT response
24-06-20.20:34:55.470 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.20:34:55.470 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-20.20:34:55.470 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Giving away all assigned partitions as lost since generation has been reset,indicating that consumer is no longer part of the group
24-06-20.20:34:55.470 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Lost previously assigned partitions send-rebate-topic-0
24-06-20.20:34:55.470 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions lost: [send-rebate-topic-0]
24-06-20.20:34:55.470 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-20.20:34:55.470 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.20:34:55.471 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-20.20:34:55.471 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.20:34:56.398 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-a75ce17b-e3b5-4b50-b0df-1f687ab142eb sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.20:34:56.397 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-485d59af-e7d2-4fc7-b655-b8271bd69b5c sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.20:34:56.398 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-a8e1fc0c-1eba-4e82-94de-f2f09fa484e2 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.20:34:56.404 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.20:34:56.404 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.20:34:56.404 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.20:34:56.404 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.20:34:56.404 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.20:34:56.404 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.20:34:56.404 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.20:34:56.404 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.20:34:56.404 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.20:34:56.411 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.20:34:56.411 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.20:34:56.413 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.20:34:56.413 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.20:34:56.416 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.20:34:56.416 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.20:34:58.513 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.20:34:58.513 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.20:34:58.513 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.20:34:58.514 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.20:34:58.514 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.20:34:58.514 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.20:34:58.514 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.20:34:58.514 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.20:34:58.514 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.20:34:58.522 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-20.20:34:58.523 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-20.20:34:58.523 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-20.20:34:58.523 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-20.20:34:58.524 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-20.20:34:58.524 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-20.20:35:04.765 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 33053 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-20.20:35:04.766 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-20.20:35:05.385 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-20.20:35:05.387 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-20.20:35:05.406 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 12 ms. Found 0 Redis repository interfaces.
24-06-20.20:35:05.933 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-20.20:35:05.938 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-20.20:35:05.938 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-20.20:35:05.938 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-20.20:35:05.984 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-20.20:35:05.984 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1197 ms
24-06-20.20:35:06.428 [main            ] INFO  Version                - Redisson 3.26.0
24-06-20.20:35:06.446 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-20.20:35:06.528 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.20:35:06.536 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-20.20:35:07.218 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-20.20:35:07.276 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.20:35:07.309 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.20:35:07.309 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.20:35:07.309 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718886907309
24-06-20.20:35:07.317 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-20.20:35:07.324 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.20:35:07.327 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.20:35:07.327 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.20:35:07.327 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718886907327
24-06-20.20:35:07.330 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-20.20:35:07.331 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-20.20:35:07.334 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.20:35:07.335 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.20:35:07.335 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718886907334
24-06-20.20:35:07.337 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-20.20:35:07.337 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
24-06-20.20:35:07.344 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-20.20:35:07.353 [main            ] INFO  Application            - Started Application in 2.961 seconds (JVM running for 3.46)
24-06-20.20:35:07.502 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-20.20:35:07.502 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-20.20:35:07.502 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-20.20:35:07.503 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.20:35:07.503 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.20:35:07.503 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.20:35:07.505 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:35:07.505 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:35:07.505 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:35:07.509 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.20:35:07.509 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.20:35:07.509 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.20:35:07.532 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-20.20:35:07.532 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-20.20:35:07.532 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-20.20:35:07.532 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-20.20:35:07.532 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-20.20:35:07.532 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-20.20:35:07.775 [RMI TCP Connection(3)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
24-06-20.20:35:07.775 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
24-06-20.20:35:07.776 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 1 ms
24-06-20.20:35:07.793 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.20:35:08.087 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.20:35:08.098 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.20:35:08.116 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.20:35:10.548 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=327, memberId='consumer-sku-deduct-group-2-a82e432c-43be-40c9-a217-9fda1acc0da5', protocol='range'}
24-06-20.20:35:10.549 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=329, memberId='consumer-sku-clear-group-3-2f4fa063-1bcd-4ad8-b53d-7fb5c9e5a665', protocol='range'}
24-06-20.20:35:10.549 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=75, memberId='consumer-send-rebate-group-1-d40ccc8c-6e32-4df1-be0f-e7734d754993', protocol='range'}
24-06-20.20:35:10.553 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 75: {consumer-send-rebate-group-1-d40ccc8c-6e32-4df1-be0f-e7734d754993=Assignment(partitions=[send-rebate-topic-0])}
24-06-20.20:35:10.553 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 327: {consumer-sku-deduct-group-2-a82e432c-43be-40c9-a217-9fda1acc0da5=Assignment(partitions=[sku-deduct-topic-0])}
24-06-20.20:35:10.553 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 329: {consumer-sku-clear-group-3-2f4fa063-1bcd-4ad8-b53d-7fb5c9e5a665=Assignment(partitions=[sku-clear-topic-0])}
24-06-20.20:35:10.569 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=329, memberId='consumer-sku-clear-group-3-2f4fa063-1bcd-4ad8-b53d-7fb5c9e5a665', protocol='range'}
24-06-20.20:35:10.569 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=75, memberId='consumer-send-rebate-group-1-d40ccc8c-6e32-4df1-be0f-e7734d754993', protocol='range'}
24-06-20.20:35:10.569 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=327, memberId='consumer-sku-deduct-group-2-a82e432c-43be-40c9-a217-9fda1acc0da5', protocol='range'}
24-06-20.20:35:10.570 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-20.20:35:10.570 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-20.20:35:10.570 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-20.20:35:10.573 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-20.20:35:10.573 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-20.20:35:10.573 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-20.20:35:10.590 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=87, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.20:35:10.590 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Setting offset for partition send-rebate-topic-0 to the committed offset FetchPosition{offset=12, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.20:35:10.590 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-20.20:35:10.591 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-20.20:35:10.591 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-20.20:35:10.592 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-20.20:35:12.506 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:35:12.552 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-20.20:35:12.592 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-20.20:35:12.679 [http-nio-8091-exec-2] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":7},{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":7}]
24-06-20.20:35:20.695 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:35:20.695 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:35:20.699 [http-nio-8091-exec-9] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:35:20.699 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:35:20.705 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:35:20.705 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:35:20.731 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:35:20.738 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:35:20.744 [http-nio-8091-exec-5] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:35:20.749 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:35:20.785 [http-nio-8091-exec-10] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9993,"monthCount":100004,"monthCountSurplus":97692,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:35:20.790 [http-nio-8091-exec-9] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9993,"monthCount":100004,"monthCountSurplus":97692,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:35:20.795 [http-nio-8091-exec-8] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":7},{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":7}]
24-06-20.20:35:20.802 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:35:20.805 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:35:20.820 [http-nio-8091-exec-7] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":7},{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":7}]
24-06-20.20:39:23.915 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:39:23.914 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:39:23.931 [http-nio-8091-exec-10] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:39:23.931 [http-nio-8091-exec-9] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:39:23.945 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:39:23.945 [http-nio-8091-exec-2] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:39:23.960 [http-nio-8091-exec-2] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:39:23.960 [http-nio-8091-exec-5] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:39:23.968 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:39:23.969 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:39:23.971 [http-nio-8091-exec-10] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9993,"monthCount":100004,"monthCountSurplus":97692,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:39:23.971 [http-nio-8091-exec-9] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9993,"monthCount":100004,"monthCountSurplus":97692,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:39:23.975 [http-nio-8091-exec-7] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:39:23.980 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:39:23.993 [http-nio-8091-exec-5] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":7},{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":7}]
24-06-20.20:39:23.995 [http-nio-8091-exec-3] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":7},{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":7}]
24-06-20.20:40:11.655 [http-nio-8091-exec-7] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:40:11.655 [http-nio-8091-exec-6] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:40:11.677 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:40:11.677 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询今日是否签到 userId:matthew
24-06-20.20:40:11.678 [http-nio-8091-exec-1] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:40:11.678 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:40:11.708 [http-nio-8091-exec-5] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:40:11.711 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询今日是否签到完成 userId:matthew
24-06-20.20:40:11.712 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:40:11.715 [http-nio-8091-exec-6] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:40:11.715 [http-nio-8091-exec-8] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:40:11.719 [http-nio-8091-exec-7] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:40:11.722 [http-nio-8091-exec-1] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9993,"monthCount":100004,"monthCountSurplus":97692,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:40:11.724 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9993,"monthCount":100004,"monthCountSurplus":97692,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:40:11.732 [http-nio-8091-exec-5] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":7},{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":7}]
24-06-20.20:40:11.735 [http-nio-8091-exec-8] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":7},{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":7}]
24-06-20.20:40:18.026 [http-nio-8091-exec-1] INFO  RaffleActivityController - 活动抽奖 userId:matthew activityId:100001
24-06-20.20:40:18.088 [http-nio-8091-exec-1] INFO  RaffleActivityPartakeServiceService - orderId是：1253449371324776448
24-06-20.20:40:18.135 [http-nio-8091-exec-1] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:matthew activityId:100001 orderId:1253449371324776448
24-06-20.20:40:18.151 [http-nio-8091-exec-1] INFO  DefaultChainFilter     - 抽奖责任链-默认处理 userId: matthew strategyId: 100006 ruleModel: rule_default awardId: 101
24-06-20.20:40:18.152 [http-nio-8091-exec-1] INFO  AbstractRaffleStrategy - 完成责任链流程: userId: matthew strategyId: 100006 awardId: 101 规则: rule_default
24-06-20.20:40:18.172 [http-nio-8091-exec-1] INFO  DecisionTreeEngine     - 进入决策树处理, userId:matthew, strategyId:100006, awardId:101
24-06-20.20:40:18.172 [http-nio-8091-exec-1] INFO  RuleStockTreeNode      - 规则过滤-库存节点, userId: matthew strategy: 100006 award: 101
24-06-20.20:40:18.175 [http-nio-8091-exec-1] INFO  RuleStockTreeNode      - 规则过滤-库存扣减-成功 userId:matthew strategyId:100006 awardId:101
24-06-20.20:40:18.197 [http-nio-8091-exec-1] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:RuleTreeNodeVO(treeId=tree_luck_award, ruleKey=rule_stock, ruleDesc=库存扣减规则, ruleValue=null, treeNodeLineVOList=[RuleTreeNodeLineVO(treeId=tree_luck_award, ruleNodeFrom=rule_stock, ruleNodeTo=rule_luck_award, ruleLimitType=EQUAL, ruleLimitValue=ALLOW)]) code:0001
24-06-20.20:40:18.198 [http-nio-8091-exec-1] INFO  AbstractRaffleStrategy - 完成规则树流程: userId: matthew strategyId: 100006 awardId: 101 规则: null
24-06-20.20:40:18.230 [http-nio-8091-exec-1] INFO  ProducerConfig         - Idempotence will be disabled because acks is set to 1, not set to 'all'.
24-06-20.20:40:18.231 [http-nio-8091-exec-1] INFO  ProducerConfig         - ProducerConfig values: 
	acks = 1
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-1
	compression.type = none
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = false
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.class = class org.apache.kafka.clients.producer.internals.DefaultPartitioner
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 1
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

24-06-20.20:40:18.242 [http-nio-8091-exec-1] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-20.20:40:18.242 [http-nio-8091-exec-1] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-20.20:40:18.243 [http-nio-8091-exec-1] INFO  AppInfoParser          - Kafka startTimeMs: 1718887218242
24-06-20.20:40:18.247 [kafka-producer-network-thread | producer-1] INFO  Metadata               - [Producer clientId=producer-1] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-20.20:40:18.264 [kafka-producer-network-thread | producer-1] INFO  Metadata               - [Producer clientId=producer-1] Resetting the last seen epoch of partition send-award-topic-0 to 0 since the associated topicId changed from null to 7B2TfuZETI-OeTtx5TJ86g
24-06-20.20:40:18.273 [http-nio-8091-exec-1] INFO  EventPublisher         - 发送MQ消息 topic:send-award-topic message:{"data":{"awardId":101,"awardTitle":"随机积分","userId":"matthew"},"id":"27725318371","timestamp":1718887218203}
24-06-20.20:40:18.293 [http-nio-8091-exec-4] INFO  RaffleActivityController - 开始查询用户活动账户额度信息，userId:matthew, activityId:100001
24-06-20.20:40:18.293 [http-nio-8091-exec-5] INFO  RaffleActivityController - 开始查询权重配置 userId:matthew activityId:100001
24-06-20.20:40:18.299 [http-nio-8091-exec-4] INFO  RaffleActivityController - 查询用户活动账户额度信息完成 useId:matthew activityId:100001 responseDto:{"dayCount":10000,"dayCountSurplus":9992,"monthCount":100004,"monthCountSurplus":97691,"totalCount":10000,"totalCountSurplus":10000}
24-06-20.20:40:18.300 [http-nio-8091-exec-5] INFO  RaffleActivityController - 完成规则权重查询，userId:matthew activityId:100001 raffleStrategyRuleWeightResponseDTO:[{"awardList":[{"awardId":101,"awardTitle":"随机积分"},{"awardId":102,"awardTitle":"OpenAI会员卡"},{"awardId":103,"awardTitle":"支付优惠券"}],"ruleWeightCount":50,"userUsedCount":8},{"awardList":[{"awardId":107,"awardTitle":"小霸王游戏机"},{"awardId":108,"awardTitle":"暴走玩偶"}],"ruleWeightCount":500,"userUsedCount":8}]
24-06-20.20:40:20.835 [http-nio-8091-exec-3] INFO  RaffleActivityController - 开始查询奖品列表，活动ID为:100001, 用户ID为：matthew
24-06-20.20:40:20.857 [http-nio-8091-exec-3] INFO  RaffleActivityController - 查询抽奖奖品列表配置完成 userId:matthew activityId：100001 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"成功"}
24-06-20.20:43:07.691 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=54s933ms).
24-06-20.20:43:33.193 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=54s933ms).
24-06-20.20:43:33.214 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=54s931ms).
24-06-20.20:55:52.294 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.20:55:52.294 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:55:52.295 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.20:55:52.295 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:55:52.294 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.20:55:52.295 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:55:52.355 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Client requested disconnect from node 2147483646
24-06-20.20:55:52.355 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Client requested disconnect from node 2147483646
24-06-20.20:55:52.355 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Client requested disconnect from node 2147483646
24-06-20.20:55:52.372 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:55:52.372 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:55:52.372 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:55:52.372 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:55:52.372 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:55:52.372 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:55:52.372 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:55:52.372 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:55:52.372 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.20:55:52.372 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:55:52.372 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.20:55:52.372 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:55:52.372 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:55:52.372 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.20:55:52.373 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:55:52.477 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:55:52.843 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:55:52.844 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.20:56:02.873 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=12m29s679ms).
24-06-20.20:56:02.890 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=12m29s676ms).
24-06-20.20:56:07.373 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=12m29s673ms).
24-06-20.20:56:32.305 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Node -1 disconnected.
24-06-20.20:56:32.305 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Node -1 disconnected.
24-06-20.20:56:32.305 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Node -1 disconnected.
24-06-20.21:12:56.250 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.21:12:56.251 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:12:56.251 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Client requested disconnect from node 2147483646
24-06-20.21:12:56.252 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.21:12:56.252 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:12:56.252 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Client requested disconnect from node 2147483646
24-06-20.21:12:56.250 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.21:12:56.253 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:12:56.253 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Client requested disconnect from node 2147483646
24-06-20.21:12:56.294 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:12:56.297 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:12:56.304 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:12:56.308 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:12:56.308 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:12:56.312 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:12:57.920 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=15m55s29ms).
24-06-20.21:12:57.929 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=15m55s28ms).
24-06-20.21:13:02.419 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=15m55s35ms).
24-06-20.21:30:25.154 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.21:30:25.154 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.21:30:25.154 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.21:30:25.154 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:30:25.154 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:30:25.154 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Client requested disconnect from node 2147483646
24-06-20.21:30:25.154 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Client requested disconnect from node 2147483646
24-06-20.21:30:25.154 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:30:25.154 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Client requested disconnect from node 2147483646
24-06-20.21:30:25.156 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:30:25.156 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:30:25.156 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:30:25.156 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:30:25.156 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:30:25.156 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:30:25.156 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.21:30:25.156 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:30:25.156 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.21:30:25.157 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:30:25.157 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.21:30:25.157 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:30:25.260 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:30:25.260 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:30:25.267 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:30:27.447 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=15m55s18ms).
24-06-20.21:30:52.950 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=15m55s9ms).
24-06-20.21:30:52.950 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=15m55s11ms).
24-06-20.21:36:38.933 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Disconnecting from node 1 due to request timeout.
24-06-20.21:36:38.934 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cancelled in-flight FETCH request with correlation id 1833 due to node 1 being disconnected (elapsed time since creation: 311127ms, elapsed time since send: 311127ms, request timeout: 30000ms)
24-06-20.21:36:38.936 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.21:36:38.936 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.21:36:38.936 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:36:38.936 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:36:38.936 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Client requested disconnect from node 2147483646
24-06-20.21:36:38.936 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Client requested disconnect from node 2147483646
24-06-20.21:36:38.938 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.21:36:38.938 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:36:38.938 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Client requested disconnect from node 2147483646
24-06-20.21:36:38.939 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:36:38.940 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:36:38.940 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:36:38.940 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.21:36:38.940 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:36:38.940 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:36:38.940 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.21:36:38.940 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:36:38.994 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  FetchSessionHandler    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Error sending fetch request (sessionId=933762182, epoch=1546) to node 1:
org.apache.kafka.common.errors.DisconnectException: null
24-06-20.21:36:39.050 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:36:39.050 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:36:39.467 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:36:39.467 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:37:03.378 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=5m40s427ms).
24-06-20.21:37:03.378 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=5m40s427ms).
24-06-20.21:37:07.869 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=5m40s428ms).
24-06-20.21:37:43.369 [kafka-producer-network-thread | producer-1] INFO  NetworkClient          - [Producer clientId=producer-1] Node -1 disconnected.
24-06-20.21:41:47.878 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Disconnecting from node 1 due to request timeout.
24-06-20.21:41:47.878 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Disconnecting from node 1 due to request timeout.
24-06-20.21:41:47.879 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cancelled in-flight FETCH request with correlation id 2026 due to node 1 being disconnected (elapsed time since creation: 227843ms, elapsed time since send: 227843ms, request timeout: 30000ms)
24-06-20.21:41:47.879 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cancelled in-flight FETCH request with correlation id 2026 due to node 1 being disconnected (elapsed time since creation: 227844ms, elapsed time since send: 227844ms, request timeout: 30000ms)
24-06-20.21:41:47.879 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.21:41:47.879 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  FetchSessionHandler    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Error sending fetch request (sessionId=444279829, epoch=1706) to node 1:
org.apache.kafka.common.errors.DisconnectException: null
24-06-20.21:41:47.879 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:41:47.879 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Client requested disconnect from node 2147483646
24-06-20.21:41:47.879 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.21:41:47.879 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  FetchSessionHandler    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Error sending fetch request (sessionId=1529744389, epoch=1706) to node 1:
org.apache.kafka.common.errors.DisconnectException: null
24-06-20.21:41:47.879 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:41:47.879 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Client requested disconnect from node 2147483646
24-06-20.21:41:48.205 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Disconnecting from node 1 due to request timeout.
24-06-20.21:41:48.206 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cancelled in-flight FETCH request with correlation id 2024 due to node 1 being disconnected (elapsed time since creation: 227945ms, elapsed time since send: 227945ms, request timeout: 30000ms)
24-06-20.21:41:48.207 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  FetchSessionHandler    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Error sending fetch request (sessionId=1243947447, epoch=158) to node 1:
org.apache.kafka.common.errors.DisconnectException: null
24-06-20.21:41:48.217 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.21:41:48.218 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:41:48.219 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Client requested disconnect from node 2147483646
24-06-20.21:41:48.296 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:41:48.296 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:41:48.296 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:41:48.296 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:41:48.297 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:41:48.297 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:41:50.807 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=4m17s421ms).
24-06-20.21:41:50.807 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=4m17s422ms).
24-06-20.21:41:55.288 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=4m17s417ms).
24-06-20.21:59:08.643 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.21:59:08.643 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.21:59:08.643 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.21:59:08.643 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:59:08.643 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:59:08.643 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:59:08.643 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Client requested disconnect from node 2147483646
24-06-20.21:59:08.643 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Client requested disconnect from node 2147483646
24-06-20.21:59:08.643 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Client requested disconnect from node 2147483646
24-06-20.21:59:08.645 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:59:08.645 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:59:08.645 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:59:08.645 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:59:08.645 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:59:08.645 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.21:59:08.645 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:59:08.645 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.21:59:08.645 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:59:08.645 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:59:08.645 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:59:08.645 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.21:59:08.645 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:59:08.748 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:59:08.748 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:59:08.750 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.21:59:15.828 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=15m55s).
24-06-20.21:59:15.830 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=15m54s998ms).
24-06-20.21:59:20.294 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=15m55s).
24-06-20.22:15:20.675 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.22:15:20.675 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.22:15:20.675 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.22:15:20.676 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:15:20.676 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:15:20.676 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:15:20.676 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Client requested disconnect from node 2147483646
24-06-20.22:15:20.676 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Client requested disconnect from node 2147483646
24-06-20.22:15:20.676 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Client requested disconnect from node 2147483646
24-06-20.22:15:20.677 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:15:20.677 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:15:20.677 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:15:20.677 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:15:20.677 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:15:20.677 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:15:20.677 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.22:15:20.677 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.22:15:20.677 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:15:20.677 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.22:15:20.678 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:15:20.678 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:15:20.782 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:15:20.792 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:15:20.800 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:15:40.797 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=15m54s977ms).
24-06-20.22:15:40.802 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=15m54s974ms).
24-06-20.22:15:45.262 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=15m54s976ms).
24-06-20.22:33:18.186 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.22:33:18.186 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.22:33:18.186 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:33:18.186 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:33:18.186 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Client requested disconnect from node 2147483646
24-06-20.22:33:18.186 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.22:33:18.186 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:33:18.186 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Client requested disconnect from node 2147483646
24-06-20.22:33:18.186 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Client requested disconnect from node 2147483646
24-06-20.22:33:18.188 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:33:18.188 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:33:18.188 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:33:18.188 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:33:18.188 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:33:18.188 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.22:33:18.188 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:33:18.188 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:33:18.188 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.22:33:18.188 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:33:18.188 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: coordinator unavailable.isDisconnected: false. Rediscovery will be attempted.
24-06-20.22:33:18.188 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:33:18.298 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:33:18.298 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:33:18.298 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:33:35.822 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=15m55s12ms).
24-06-20.22:33:35.822 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=15m55s11ms).
24-06-20.22:33:40.300 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=15m55s20ms).
24-06-20.22:37:28.904 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Disconnecting from node 1 due to request timeout.
24-06-20.22:37:28.905 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Disconnecting from node 1 due to request timeout.
24-06-20.22:37:28.905 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Disconnecting from node 1 due to request timeout.
24-06-20.22:37:28.907 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cancelled in-flight FETCH request with correlation id 2892 due to node 1 being disconnected (elapsed time since creation: 200167ms, elapsed time since send: 200167ms, request timeout: 30000ms)
24-06-20.22:37:28.907 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cancelled in-flight FETCH request with correlation id 2893 due to node 1 being disconnected (elapsed time since creation: 200168ms, elapsed time since send: 200168ms, request timeout: 30000ms)
24-06-20.22:37:28.909 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cancelled in-flight FETCH request with correlation id 2893 due to node 1 being disconnected (elapsed time since creation: 200167ms, elapsed time since send: 200167ms, request timeout: 30000ms)
24-06-20.22:37:28.911 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.22:37:28.911 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:37:28.911 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.22:37:28.911 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Client requested disconnect from node 2147483646
24-06-20.22:37:28.911 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-20.22:37:28.912 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:37:28.911 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:37:28.912 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Client requested disconnect from node 2147483646
24-06-20.22:37:28.912 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Client requested disconnect from node 2147483646
24-06-20.22:37:28.912 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  FetchSessionHandler    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Error sending fetch request (sessionId=577874458, epoch=723) to node 1:
org.apache.kafka.common.errors.DisconnectException: null
24-06-20.22:37:28.912 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  FetchSessionHandler    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Error sending fetch request (sessionId=2073909021, epoch=723) to node 1:
org.apache.kafka.common.errors.DisconnectException: null
24-06-20.22:37:28.913 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  FetchSessionHandler    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Error sending fetch request (sessionId=287919762, epoch=723) to node 1:
org.apache.kafka.common.errors.DisconnectException: null
24-06-20.22:37:29.682 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:37:29.682 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:37:29.681 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-20.22:37:29.732 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=3m49s432ms).
24-06-20.22:37:55.258 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=3m49s429ms).
24-06-20.22:37:55.261 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=3m49s429ms).
24-06-20.22:39:45.013 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Revoke previously assigned partitions sku-deduct-topic-0
24-06-20.22:39:45.014 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Revoke previously assigned partitions sku-clear-topic-0
24-06-20.22:39:45.014 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Revoke previously assigned partitions send-rebate-topic-0
24-06-20.22:39:45.014 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-20.22:39:45.014 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-20.22:39:45.014 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-20.22:39:45.015 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-d40ccc8c-6e32-4df1-be0f-e7734d754993 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.22:39:45.015 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-a82e432c-43be-40c9-a217-9fda1acc0da5 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.22:39:45.015 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-2f4fa063-1bcd-4ad8-b53d-7fb5c9e5a665 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-20.22:39:45.017 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.22:39:45.018 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.22:39:45.018 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.22:39:45.018 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.22:39:45.018 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.22:39:45.018 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.22:39:45.017 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.22:39:45.018 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.22:39:45.018 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-20.22:39:45.022 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.22:39:45.022 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.22:39:45.022 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.22:39:45.022 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.22:39:45.029 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-20.22:39:45.029 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-20.22:39:45.032 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.22:39:45.032 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.22:39:45.032 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.22:39:45.032 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.22:39:45.032 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.22:39:45.032 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.22:39:45.032 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-20.22:39:45.032 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.22:39:45.032 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-20.22:39:45.041 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-20.22:39:45.041 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-20.22:39:45.042 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-20.22:39:45.042 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-20.22:39:45.043 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-20.22:39:45.043 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-20.22:39:45.060 [SpringApplicationShutdownHook] INFO  KafkaProducer          - [Producer clientId=producer-1] Closing the Kafka producer with timeoutMillis = 30000 ms.
24-06-20.22:39:45.063 [SpringApplicationShutdownHook] INFO  Metrics                - Metrics scheduler closed
24-06-20.22:39:45.063 [SpringApplicationShutdownHook] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-20.22:39:45.063 [SpringApplicationShutdownHook] INFO  Metrics                - Metrics reporters closed
24-06-20.22:39:45.063 [SpringApplicationShutdownHook] INFO  AppInfoParser          - App info kafka.producer for producer-1 unregistered

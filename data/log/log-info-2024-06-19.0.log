24-06-18.14:54:58.418 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 27358 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-18.14:54:58.419 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-18.14:54:58.931 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-18.14:54:58.932 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-18.14:54:58.952 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 12 ms. Found 0 Redis repository interfaces.
24-06-18.14:54:59.354 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-18.14:54:59.357 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-18.14:54:59.358 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-18.14:54:59.358 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-18.14:54:59.401 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-18.14:54:59.401 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 958 ms
24-06-18.14:54:59.741 [main            ] INFO  Version                - Redisson 3.26.0
24-06-18.14:54:59.756 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-18.14:54:59.830 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-18.14:54:59.838 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-18.14:54:59.957 [main            ] WARN  AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'raffleActivityController': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type 'cn.matthew.domain.rebate.service.IBehaviorRebateService' available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {@javax.annotation.Resource(shareable=true, lookup=, name=, description=, authenticationType=CONTAINER, type=class java.lang.Object, mappedName=)}
24-06-18.14:54:59.970 [main            ] INFO  StandardService        - Stopping service [Tomcat]
24-06-18.14:54:59.980 [main            ] INFO  ConditionEvaluationReportLoggingListener - 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
24-06-18.14:55:00.000 [main            ] ERROR LoggingFailureAnalysisReporter - 

***************************
APPLICATION FAILED TO START
***************************

Description:

A component required a bean of type 'cn.matthew.domain.rebate.service.IBehaviorRebateService' that could not be found.


Action:

Consider defining a bean of type 'cn.matthew.domain.rebate.service.IBehaviorRebateService' in your configuration.

24-06-18.14:55:42.747 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 27477 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-18.14:55:42.748 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-18.14:55:43.331 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-18.14:55:43.332 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-18.14:55:43.351 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 11 ms. Found 0 Redis repository interfaces.
24-06-18.14:55:43.793 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-18.14:55:43.798 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-18.14:55:43.798 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-18.14:55:43.798 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-18.14:55:43.847 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-18.14:55:43.847 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1076 ms
24-06-18.14:55:44.216 [main            ] INFO  Version                - Redisson 3.26.0
24-06-18.14:55:44.231 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-18.14:55:44.316 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-18.14:55:44.322 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-18.14:55:44.442 [main            ] WARN  AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'raffleActivityController': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'behaviorRebateService': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type 'cn.matthew.domain.rebate.repository.IRebateRepository' available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {@javax.annotation.Resource(shareable=true, lookup=, name=, description=, authenticationType=CONTAINER, type=class java.lang.Object, mappedName=)}
24-06-18.14:55:44.462 [main            ] INFO  StandardService        - Stopping service [Tomcat]
24-06-18.14:55:44.471 [main            ] INFO  ConditionEvaluationReportLoggingListener - 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
24-06-18.14:55:44.482 [main            ] ERROR LoggingFailureAnalysisReporter - 

***************************
APPLICATION FAILED TO START
***************************

Description:

A component required a bean of type 'cn.matthew.domain.rebate.repository.IRebateRepository' that could not be found.


Action:

Consider defining a bean of type 'cn.matthew.domain.rebate.repository.IRebateRepository' in your configuration.

24-06-18.14:56:37.783 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 27625 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-18.14:56:37.784 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-18.14:56:38.271 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-18.14:56:38.272 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-18.14:56:38.290 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 10 ms. Found 0 Redis repository interfaces.
24-06-18.14:56:38.684 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-18.14:56:38.688 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-18.14:56:38.688 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-18.14:56:38.688 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-18.14:56:38.737 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-18.14:56:38.737 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 934 ms
24-06-18.14:56:39.092 [main            ] INFO  Version                - Redisson 3.26.0
24-06-18.14:56:39.107 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-18.14:56:39.181 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-18.14:56:39.189 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-18.14:56:39.766 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-18.14:56:39.913 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-18.14:56:39.948 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-18.14:56:39.948 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-18.14:56:39.948 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718693799947
24-06-18.14:56:39.955 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-18.14:56:39.962 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-18.14:56:39.966 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-18.14:56:39.966 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-18.14:56:39.966 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718693799966
24-06-18.14:56:39.969 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-18.14:56:39.970 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-18.14:56:39.974 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-18.14:56:39.974 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-18.14:56:39.974 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718693799974
24-06-18.14:56:39.977 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-18.14:56:39.978 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
24-06-18.14:56:39.984 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-18.14:56:39.998 [main            ] INFO  Application            - Started Application in 2.42 seconds (JVM running for 2.69)
24-06-18.14:56:40.214 [RMI TCP Connection(3)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
24-06-18.14:56:40.214 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
24-06-18.14:56:40.215 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-18.14:56:40.215 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 1 ms
24-06-18.14:56:40.440 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-18.14:56:40.442 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-18.14:56:40.442 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-18.14:56:40.443 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-18.14:56:40.444 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.14:56:40.444 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.14:56:40.462 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-18.14:56:40.466 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-18.14:56:40.495 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-18.14:56:40.495 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-18.14:56:40.496 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-18.14:56:40.496 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-18.14:56:40.613 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-18.14:56:40.624 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-18.14:56:40.665 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-18.14:56:40.818 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] WARN  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Error while fetching metadata with correlation id 2 : {send-rebate-topic=LEADER_NOT_AVAILABLE}
24-06-18.14:56:40.819 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-18.14:56:40.819 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.14:56:40.821 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-18.14:56:40.827 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-18.14:56:40.828 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-18.14:56:40.933 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] WARN  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Error while fetching metadata with correlation id 7 : {send-rebate-topic=LEADER_NOT_AVAILABLE}
24-06-18.14:56:41.036 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-18.14:56:43.516 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=249, memberId='consumer-sku-deduct-group-2-034e2a88-bbe8-4007-afe1-44a2c1c2dbe0', protocol='range'}
24-06-18.14:56:43.516 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=251, memberId='consumer-sku-clear-group-3-ce89b74f-c576-469a-a2bf-ac824fe750b1', protocol='range'}
24-06-18.14:56:43.522 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 251: {consumer-sku-clear-group-3-ce89b74f-c576-469a-a2bf-ac824fe750b1=Assignment(partitions=[sku-clear-topic-0])}
24-06-18.14:56:43.522 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 249: {consumer-sku-deduct-group-2-034e2a88-bbe8-4007-afe1-44a2c1c2dbe0=Assignment(partitions=[sku-deduct-topic-0])}
24-06-18.14:56:43.540 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=249, memberId='consumer-sku-deduct-group-2-034e2a88-bbe8-4007-afe1-44a2c1c2dbe0', protocol='range'}
24-06-18.14:56:43.540 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=251, memberId='consumer-sku-clear-group-3-ce89b74f-c576-469a-a2bf-ac824fe750b1', protocol='range'}
24-06-18.14:56:43.541 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-18.14:56:43.541 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-18.14:56:43.545 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-18.14:56:43.545 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-18.14:56:43.560 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=80, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-18.14:56:43.560 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-18.14:56:43.560 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-18.14:56:43.560 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-18.14:56:43.831 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=1, memberId='consumer-send-rebate-group-1-3a15269c-ab9d-42c4-b692-b2c879cc26f6', protocol='range'}
24-06-18.14:56:43.831 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 1: {consumer-send-rebate-group-1-3a15269c-ab9d-42c4-b692-b2c879cc26f6=Assignment(partitions=[send-rebate-topic-0])}
24-06-18.14:56:43.835 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=1, memberId='consumer-send-rebate-group-1-3a15269c-ab9d-42c4-b692-b2c879cc26f6', protocol='range'}
24-06-18.14:56:43.835 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-18.14:56:43.836 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-18.14:56:43.838 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Found no committed offset for partition send-rebate-topic-0
24-06-18.14:56:43.850 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  SubscriptionState      - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting offset for partition send-rebate-topic-0 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}.
24-06-18.14:56:43.850 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-18.15:02:31.467 [http-nio-8091-exec-2] INFO  RaffleActivityController - 根据活动ID装配开始，活动ID为：100001
24-06-18.15:02:31.482 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-18.15:02:31.505 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-18.15:02:31.533 [http-nio-8091-exec-2] INFO  ActivityRepository     - 预热SKU缓存成功，SKU: 999 库存总量为: 1000000
24-06-18.15:02:31.591 [http-nio-8091-exec-2] INFO  RaffleActivityController - 根据活动ID装配完毕，活动ID为：100001
24-06-18.15:03:10.968 [http-nio-8091-exec-3] INFO  RaffleActivityController - 日历签到返利开始 userId:mattew
24-06-18.15:03:10.969 [http-nio-8091-exec-3] INFO  BehaviorRebateService  - 开始创建返利订单 userId:mattew 
24-06-18.15:03:11.035 [http-nio-8091-exec-3] ERROR RaffleActivityController - 日历签到返利失败 userId:mattew
24-06-18.15:03:39.530 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Revoke previously assigned partitions sku-clear-topic-0
24-06-18.15:03:39.530 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Revoke previously assigned partitions send-rebate-topic-0
24-06-18.15:03:39.530 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Revoke previously assigned partitions sku-deduct-topic-0
24-06-18.15:03:39.530 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-18.15:03:39.530 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-18.15:03:39.530 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-18.15:03:39.530 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-3a15269c-ab9d-42c4-b692-b2c879cc26f6 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-18.15:03:39.530 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-034e2a88-bbe8-4007-afe1-44a2c1c2dbe0 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-18.15:03:39.530 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-ce89b74f-c576-469a-a2bf-ac824fe750b1 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-18.15:03:39.533 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:03:39.533 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:03:39.533 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:03:39.533 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:03:39.533 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:03:39.533 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:03:39.533 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-18.15:03:39.533 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-18.15:03:39.533 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-18.15:03:39.534 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:03:39.534 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:03:39.534 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:03:39.534 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:03:39.535 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:03:39.535 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:03:39.554 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-18.15:03:39.554 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-18.15:03:39.554 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-18.15:03:39.554 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-18.15:03:39.554 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-18.15:03:39.554 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-18.15:03:39.554 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-18.15:03:39.554 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-18.15:03:39.554 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-18.15:03:39.564 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-18.15:03:39.564 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-18.15:03:39.564 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-18.15:03:39.565 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-18.15:03:39.565 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-18.15:03:39.565 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-18.15:03:42.244 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 28739 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-18.15:03:42.246 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-18.15:03:42.793 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-18.15:03:42.794 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-18.15:03:42.812 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 11 ms. Found 0 Redis repository interfaces.
24-06-18.15:03:43.215 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-18.15:03:43.219 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-18.15:03:43.220 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-18.15:03:43.220 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-18.15:03:43.266 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-18.15:03:43.266 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 990 ms
24-06-18.15:03:43.696 [main            ] INFO  Version                - Redisson 3.26.0
24-06-18.15:03:43.719 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-18.15:03:43.822 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-18.15:03:43.832 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-18.15:03:44.479 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-18.15:03:44.646 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-18.15:03:44.680 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-18.15:03:44.680 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-18.15:03:44.680 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718694224679
24-06-18.15:03:44.688 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-18.15:03:44.696 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-18.15:03:44.701 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-18.15:03:44.701 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-18.15:03:44.701 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718694224701
24-06-18.15:03:44.704 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-18.15:03:44.705 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-18.15:03:44.708 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-18.15:03:44.708 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-18.15:03:44.708 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718694224708
24-06-18.15:03:44.711 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-18.15:03:44.712 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
24-06-18.15:03:44.719 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-18.15:03:44.732 [main            ] INFO  Application            - Started Application in 2.779 seconds (JVM running for 3.641)
24-06-18.15:03:44.890 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-18.15:03:44.890 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-18.15:03:44.890 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-18.15:03:44.891 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-18.15:03:44.891 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-18.15:03:44.891 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-18.15:03:44.892 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.15:03:44.892 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.15:03:44.892 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.15:03:44.895 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-18.15:03:44.895 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-18.15:03:44.895 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-18.15:03:44.909 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-18.15:03:44.909 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-18.15:03:44.909 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-18.15:03:44.909 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-18.15:03:44.909 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-18.15:03:44.909 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-18.15:03:45.176 [RMI TCP Connection(3)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
24-06-18.15:03:45.176 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
24-06-18.15:03:45.178 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 2 ms
24-06-18.15:03:45.178 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-18.15:03:45.483 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-18.15:03:45.495 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-18.15:03:45.518 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-18.15:03:47.921 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=251, memberId='consumer-sku-deduct-group-2-695a0b14-f94f-4874-827e-774e57e3a205', protocol='range'}
24-06-18.15:03:47.921 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=3, memberId='consumer-send-rebate-group-1-a9de1dce-b9db-4130-806a-f717a375a413', protocol='range'}
24-06-18.15:03:47.921 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=253, memberId='consumer-sku-clear-group-3-096e2b41-b20a-4854-99d3-342c2684f7f2', protocol='range'}
24-06-18.15:03:47.927 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 3: {consumer-send-rebate-group-1-a9de1dce-b9db-4130-806a-f717a375a413=Assignment(partitions=[send-rebate-topic-0])}
24-06-18.15:03:47.927 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 251: {consumer-sku-deduct-group-2-695a0b14-f94f-4874-827e-774e57e3a205=Assignment(partitions=[sku-deduct-topic-0])}
24-06-18.15:03:47.927 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 253: {consumer-sku-clear-group-3-096e2b41-b20a-4854-99d3-342c2684f7f2=Assignment(partitions=[sku-clear-topic-0])}
24-06-18.15:03:47.943 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=3, memberId='consumer-send-rebate-group-1-a9de1dce-b9db-4130-806a-f717a375a413', protocol='range'}
24-06-18.15:03:47.943 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=251, memberId='consumer-sku-deduct-group-2-695a0b14-f94f-4874-827e-774e57e3a205', protocol='range'}
24-06-18.15:03:47.943 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=253, memberId='consumer-sku-clear-group-3-096e2b41-b20a-4854-99d3-342c2684f7f2', protocol='range'}
24-06-18.15:03:47.943 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-18.15:03:47.943 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-18.15:03:47.943 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-18.15:03:47.946 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-18.15:03:47.946 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-18.15:03:47.946 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-18.15:03:47.954 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Found no committed offset for partition send-rebate-topic-0
24-06-18.15:03:47.955 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=80, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-18.15:03:47.955 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-18.15:03:47.956 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-18.15:03:47.956 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-18.15:03:47.977 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  SubscriptionState      - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting offset for partition send-rebate-topic-0 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}.
24-06-18.15:03:47.977 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-18.15:03:54.841 [http-nio-8091-exec-2] INFO  RaffleActivityController - 日历签到返利开始 userId:matthew
24-06-18.15:03:56.327 [http-nio-8091-exec-2] INFO  BehaviorRebateService  - 开始创建返利订单 userId:matthew 
24-06-18.15:03:56.372 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-18.15:03:56.405 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-18.15:03:56.502 [http-nio-8091-exec-2] ERROR RaffleActivityController - 日历签到返利失败 userId:matthew
24-06-18.15:04:06.517 [http-nio-8091-exec-3] INFO  RaffleActivityController - 日历签到返利开始 userId:matthew
24-06-18.15:04:06.517 [http-nio-8091-exec-3] INFO  BehaviorRebateService  - 开始创建返利订单 userId:matthew 
24-06-18.15:04:06.537 [http-nio-8091-exec-3] ERROR RaffleActivityController - 日历签到返利失败 userId:matthew
24-06-18.15:04:21.912 [http-nio-8091-exec-4] INFO  RaffleActivityController - 日历签到返利开始 userId:matthew
24-06-18.15:05:11.108 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-18.15:05:11.108 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=1m14s594ms).
24-06-18.15:05:11.108 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-18.15:05:11.109 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.15:05:11.108 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Group coordinator kafka:9092 (id: 2147483646 rack: null) is unavailable or invalid due to cause: session timed out without receiving a heartbeat response.isDisconnected: false. Rediscovery will be attempted.
24-06-18.15:05:11.109 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.15:05:11.109 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Requesting disconnect from last known coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.15:05:11.108 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=55s514ms).
24-06-18.15:05:11.107 [http-nio-8091-exec-4] INFO  BehaviorRebateService  - 开始创建返利订单 userId:matthew 
24-06-18.15:05:21.697 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=55s482ms).
24-06-18.15:05:32.040 [kafka-coordinator-heartbeat-thread | sku-clear-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Client requested disconnect from node 2147483646
24-06-18.15:05:32.042 [kafka-coordinator-heartbeat-thread | sku-deduct-group] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Client requested disconnect from node 2147483646
24-06-18.15:05:32.047 [kafka-coordinator-heartbeat-thread | send-rebate-group] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Client requested disconnect from node 2147483646
24-06-18.15:05:52.507 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Disconnecting from node 1 due to request timeout.
24-06-18.15:05:52.510 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Disconnecting from node 1 due to request timeout.
24-06-18.15:05:52.510 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Disconnecting from node 1 due to request timeout.
24-06-18.15:07:44.793 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=1m52s281ms).
24-06-18.15:07:49.962 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cancelled in-flight FIND_COORDINATOR request with correlation id 87 due to node 1 being disconnected (elapsed time since creation: 20451ms, elapsed time since send: 41397ms, request timeout: 30000ms)
24-06-18.15:07:49.962 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cancelled in-flight FETCH request with correlation id 88 due to node 1 being disconnected (elapsed time since creation: 20451ms, elapsed time since send: 20451ms, request timeout: 30000ms)
24-06-18.15:07:44.796 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=1m52s282ms).
24-06-18.15:07:49.965 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cancelled in-flight FIND_COORDINATOR request with correlation id 86 due to node 1 being disconnected (elapsed time since creation: 20456ms, elapsed time since send: 41402ms, request timeout: 30000ms)
24-06-18.15:07:49.965 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cancelled in-flight FETCH request with correlation id 87 due to node 1 being disconnected (elapsed time since creation: 20456ms, elapsed time since send: 20456ms, request timeout: 30000ms)
24-06-18.15:07:49.966 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.15:07:44.793 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=2m33s687ms).
24-06-18.15:07:49.966 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.15:07:49.967 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cancelled in-flight FIND_COORDINATOR request with correlation id 86 due to node 1 being disconnected (elapsed time since creation: 20451ms, elapsed time since send: 41397ms, request timeout: 30000ms)
24-06-18.15:07:49.967 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cancelled in-flight FETCH request with correlation id 87 due to node 1 being disconnected (elapsed time since creation: 20451ms, elapsed time since send: 20451ms, request timeout: 30000ms)
24-06-18.15:07:49.967 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cancelled in-flight FIND_COORDINATOR request with correlation id 88 due to node 1 being disconnected (elapsed time since creation: 20450ms, elapsed time since send: 20450ms, request timeout: 30000ms)
24-06-18.15:07:49.967 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.15:07:49.976 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  FetchSessionHandler    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Error sending fetch request (sessionId=1338028069, epoch=65) to node 1:
org.apache.kafka.common.errors.DisconnectException: null
24-06-18.15:07:49.976 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  FetchSessionHandler    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Error sending fetch request (sessionId=1345744505, epoch=65) to node 1:
org.apache.kafka.common.errors.DisconnectException: null
24-06-18.15:07:49.976 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  FetchSessionHandler    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Error sending fetch request (sessionId=1661155747, epoch=65) to node 1:
org.apache.kafka.common.errors.DisconnectException: null
24-06-18.15:07:49.983 [http-nio-8091-exec-4] ERROR RaffleActivityController - 日历签到返利失败 userId:matthew
24-06-18.15:07:49.987 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Attempt to heartbeat with Generation{generationId=253, memberId='consumer-sku-clear-group-3-096e2b41-b20a-4854-99d3-342c2684f7f2', protocol='range'} and group instance id Optional.empty failed due to UNKNOWN_MEMBER_ID, resetting generation
24-06-18.15:07:49.987 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Attempt to heartbeat with Generation{generationId=251, memberId='consumer-sku-deduct-group-2-695a0b14-f94f-4874-827e-774e57e3a205', protocol='range'} and group instance id Optional.empty failed due to UNKNOWN_MEMBER_ID, resetting generation
24-06-18.15:07:49.988 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: encountered UNKNOWN_MEMBER_ID from HEARTBEAT response
24-06-18.15:07:49.988 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: encountered UNKNOWN_MEMBER_ID from HEARTBEAT response
24-06-18.15:07:49.988 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: encountered UNKNOWN_MEMBER_ID from HEARTBEAT response
24-06-18.15:07:49.988 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: encountered UNKNOWN_MEMBER_ID from HEARTBEAT response
24-06-18.15:07:49.988 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Giving away all assigned partitions as lost since generation has been reset,indicating that consumer is no longer part of the group
24-06-18.15:07:49.988 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Lost previously assigned partitions sku-clear-topic-0
24-06-18.15:07:49.988 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Giving away all assigned partitions as lost since generation has been reset,indicating that consumer is no longer part of the group
24-06-18.15:07:49.988 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Lost previously assigned partitions sku-deduct-topic-0
24-06-18.15:07:49.988 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions lost: [sku-clear-topic-0]
24-06-18.15:07:49.988 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions lost: [sku-deduct-topic-0]
24-06-18.15:07:49.989 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-18.15:07:49.989 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-18.15:07:49.989 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-18.15:07:49.989 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-18.15:07:49.989 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Attempt to heartbeat with Generation{generationId=3, memberId='consumer-send-rebate-group-1-a9de1dce-b9db-4130-806a-f717a375a413', protocol='range'} and group instance id Optional.empty failed due to UNKNOWN_MEMBER_ID, resetting generation
24-06-18.15:07:49.990 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: encountered UNKNOWN_MEMBER_ID from HEARTBEAT response
24-06-18.15:07:49.990 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: encountered UNKNOWN_MEMBER_ID from HEARTBEAT response
24-06-18.15:07:49.990 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Giving away all assigned partitions as lost since generation has been reset,indicating that consumer is no longer part of the group
24-06-18.15:07:49.990 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Lost previously assigned partitions send-rebate-topic-0
24-06-18.15:07:49.990 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions lost: [send-rebate-topic-0]
24-06-18.15:07:49.990 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-18.15:07:49.990 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-18.15:07:50.009 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-18.15:07:50.009 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-18.15:07:50.009 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-18.15:07:50.009 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-18.15:07:50.009 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-18.15:07:50.009 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-18.15:07:53.020 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=1, memberId='consumer-send-rebate-group-1-7f346284-2e0e-464b-8ab2-930f85970761', protocol='range'}
24-06-18.15:07:53.020 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=253, memberId='consumer-sku-deduct-group-2-615b3c0c-f459-402a-8ef3-710f7f3fca50', protocol='range'}
24-06-18.15:07:53.020 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=255, memberId='consumer-sku-clear-group-3-307cd674-88df-48dc-af39-3b15655273e5', protocol='range'}
24-06-18.15:07:53.020 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 255: {consumer-sku-clear-group-3-307cd674-88df-48dc-af39-3b15655273e5=Assignment(partitions=[sku-clear-topic-0])}
24-06-18.15:07:53.020 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 1: {consumer-send-rebate-group-1-7f346284-2e0e-464b-8ab2-930f85970761=Assignment(partitions=[send-rebate-topic-0])}
24-06-18.15:07:53.021 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 253: {consumer-sku-deduct-group-2-615b3c0c-f459-402a-8ef3-710f7f3fca50=Assignment(partitions=[sku-deduct-topic-0])}
24-06-18.15:07:53.028 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=253, memberId='consumer-sku-deduct-group-2-615b3c0c-f459-402a-8ef3-710f7f3fca50', protocol='range'}
24-06-18.15:07:53.028 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=255, memberId='consumer-sku-clear-group-3-307cd674-88df-48dc-af39-3b15655273e5', protocol='range'}
24-06-18.15:07:53.028 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=1, memberId='consumer-send-rebate-group-1-7f346284-2e0e-464b-8ab2-930f85970761', protocol='range'}
24-06-18.15:07:53.028 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-18.15:07:53.028 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-18.15:07:53.028 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-18.15:07:53.028 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-18.15:07:53.028 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-18.15:07:53.029 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-18.15:07:53.031 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Found no committed offset for partition send-rebate-topic-0
24-06-18.15:07:53.031 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-18.15:07:53.032 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-18.15:07:53.032 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=80, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-18.15:07:53.032 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-18.15:07:53.033 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  SubscriptionState      - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting offset for partition send-rebate-topic-0 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}.
24-06-18.15:07:53.034 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-18.15:08:10.563 [http-nio-8091-exec-6] INFO  RaffleActivityController - 日历签到返利开始 userId:matthew
24-06-18.15:08:13.973 [http-nio-8091-exec-6] INFO  BehaviorRebateService  - 开始创建返利订单 userId:matthew 
24-06-18.15:08:22.571 [http-nio-8091-exec-6] ERROR RaffleActivityController - 日历签到返利失败 userId:matthew
24-06-18.15:08:37.663 [http-nio-8091-exec-7] INFO  RaffleActivityController - 日历签到返利开始 userId:matthew
24-06-18.15:08:37.664 [http-nio-8091-exec-7] INFO  BehaviorRebateService  - 开始创建返利订单 userId:matthew 
24-06-18.15:08:37.678 [http-nio-8091-exec-7] ERROR RaffleActivityController - 日历签到返利失败 userId:matthew
24-06-18.15:09:52.799 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Revoke previously assigned partitions sku-clear-topic-0
24-06-18.15:09:52.799 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Revoke previously assigned partitions send-rebate-topic-0
24-06-18.15:09:52.799 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Revoke previously assigned partitions sku-deduct-topic-0
24-06-18.15:09:52.799 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-18.15:09:52.799 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-18.15:09:52.799 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-18.15:09:52.799 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-7f346284-2e0e-464b-8ab2-930f85970761 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-18.15:09:52.799 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-307cd674-88df-48dc-af39-3b15655273e5 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-18.15:09:52.799 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-615b3c0c-f459-402a-8ef3-710f7f3fca50 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-18.15:09:52.801 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:09:52.801 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:09:52.801 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:09:52.801 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:09:52.801 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:09:52.801 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-18.15:09:52.801 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-18.15:09:52.801 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:09:52.801 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-18.15:09:52.802 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:09:52.802 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:09:52.802 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:09:52.803 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:09:52.803 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:09:52.803 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:09:52.815 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-18.15:09:52.815 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-18.15:09:52.815 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-18.15:09:52.815 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-18.15:09:52.815 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-18.15:09:52.815 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-18.15:09:52.815 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-18.15:09:52.815 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-18.15:09:52.815 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-18.15:09:52.821 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-18.15:09:52.821 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-18.15:09:52.821 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-18.15:09:52.821 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-18.15:09:52.821 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-18.15:09:52.821 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-18.15:09:56.452 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 29646 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-18.15:09:56.453 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-18.15:09:56.956 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-18.15:09:56.958 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-18.15:09:56.982 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 16 ms. Found 0 Redis repository interfaces.
24-06-18.15:09:57.511 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-18.15:09:57.515 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-18.15:09:57.515 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-18.15:09:57.515 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-18.15:09:57.560 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-18.15:09:57.560 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1084 ms
24-06-18.15:09:57.943 [main            ] INFO  Version                - Redisson 3.26.0
24-06-18.15:09:57.966 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-18.15:09:58.060 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-18.15:09:58.068 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-18.15:09:58.843 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-18.15:09:59.023 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-18.15:09:59.075 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-18.15:09:59.075 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-18.15:09:59.075 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718694599074
24-06-18.15:09:59.084 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-18.15:09:59.090 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-18.15:09:59.095 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-18.15:09:59.095 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-18.15:09:59.095 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718694599094
24-06-18.15:09:59.098 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-18.15:09:59.099 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-18.15:09:59.102 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-18.15:09:59.102 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-18.15:09:59.102 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718694599102
24-06-18.15:09:59.104 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-18.15:09:59.105 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
24-06-18.15:09:59.112 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-18.15:09:59.121 [main            ] INFO  Application            - Started Application in 2.924 seconds (JVM running for 3.286)
24-06-18.15:09:59.249 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-18.15:09:59.249 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-18.15:09:59.249 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-18.15:09:59.249 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-18.15:09:59.249 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-18.15:09:59.249 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-18.15:09:59.250 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.15:09:59.250 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.15:09:59.250 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.15:09:59.254 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-18.15:09:59.254 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-18.15:09:59.254 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-18.15:09:59.265 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-18.15:09:59.265 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-18.15:09:59.265 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-18.15:09:59.266 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-18.15:09:59.266 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-18.15:09:59.266 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-18.15:09:59.635 [RMI TCP Connection(3)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
24-06-18.15:09:59.635 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
24-06-18.15:09:59.635 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-18.15:09:59.636 [RMI TCP Connection(3)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 1 ms
24-06-18.15:09:59.958 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-18.15:09:59.972 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-18.15:09:59.992 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-18.15:10:02.277 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=255, memberId='consumer-sku-deduct-group-2-4aae86bf-cb63-46e1-9304-0e5bd397b2a8', protocol='range'}
24-06-18.15:10:02.277 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=3, memberId='consumer-send-rebate-group-1-6a8615a6-6ebb-40ca-be62-fa24f5c1f965', protocol='range'}
24-06-18.15:10:02.278 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=257, memberId='consumer-sku-clear-group-3-537cc4fe-44cc-4139-a545-b0ca624046c9', protocol='range'}
24-06-18.15:10:02.282 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 257: {consumer-sku-clear-group-3-537cc4fe-44cc-4139-a545-b0ca624046c9=Assignment(partitions=[sku-clear-topic-0])}
24-06-18.15:10:02.282 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 255: {consumer-sku-deduct-group-2-4aae86bf-cb63-46e1-9304-0e5bd397b2a8=Assignment(partitions=[sku-deduct-topic-0])}
24-06-18.15:10:02.282 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 3: {consumer-send-rebate-group-1-6a8615a6-6ebb-40ca-be62-fa24f5c1f965=Assignment(partitions=[send-rebate-topic-0])}
24-06-18.15:10:02.296 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=3, memberId='consumer-send-rebate-group-1-6a8615a6-6ebb-40ca-be62-fa24f5c1f965', protocol='range'}
24-06-18.15:10:02.296 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=255, memberId='consumer-sku-deduct-group-2-4aae86bf-cb63-46e1-9304-0e5bd397b2a8', protocol='range'}
24-06-18.15:10:02.296 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=257, memberId='consumer-sku-clear-group-3-537cc4fe-44cc-4139-a545-b0ca624046c9', protocol='range'}
24-06-18.15:10:02.296 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-18.15:10:02.296 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-18.15:10:02.296 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-18.15:10:02.299 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-18.15:10:02.299 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-18.15:10:02.299 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-18.15:10:02.306 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Found no committed offset for partition send-rebate-topic-0
24-06-18.15:10:02.307 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=80, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-18.15:10:02.307 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-18.15:10:02.308 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-18.15:10:02.308 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-18.15:10:02.313 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  SubscriptionState      - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting offset for partition send-rebate-topic-0 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}.
24-06-18.15:10:02.313 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-18.15:10:09.254 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Revoke previously assigned partitions sku-deduct-topic-0
24-06-18.15:10:09.254 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Revoke previously assigned partitions sku-clear-topic-0
24-06-18.15:10:09.254 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Revoke previously assigned partitions send-rebate-topic-0
24-06-18.15:10:09.255 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-18.15:10:09.255 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-18.15:10:09.255 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-18.15:10:09.255 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-4aae86bf-cb63-46e1-9304-0e5bd397b2a8 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-18.15:10:09.255 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-6a8615a6-6ebb-40ca-be62-fa24f5c1f965 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-18.15:10:09.255 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-537cc4fe-44cc-4139-a545-b0ca624046c9 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-18.15:10:09.258 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:10:09.258 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:10:09.258 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:10:09.258 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:10:09.258 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:10:09.258 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-18.15:10:09.258 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:10:09.258 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-18.15:10:09.258 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-18.15:10:09.260 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:10:09.261 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:10:09.261 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:10:09.261 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:10:09.261 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:10:09.261 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:10:09.264 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-18.15:10:09.264 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-18.15:10:09.264 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-18.15:10:09.265 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-18.15:10:09.265 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-18.15:10:09.265 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-18.15:10:09.265 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-18.15:10:09.265 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-18.15:10:09.265 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-18.15:10:09.272 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-18.15:10:09.272 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-18.15:10:09.272 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-18.15:10:09.272 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-18.15:10:09.272 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-18.15:10:09.272 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-18.15:10:12.698 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 29697 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-18.15:10:12.700 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-18.15:10:13.215 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-18.15:10:13.216 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-18.15:10:13.235 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 11 ms. Found 0 Redis repository interfaces.
24-06-18.15:10:13.629 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-18.15:10:13.633 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-18.15:10:13.633 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-18.15:10:13.633 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-18.15:10:13.673 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-18.15:10:13.673 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 949 ms
24-06-18.15:10:14.067 [main            ] INFO  Version                - Redisson 3.26.0
24-06-18.15:10:14.086 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-18.15:10:14.174 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-18.15:10:14.182 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-18.15:10:14.840 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-18.15:10:15.013 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-18.15:10:15.053 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-18.15:10:15.054 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-18.15:10:15.054 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718694615052
24-06-18.15:10:15.066 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-18.15:10:15.076 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-18.15:10:15.082 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-18.15:10:15.082 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-18.15:10:15.082 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718694615082
24-06-18.15:10:15.087 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-18.15:10:15.089 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-18.15:10:15.094 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-18.15:10:15.095 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-18.15:10:15.095 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718694615094
24-06-18.15:10:15.100 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-18.15:10:15.101 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
24-06-18.15:10:15.114 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-18.15:10:15.129 [main            ] INFO  Application            - Started Application in 2.667 seconds (JVM running for 2.993)
24-06-18.15:10:15.269 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-18.15:10:15.269 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-18.15:10:15.269 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-18.15:10:15.271 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-18.15:10:15.271 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-18.15:10:15.271 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-18.15:10:15.272 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.15:10:15.272 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.15:10:15.272 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.15:10:15.277 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-18.15:10:15.277 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-18.15:10:15.277 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-18.15:10:15.298 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-18.15:10:15.298 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-18.15:10:15.298 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-18.15:10:15.298 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-18.15:10:15.300 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-18.15:10:15.300 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-18.15:10:15.367 [RMI TCP Connection(2)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
24-06-18.15:10:15.367 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
24-06-18.15:10:15.369 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 2 ms
24-06-18.15:10:15.378 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-18.15:10:15.897 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-18.15:10:15.910 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-18.15:10:15.929 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-18.15:10:18.384 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=259, memberId='consumer-sku-clear-group-3-7c49ecf9-35c2-46a1-a849-6fb2fc9d68d5', protocol='range'}
24-06-18.15:10:18.384 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=257, memberId='consumer-sku-deduct-group-2-56ba0e3d-5af8-4578-ad2b-1e95dd1d2f52', protocol='range'}
24-06-18.15:10:18.384 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=5, memberId='consumer-send-rebate-group-1-2aca8501-7b55-4e88-b6e1-8d5026229629', protocol='range'}
24-06-18.15:10:18.393 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 259: {consumer-sku-clear-group-3-7c49ecf9-35c2-46a1-a849-6fb2fc9d68d5=Assignment(partitions=[sku-clear-topic-0])}
24-06-18.15:10:18.393 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 257: {consumer-sku-deduct-group-2-56ba0e3d-5af8-4578-ad2b-1e95dd1d2f52=Assignment(partitions=[sku-deduct-topic-0])}
24-06-18.15:10:18.393 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 5: {consumer-send-rebate-group-1-2aca8501-7b55-4e88-b6e1-8d5026229629=Assignment(partitions=[send-rebate-topic-0])}
24-06-18.15:10:18.418 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=257, memberId='consumer-sku-deduct-group-2-56ba0e3d-5af8-4578-ad2b-1e95dd1d2f52', protocol='range'}
24-06-18.15:10:18.418 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=5, memberId='consumer-send-rebate-group-1-2aca8501-7b55-4e88-b6e1-8d5026229629', protocol='range'}
24-06-18.15:10:18.418 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=259, memberId='consumer-sku-clear-group-3-7c49ecf9-35c2-46a1-a849-6fb2fc9d68d5', protocol='range'}
24-06-18.15:10:18.419 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-18.15:10:18.419 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-18.15:10:18.420 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-18.15:10:18.426 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-18.15:10:18.426 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-18.15:10:18.426 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-18.15:10:18.465 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Found no committed offset for partition send-rebate-topic-0
24-06-18.15:10:18.469 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=80, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-18.15:10:18.470 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-18.15:10:18.471 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-18.15:10:18.473 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-18.15:10:18.499 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  SubscriptionState      - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting offset for partition send-rebate-topic-0 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}.
24-06-18.15:10:18.499 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-18.15:10:19.201 [http-nio-8091-exec-3] INFO  RaffleActivityController - 日历签到返利开始 userId:matthew
24-06-18.15:10:19.202 [http-nio-8091-exec-3] INFO  BehaviorRebateService  - 开始创建返利订单 userId:matthew 
24-06-18.15:10:19.216 [http-nio-8091-exec-3] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-18.15:10:19.250 [http-nio-8091-exec-3] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-18.15:10:19.308 [http-nio-8091-exec-3] ERROR RaffleActivityController - 日历签到返利失败 userId:matthew
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'biz_id' cannot be null
### The error may exist in file [/Users/matthew/Desktop/lottery/lottery-app/target/classes/mybatis/mapper/UserBehaviorRebateOrderMapper.xml]
### The error may involve cn.matthew.infrastructure.persistent.dao.rebate.IUserBehaviorRebateOrderDao.insert-Inline
### The error occurred while setting parameters
### SQL: insert into user_behavior_rebate_order_000(         user_id, order_id, behavior_type, rebate_desc, rebate_type, rebate_config, biz_id, create_time, update_time         ) values(         ?, ?, ?, ?, ?, ?, ?, now(), now()         )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Column 'biz_id' cannot be null
; Column 'biz_id' cannot be null; nested exception is java.sql.SQLIntegrityConstraintViolationException: Column 'biz_id' cannot be null
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:87)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy104.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy136.insert(Unknown Source)
	at cn.matthew.infrastructure.persistent.repository.RebateRepository.lambda$saveRebateRecord$0(RebateRepository.java:84)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.matthew.infrastructure.persistent.repository.RebateRepository.saveRebateRecord(RebateRepository.java:70)
	at cn.matthew.infrastructure.persistent.repository.RebateRepository$$FastClassBySpringCGLIB$$eb2d2aba.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.RebateRepository$$EnhancerBySpringCGLIB$$5d6f67c7.saveRebateRecord(<generated>)
	at cn.matthew.domain.rebate.service.BehaviorRebateService.createOrder(BehaviorRebateService.java:91)
	at cn.matthew.trigger.http.RaffleActivityController.calendarSignRebate(RaffleActivityController.java:239)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Column 'biz_id' cannot be null
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy176.update(Unknown Source)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 75 common frames omitted
24-06-18.15:13:51.061 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Revoke previously assigned partitions send-rebate-topic-0
24-06-18.15:13:51.061 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Revoke previously assigned partitions sku-clear-topic-0
24-06-18.15:13:51.061 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Revoke previously assigned partitions sku-deduct-topic-0
24-06-18.15:13:51.062 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-18.15:13:51.062 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-18.15:13:51.062 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-18.15:13:51.063 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-56ba0e3d-5af8-4578-ad2b-1e95dd1d2f52 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-18.15:13:51.063 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-2aca8501-7b55-4e88-b6e1-8d5026229629 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-18.15:13:51.063 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-7c49ecf9-35c2-46a1-a849-6fb2fc9d68d5 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-18.15:13:51.065 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:13:51.065 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:13:51.065 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:13:51.065 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:13:51.065 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-18.15:13:51.065 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-18.15:13:51.065 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:13:51.066 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:13:51.066 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-18.15:13:51.068 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:13:51.068 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:13:51.069 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:13:51.069 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:13:51.070 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:13:51.070 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:13:51.084 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-18.15:13:51.084 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-18.15:13:51.084 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-18.15:13:51.084 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-18.15:13:51.084 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-18.15:13:51.084 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-18.15:13:51.084 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-18.15:13:51.084 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-18.15:13:51.084 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-18.15:13:51.090 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-18.15:13:51.090 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-18.15:13:51.090 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-18.15:13:51.090 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-18.15:13:51.090 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-18.15:13:51.090 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-18.15:13:54.242 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 30281 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-18.15:13:54.243 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-18.15:13:54.770 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-18.15:13:54.771 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-18.15:13:54.788 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 10 ms. Found 0 Redis repository interfaces.
24-06-18.15:13:55.268 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-18.15:13:55.272 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-18.15:13:55.272 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-18.15:13:55.272 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-18.15:13:55.313 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-18.15:13:55.313 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1050 ms
24-06-18.15:13:55.722 [main            ] INFO  Version                - Redisson 3.26.0
24-06-18.15:13:55.742 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-18.15:13:55.824 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-18.15:13:55.832 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-18.15:13:56.517 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-18.15:13:56.666 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-18.15:13:56.699 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-18.15:13:56.700 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-18.15:13:56.700 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718694836699
24-06-18.15:13:56.708 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-18.15:13:56.714 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-18.15:13:56.718 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-18.15:13:56.718 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-18.15:13:56.718 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718694836718
24-06-18.15:13:56.721 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-18.15:13:56.723 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-18.15:13:56.730 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-18.15:13:56.730 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-18.15:13:56.730 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718694836730
24-06-18.15:13:56.734 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-18.15:13:56.744 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
24-06-18.15:13:56.874 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-18.15:13:56.905 [main            ] INFO  Application            - Started Application in 2.906 seconds (JVM running for 3.189)
24-06-18.15:13:57.014 [RMI TCP Connection(1)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
24-06-18.15:13:57.014 [RMI TCP Connection(1)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
24-06-18.15:13:57.014 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-18.15:13:57.016 [RMI TCP Connection(1)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 2 ms
24-06-18.15:13:57.240 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-18.15:13:57.243 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-18.15:13:57.243 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-18.15:13:57.247 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-18.15:13:57.247 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-18.15:13:57.248 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-18.15:13:57.251 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.15:13:57.251 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.15:13:57.251 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.15:13:57.257 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-18.15:13:57.258 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-18.15:13:57.258 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-18.15:13:57.291 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-18.15:13:57.291 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-18.15:13:57.291 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-18.15:13:57.292 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-18.15:13:57.292 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-18.15:13:57.292 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-18.15:13:57.408 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-18.15:13:57.420 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-18.15:13:57.435 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-18.15:13:59.681 [http-nio-8091-exec-1] INFO  RaffleActivityController - 日历签到返利开始 userId:matthew
24-06-18.15:13:59.681 [http-nio-8091-exec-1] INFO  BehaviorRebateService  - 开始创建返利订单 userId:matthew 
24-06-18.15:13:59.692 [http-nio-8091-exec-1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-18.15:13:59.711 [http-nio-8091-exec-1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-18.15:13:59.765 [http-nio-8091-exec-1] ERROR RaffleActivityController - 日历签到返利失败 userId:matthew
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLException: Field 'out_business_no' doesn't have a default value
### The error may exist in file [/Users/matthew/Desktop/lottery/lottery-app/target/classes/mybatis/mapper/UserBehaviorRebateOrderMapper.xml]
### The error may involve cn.matthew.infrastructure.persistent.dao.rebate.IUserBehaviorRebateOrderDao.insert-Inline
### The error occurred while setting parameters
### SQL: insert into user_behavior_rebate_order_000(         user_id, order_id, behavior_type, rebate_desc, rebate_type, rebate_config, biz_id, create_time, update_time         ) values(         ?, ?, ?, ?, ?, ?, ?, now(), now()         )
### Cause: java.sql.SQLException: Field 'out_business_no' doesn't have a default value
; Field 'out_business_no' doesn't have a default value; nested exception is java.sql.SQLException: Field 'out_business_no' doesn't have a default value
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:251)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy104.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy136.insert(Unknown Source)
	at cn.matthew.infrastructure.persistent.repository.RebateRepository.lambda$saveRebateRecord$0(RebateRepository.java:84)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.matthew.infrastructure.persistent.repository.RebateRepository.saveRebateRecord(RebateRepository.java:70)
	at cn.matthew.infrastructure.persistent.repository.RebateRepository$$FastClassBySpringCGLIB$$eb2d2aba.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.RebateRepository$$EnhancerBySpringCGLIB$$5d6f67c7.saveRebateRecord(<generated>)
	at cn.matthew.domain.rebate.service.BehaviorRebateService.createOrder(BehaviorRebateService.java:92)
	at cn.matthew.trigger.http.RaffleActivityController.calendarSignRebate(RaffleActivityController.java:239)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLException: Field 'out_business_no' doesn't have a default value
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:129)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy176.update(Unknown Source)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 75 common frames omitted
24-06-18.15:14:00.299 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=7, memberId='consumer-send-rebate-group-1-40f8bd38-4249-48ed-bd11-c66d92530a65', protocol='range'}
24-06-18.15:14:00.299 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=259, memberId='consumer-sku-deduct-group-2-e7bff205-b6a1-4026-b500-586fd20311b6', protocol='range'}
24-06-18.15:14:00.299 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=261, memberId='consumer-sku-clear-group-3-85bee6f6-c490-4fab-8cb0-ba9214f5362f', protocol='range'}
24-06-18.15:14:00.302 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 261: {consumer-sku-clear-group-3-85bee6f6-c490-4fab-8cb0-ba9214f5362f=Assignment(partitions=[sku-clear-topic-0])}
24-06-18.15:14:00.302 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 259: {consumer-sku-deduct-group-2-e7bff205-b6a1-4026-b500-586fd20311b6=Assignment(partitions=[sku-deduct-topic-0])}
24-06-18.15:14:00.302 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 7: {consumer-send-rebate-group-1-40f8bd38-4249-48ed-bd11-c66d92530a65=Assignment(partitions=[send-rebate-topic-0])}
24-06-18.15:14:00.313 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=261, memberId='consumer-sku-clear-group-3-85bee6f6-c490-4fab-8cb0-ba9214f5362f', protocol='range'}
24-06-18.15:14:00.313 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=259, memberId='consumer-sku-deduct-group-2-e7bff205-b6a1-4026-b500-586fd20311b6', protocol='range'}
24-06-18.15:14:00.313 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=7, memberId='consumer-send-rebate-group-1-40f8bd38-4249-48ed-bd11-c66d92530a65', protocol='range'}
24-06-18.15:14:00.314 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-18.15:14:00.314 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-18.15:14:00.314 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-18.15:14:00.316 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-18.15:14:00.316 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-18.15:14:00.316 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-18.15:14:00.324 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Found no committed offset for partition send-rebate-topic-0
24-06-18.15:14:00.326 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=80, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-18.15:14:00.326 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-18.15:14:00.326 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-18.15:14:00.326 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-18.15:14:00.333 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  SubscriptionState      - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting offset for partition send-rebate-topic-0 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}.
24-06-18.15:14:00.333 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-18.15:14:05.580 [http-nio-8091-exec-3] INFO  RaffleActivityController - 日历签到返利开始 userId:matthew
24-06-18.15:14:05.581 [http-nio-8091-exec-3] INFO  BehaviorRebateService  - 开始创建返利订单 userId:matthew 
24-06-18.15:14:05.625 [http-nio-8091-exec-3] ERROR RaffleActivityController - 日历签到返利失败 userId:matthew
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLException: Field 'out_business_no' doesn't have a default value
### The error may exist in file [/Users/matthew/Desktop/lottery/lottery-app/target/classes/mybatis/mapper/UserBehaviorRebateOrderMapper.xml]
### The error may involve cn.matthew.infrastructure.persistent.dao.rebate.IUserBehaviorRebateOrderDao.insert-Inline
### The error occurred while setting parameters
### SQL: insert into user_behavior_rebate_order_000(         user_id, order_id, behavior_type, rebate_desc, rebate_type, rebate_config, biz_id, create_time, update_time         ) values(         ?, ?, ?, ?, ?, ?, ?, now(), now()         )
### Cause: java.sql.SQLException: Field 'out_business_no' doesn't have a default value
; Field 'out_business_no' doesn't have a default value; nested exception is java.sql.SQLException: Field 'out_business_no' doesn't have a default value
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:251)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy104.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy136.insert(Unknown Source)
	at cn.matthew.infrastructure.persistent.repository.RebateRepository.lambda$saveRebateRecord$0(RebateRepository.java:84)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.matthew.infrastructure.persistent.repository.RebateRepository.saveRebateRecord(RebateRepository.java:70)
	at cn.matthew.infrastructure.persistent.repository.RebateRepository$$FastClassBySpringCGLIB$$eb2d2aba.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.RebateRepository$$EnhancerBySpringCGLIB$$5d6f67c7.saveRebateRecord(<generated>)
	at cn.matthew.domain.rebate.service.BehaviorRebateService.createOrder(BehaviorRebateService.java:92)
	at cn.matthew.trigger.http.RaffleActivityController.calendarSignRebate(RaffleActivityController.java:239)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLException: Field 'out_business_no' doesn't have a default value
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:129)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy176.update(Unknown Source)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 75 common frames omitted
24-06-18.15:22:57.507 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Node -1 disconnected.
24-06-18.15:22:57.507 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Node -1 disconnected.
24-06-18.15:22:57.507 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  NetworkClient          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Node -1 disconnected.
24-06-18.15:26:36.903 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Revoke previously assigned partitions sku-clear-topic-0
24-06-18.15:26:36.903 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Revoke previously assigned partitions sku-deduct-topic-0
24-06-18.15:26:36.903 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Revoke previously assigned partitions send-rebate-topic-0
24-06-18.15:26:36.904 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-18.15:26:36.904 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-18.15:26:36.904 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-18.15:26:36.904 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-40f8bd38-4249-48ed-bd11-c66d92530a65 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-18.15:26:36.904 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-e7bff205-b6a1-4026-b500-586fd20311b6 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-18.15:26:36.904 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-85bee6f6-c490-4fab-8cb0-ba9214f5362f sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-18.15:26:36.907 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:26:36.907 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:26:36.907 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:26:36.907 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:26:36.907 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:26:36.907 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:26:36.907 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-18.15:26:36.907 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-18.15:26:36.907 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-18.15:26:36.909 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:26:36.909 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:26:36.910 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:26:36.910 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:26:36.910 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:26:36.910 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:26:36.923 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-18.15:26:36.923 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-18.15:26:36.923 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-18.15:26:36.923 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-18.15:26:36.923 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-18.15:26:36.923 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-18.15:26:36.923 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-18.15:26:36.923 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-18.15:26:36.923 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-18.15:26:36.932 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-18.15:26:36.933 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-18.15:26:36.933 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-18.15:26:36.933 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-18.15:26:36.934 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-18.15:26:36.934 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-18.15:26:42.296 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 32200 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-18.15:26:42.297 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-18.15:26:42.805 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-18.15:26:42.806 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-18.15:26:42.824 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 10 ms. Found 0 Redis repository interfaces.
24-06-18.15:26:43.377 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-18.15:26:43.381 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-18.15:26:43.381 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-18.15:26:43.382 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-18.15:26:43.423 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-18.15:26:43.423 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1105 ms
24-06-18.15:26:43.805 [main            ] INFO  Version                - Redisson 3.26.0
24-06-18.15:26:43.825 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-18.15:26:43.909 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-18.15:26:43.918 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-18.15:26:44.889 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-18.15:26:45.051 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-18.15:26:45.087 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-18.15:26:45.087 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-18.15:26:45.087 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718695605086
24-06-18.15:26:45.097 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-18.15:26:45.108 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-18.15:26:45.115 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-18.15:26:45.115 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-18.15:26:45.115 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718695605115
24-06-18.15:26:45.121 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-18.15:26:45.124 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-18.15:26:45.130 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-18.15:26:45.130 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-18.15:26:45.130 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718695605130
24-06-18.15:26:45.135 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-18.15:26:45.136 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
24-06-18.15:26:45.150 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-18.15:26:45.168 [main            ] INFO  Application            - Started Application in 3.107 seconds (JVM running for 3.412)
24-06-18.15:26:45.402 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-18.15:26:45.403 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-18.15:26:45.403 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-18.15:26:45.404 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-18.15:26:45.404 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-18.15:26:45.404 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-18.15:26:45.406 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.15:26:45.406 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.15:26:45.406 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.15:26:45.412 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-18.15:26:45.412 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-18.15:26:45.412 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-18.15:26:45.426 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-18.15:26:45.426 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-18.15:26:45.426 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-18.15:26:45.426 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-18.15:26:45.426 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-18.15:26:45.426 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-18.15:26:45.547 [RMI TCP Connection(2)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
24-06-18.15:26:45.548 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
24-06-18.15:26:45.549 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 1 ms
24-06-18.15:26:45.549 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-18.15:26:45.986 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-18.15:26:45.997 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-18.15:26:46.015 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-18.15:26:48.438 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=263, memberId='consumer-sku-clear-group-3-7f02ff81-0ff7-4a2f-946a-11759c50e3b5', protocol='range'}
24-06-18.15:26:48.438 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=9, memberId='consumer-send-rebate-group-1-3d3ebaf5-61f1-4edc-9d42-9acd532a82c7', protocol='range'}
24-06-18.15:26:48.439 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=261, memberId='consumer-sku-deduct-group-2-b843bd08-1bd6-4c84-aa00-e51ed5936fb7', protocol='range'}
24-06-18.15:26:48.444 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 263: {consumer-sku-clear-group-3-7f02ff81-0ff7-4a2f-946a-11759c50e3b5=Assignment(partitions=[sku-clear-topic-0])}
24-06-18.15:26:48.444 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 9: {consumer-send-rebate-group-1-3d3ebaf5-61f1-4edc-9d42-9acd532a82c7=Assignment(partitions=[send-rebate-topic-0])}
24-06-18.15:26:48.444 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 261: {consumer-sku-deduct-group-2-b843bd08-1bd6-4c84-aa00-e51ed5936fb7=Assignment(partitions=[sku-deduct-topic-0])}
24-06-18.15:26:48.468 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=261, memberId='consumer-sku-deduct-group-2-b843bd08-1bd6-4c84-aa00-e51ed5936fb7', protocol='range'}
24-06-18.15:26:48.468 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=263, memberId='consumer-sku-clear-group-3-7f02ff81-0ff7-4a2f-946a-11759c50e3b5', protocol='range'}
24-06-18.15:26:48.468 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=9, memberId='consumer-send-rebate-group-1-3d3ebaf5-61f1-4edc-9d42-9acd532a82c7', protocol='range'}
24-06-18.15:26:48.469 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-18.15:26:48.469 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-18.15:26:48.469 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-18.15:26:48.473 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-18.15:26:48.473 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-18.15:26:48.473 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-18.15:26:48.517 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Found no committed offset for partition send-rebate-topic-0
24-06-18.15:26:48.519 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=80, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-18.15:26:48.519 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-18.15:26:48.519 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-18.15:26:48.519 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-18.15:26:48.526 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  SubscriptionState      - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting offset for partition send-rebate-topic-0 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}.
24-06-18.15:26:48.526 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-18.15:26:52.172 [http-nio-8091-exec-2] INFO  RaffleActivityController - 日历签到返利开始 userId:matthew
24-06-18.15:26:52.173 [http-nio-8091-exec-2] INFO  BehaviorRebateService  - 开始创建返利订单 userId:matthew 
24-06-18.15:26:52.194 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-18.15:26:52.218 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-18.15:26:52.281 [http-nio-8091-exec-2] ERROR RaffleActivityController - 日历签到返利失败 userId:matthew
org.springframework.dao.DataIntegrityViolationException: 
### Error updating database.  Cause: java.sql.SQLException: Field 'out_business_no' doesn't have a default value
### The error may exist in file [/Users/matthew/Desktop/lottery/lottery-app/target/classes/mybatis/mapper/UserBehaviorRebateOrderMapper.xml]
### The error may involve cn.matthew.infrastructure.persistent.dao.rebate.IUserBehaviorRebateOrderDao.insert-Inline
### The error occurred while setting parameters
### SQL: insert into user_behavior_rebate_order_000(         user_id, order_id, behavior_type, rebate_desc, rebate_type, rebate_config, biz_id, create_time, update_time         ) values(         ?, ?, ?, ?, ?, ?, ?, now(), now()         )
### Cause: java.sql.SQLException: Field 'out_business_no' doesn't have a default value
; Field 'out_business_no' doesn't have a default value; nested exception is java.sql.SQLException: Field 'out_business_no' doesn't have a default value
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:251)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy104.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy136.insert(Unknown Source)
	at cn.matthew.infrastructure.persistent.repository.RebateRepository.lambda$saveRebateRecord$0(RebateRepository.java:85)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.matthew.infrastructure.persistent.repository.RebateRepository.saveRebateRecord(RebateRepository.java:70)
	at cn.matthew.infrastructure.persistent.repository.RebateRepository$$FastClassBySpringCGLIB$$eb2d2aba.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.RebateRepository$$EnhancerBySpringCGLIB$$5d6f67c7.saveRebateRecord(<generated>)
	at cn.matthew.domain.rebate.service.BehaviorRebateService.createOrder(BehaviorRebateService.java:93)
	at cn.matthew.trigger.http.RaffleActivityController.calendarSignRebate(RaffleActivityController.java:239)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLException: Field 'out_business_no' doesn't have a default value
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:129)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy176.update(Unknown Source)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 75 common frames omitted
24-06-18.15:28:33.738 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Revoke previously assigned partitions sku-deduct-topic-0
24-06-18.15:28:33.738 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Revoke previously assigned partitions sku-clear-topic-0
24-06-18.15:28:33.738 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Revoke previously assigned partitions send-rebate-topic-0
24-06-18.15:28:33.739 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-18.15:28:33.739 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-18.15:28:33.739 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-18.15:28:33.739 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-7f02ff81-0ff7-4a2f-946a-11759c50e3b5 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-18.15:28:33.739 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-3d3ebaf5-61f1-4edc-9d42-9acd532a82c7 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-18.15:28:33.739 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-b843bd08-1bd6-4c84-aa00-e51ed5936fb7 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-18.15:28:33.743 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:28:33.743 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:28:33.743 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:28:33.743 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:28:33.743 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-18.15:28:33.743 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:28:33.743 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:28:33.743 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-18.15:28:33.743 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-18.15:28:33.744 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:28:33.744 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:28:33.745 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:28:33.745 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:28:33.745 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:28:33.745 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:28:33.760 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-18.15:28:33.761 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-18.15:28:33.761 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-18.15:28:33.761 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-18.15:28:33.761 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-18.15:28:33.761 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-18.15:28:33.761 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-18.15:28:33.761 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-18.15:28:33.761 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-18.15:28:33.768 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-18.15:28:33.768 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-18.15:28:33.769 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-18.15:28:33.769 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-18.15:28:33.769 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-18.15:28:33.769 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-18.15:28:35.725 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 32485 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-18.15:28:35.726 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-18.15:28:36.230 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-18.15:28:36.231 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-18.15:28:36.248 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 10 ms. Found 0 Redis repository interfaces.
24-06-18.15:28:36.639 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-18.15:28:36.643 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-18.15:28:36.643 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-18.15:28:36.643 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-18.15:28:36.691 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-18.15:28:36.691 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 945 ms
24-06-18.15:28:37.070 [main            ] INFO  Version                - Redisson 3.26.0
24-06-18.15:28:37.089 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-18.15:28:37.175 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-18.15:28:37.189 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-18.15:28:37.792 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-18.15:28:37.931 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-18.15:28:37.969 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-18.15:28:37.969 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-18.15:28:37.969 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718695717968
24-06-18.15:28:37.977 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-18.15:28:37.983 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-18.15:28:37.987 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-18.15:28:37.987 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-18.15:28:37.987 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718695717987
24-06-18.15:28:37.990 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-18.15:28:37.991 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-18.15:28:37.994 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-18.15:28:37.994 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-18.15:28:37.994 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718695717994
24-06-18.15:28:37.996 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-18.15:28:37.997 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
24-06-18.15:28:38.004 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-18.15:28:38.014 [main            ] INFO  Application            - Started Application in 2.528 seconds (JVM running for 2.798)
24-06-18.15:28:38.165 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-18.15:28:38.165 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-18.15:28:38.165 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-18.15:28:38.166 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-18.15:28:38.166 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-18.15:28:38.166 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-18.15:28:38.166 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.15:28:38.166 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.15:28:38.166 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.15:28:38.169 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-18.15:28:38.169 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-18.15:28:38.169 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-18.15:28:38.180 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-18.15:28:38.180 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-18.15:28:38.180 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-18.15:28:38.180 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-18.15:28:38.180 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-18.15:28:38.180 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-18.15:28:38.433 [RMI TCP Connection(2)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
24-06-18.15:28:38.433 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
24-06-18.15:28:38.434 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-18.15:28:38.435 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 2 ms
24-06-18.15:28:38.602 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-18.15:28:38.611 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-18.15:28:38.626 [RMI TCP Connection(3)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-18.15:28:41.190 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=265, memberId='consumer-sku-clear-group-3-7a46739a-688b-47fe-88fe-e2257ea3e37a', protocol='range'}
24-06-18.15:28:41.190 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=11, memberId='consumer-send-rebate-group-1-4205c98c-7965-4643-90f9-1981d7a16c34', protocol='range'}
24-06-18.15:28:41.191 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=263, memberId='consumer-sku-deduct-group-2-ea063d4d-79bd-4cfe-a097-4977ed50f5b5', protocol='range'}
24-06-18.15:28:41.198 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 11: {consumer-send-rebate-group-1-4205c98c-7965-4643-90f9-1981d7a16c34=Assignment(partitions=[send-rebate-topic-0])}
24-06-18.15:28:41.198 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 265: {consumer-sku-clear-group-3-7a46739a-688b-47fe-88fe-e2257ea3e37a=Assignment(partitions=[sku-clear-topic-0])}
24-06-18.15:28:41.198 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 263: {consumer-sku-deduct-group-2-ea063d4d-79bd-4cfe-a097-4977ed50f5b5=Assignment(partitions=[sku-deduct-topic-0])}
24-06-18.15:28:41.231 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=263, memberId='consumer-sku-deduct-group-2-ea063d4d-79bd-4cfe-a097-4977ed50f5b5', protocol='range'}
24-06-18.15:28:41.231 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=11, memberId='consumer-send-rebate-group-1-4205c98c-7965-4643-90f9-1981d7a16c34', protocol='range'}
24-06-18.15:28:41.231 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=265, memberId='consumer-sku-clear-group-3-7a46739a-688b-47fe-88fe-e2257ea3e37a', protocol='range'}
24-06-18.15:28:41.231 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-18.15:28:41.231 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-18.15:28:41.231 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-18.15:28:41.234 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-18.15:28:41.234 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-18.15:28:41.234 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-18.15:28:41.242 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Found no committed offset for partition send-rebate-topic-0
24-06-18.15:28:41.243 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=80, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-18.15:28:41.243 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-18.15:28:41.243 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-18.15:28:41.243 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-18.15:28:41.249 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  SubscriptionState      - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting offset for partition send-rebate-topic-0 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}.
24-06-18.15:28:41.249 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-18.15:28:49.036 [http-nio-8091-exec-2] INFO  RaffleActivityController - 日历签到返利开始 userId:matthew
24-06-18.15:28:49.037 [http-nio-8091-exec-2] INFO  BehaviorRebateService  - 开始创建返利订单 userId:matthew 
24-06-18.15:28:49.055 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-18.15:28:49.094 [http-nio-8091-exec-2] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-18.15:28:49.190 [http-nio-8091-exec-2] ERROR RaffleActivityController - 日历签到返利失败 userId:matthew
org.springframework.jdbc.BadSqlGrammarException: 
### Error updating database.  Cause: java.sql.SQLException: Column count doesn't match value count at row 1
### The error may exist in file [/Users/matthew/Desktop/lottery/lottery-app/target/classes/mybatis/mapper/UserBehaviorRebateOrderMapper.xml]
### The error may involve cn.matthew.infrastructure.persistent.dao.rebate.IUserBehaviorRebateOrderDao.insert-Inline
### The error occurred while setting parameters
### SQL: insert into user_behavior_rebate_order_000(         user_id, order_id, behavior_type, rebate_desc, rebate_type, rebate_config, out_business_no, biz_id, create_time, update_time         ) values(         ?, ?, ?, ?, ?, ?, ?, now(), now()         )
### Cause: java.sql.SQLException: Column count doesn't match value count at row 1
; bad SQL grammar []; nested exception is java.sql.SQLException: Column count doesn't match value count at row 1
	at org.springframework.jdbc.support.SQLStateSQLExceptionTranslator.doTranslate(SQLStateSQLExceptionTranslator.java:101)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy104.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy136.insert(Unknown Source)
	at cn.matthew.infrastructure.persistent.repository.RebateRepository.lambda$saveRebateRecord$0(RebateRepository.java:85)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.matthew.infrastructure.persistent.repository.RebateRepository.saveRebateRecord(RebateRepository.java:70)
	at cn.matthew.infrastructure.persistent.repository.RebateRepository$$FastClassBySpringCGLIB$$eb2d2aba.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.RebateRepository$$EnhancerBySpringCGLIB$$5d6f67c7.saveRebateRecord(<generated>)
	at cn.matthew.domain.rebate.service.BehaviorRebateService.createOrder(BehaviorRebateService.java:93)
	at cn.matthew.trigger.http.RaffleActivityController.calendarSignRebate(RaffleActivityController.java:239)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLException: Column count doesn't match value count at row 1
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:129)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy176.update(Unknown Source)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 75 common frames omitted
24-06-18.15:29:07.374 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Revoke previously assigned partitions send-rebate-topic-0
24-06-18.15:29:07.374 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Revoke previously assigned partitions sku-clear-topic-0
24-06-18.15:29:07.374 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Revoke previously assigned partitions sku-deduct-topic-0
24-06-18.15:29:07.374 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-18.15:29:07.374 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-18.15:29:07.374 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-18.15:29:07.375 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-4205c98c-7965-4643-90f9-1981d7a16c34 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-18.15:29:07.375 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-ea063d4d-79bd-4cfe-a097-4977ed50f5b5 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-18.15:29:07.375 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-7a46739a-688b-47fe-88fe-e2257ea3e37a sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-18.15:29:07.377 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:29:07.377 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:29:07.377 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:29:07.377 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:29:07.377 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:29:07.377 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-18.15:29:07.377 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-18.15:29:07.377 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:29:07.377 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-18.15:29:07.377 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:29:07.378 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:29:07.378 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:29:07.378 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:29:07.378 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:29:07.378 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:29:07.387 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-18.15:29:07.387 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-18.15:29:07.387 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-18.15:29:07.387 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-18.15:29:07.387 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-18.15:29:07.387 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-18.15:29:07.387 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-18.15:29:07.387 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-18.15:29:07.388 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-18.15:29:07.392 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-18.15:29:07.392 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-18.15:29:07.393 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-18.15:29:07.393 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-18.15:29:07.393 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-18.15:29:07.393 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-18.15:29:09.680 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 32573 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-18.15:29:09.683 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-18.15:29:10.509 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-18.15:29:10.511 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-18.15:29:10.536 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 16 ms. Found 0 Redis repository interfaces.
24-06-18.15:29:11.070 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-18.15:29:11.074 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-18.15:29:11.074 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-18.15:29:11.074 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-18.15:29:11.119 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-18.15:29:11.119 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1403 ms
24-06-18.15:29:11.515 [main            ] INFO  Version                - Redisson 3.26.0
24-06-18.15:29:11.533 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-18.15:29:11.619 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-18.15:29:11.630 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-18.15:29:12.226 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-18.15:29:12.372 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-18.15:29:12.406 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-18.15:29:12.406 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-18.15:29:12.406 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718695752405
24-06-18.15:29:12.413 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-18.15:29:12.420 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-18.15:29:12.424 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-18.15:29:12.424 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-18.15:29:12.424 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718695752424
24-06-18.15:29:12.427 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-18.15:29:12.428 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-18.15:29:12.432 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-18.15:29:12.432 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-18.15:29:12.432 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718695752432
24-06-18.15:29:12.434 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-18.15:29:12.435 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
24-06-18.15:29:12.443 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-18.15:29:12.453 [main            ] INFO  Application            - Started Application in 3.094 seconds (JVM running for 3.472)
24-06-18.15:29:12.609 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-18.15:29:12.609 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-18.15:29:12.609 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-18.15:29:12.610 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-18.15:29:12.610 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-18.15:29:12.610 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-18.15:29:12.610 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.15:29:12.610 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.15:29:12.610 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.15:29:12.614 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-18.15:29:12.614 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-18.15:29:12.614 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-18.15:29:12.627 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-18.15:29:12.627 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-18.15:29:12.627 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-18.15:29:12.627 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-18.15:29:12.627 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-18.15:29:12.627 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-18.15:29:12.886 [RMI TCP Connection(1)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
24-06-18.15:29:12.886 [RMI TCP Connection(1)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
24-06-18.15:29:12.886 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-18.15:29:12.887 [RMI TCP Connection(1)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 1 ms
24-06-18.15:29:13.050 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-18.15:29:13.058 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-18.15:29:13.080 [RMI TCP Connection(2)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-18.15:29:15.639 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=267, memberId='consumer-sku-clear-group-3-4afce7ed-dbdd-4512-ad8b-f7988c4f48c6', protocol='range'}
24-06-18.15:29:15.639 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=13, memberId='consumer-send-rebate-group-1-920f3014-f49e-4b52-a28c-f826e9009ae2', protocol='range'}
24-06-18.15:29:15.639 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=265, memberId='consumer-sku-deduct-group-2-f845fffd-71e4-4962-bdb4-75d5ba04d146', protocol='range'}
24-06-18.15:29:15.644 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 265: {consumer-sku-deduct-group-2-f845fffd-71e4-4962-bdb4-75d5ba04d146=Assignment(partitions=[sku-deduct-topic-0])}
24-06-18.15:29:15.644 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 267: {consumer-sku-clear-group-3-4afce7ed-dbdd-4512-ad8b-f7988c4f48c6=Assignment(partitions=[sku-clear-topic-0])}
24-06-18.15:29:15.644 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 13: {consumer-send-rebate-group-1-920f3014-f49e-4b52-a28c-f826e9009ae2=Assignment(partitions=[send-rebate-topic-0])}
24-06-18.15:29:15.660 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=13, memberId='consumer-send-rebate-group-1-920f3014-f49e-4b52-a28c-f826e9009ae2', protocol='range'}
24-06-18.15:29:15.660 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=265, memberId='consumer-sku-deduct-group-2-f845fffd-71e4-4962-bdb4-75d5ba04d146', protocol='range'}
24-06-18.15:29:15.660 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=267, memberId='consumer-sku-clear-group-3-4afce7ed-dbdd-4512-ad8b-f7988c4f48c6', protocol='range'}
24-06-18.15:29:15.661 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-18.15:29:15.661 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-18.15:29:15.661 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-18.15:29:15.664 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-18.15:29:15.664 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-18.15:29:15.664 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-18.15:29:15.679 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Found no committed offset for partition send-rebate-topic-0
24-06-18.15:29:15.680 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=80, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-18.15:29:15.680 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-18.15:29:15.681 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-18.15:29:15.681 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-18.15:29:15.688 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  SubscriptionState      - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting offset for partition send-rebate-topic-0 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}.
24-06-18.15:29:15.688 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-18.15:29:16.225 [http-nio-8091-exec-1] INFO  RaffleActivityController - 日历签到返利开始 userId:matthew
24-06-18.15:29:16.226 [http-nio-8091-exec-1] INFO  BehaviorRebateService  - 开始创建返利订单 userId:matthew 
24-06-18.15:29:16.238 [http-nio-8091-exec-1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-18.15:29:16.341 [http-nio-8091-exec-1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-18.15:29:16.555 [http-nio-8091-exec-1] INFO  ProducerConfig         - Idempotence will be disabled because acks is set to 1, not set to 'all'.
24-06-18.15:29:16.555 [http-nio-8091-exec-1] INFO  ProducerConfig         - ProducerConfig values: 
	acks = 1
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-1
	compression.type = none
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = false
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.class = class org.apache.kafka.clients.producer.internals.DefaultPartitioner
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 1
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

24-06-18.15:29:16.565 [http-nio-8091-exec-1] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-18.15:29:16.566 [http-nio-8091-exec-1] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-18.15:29:16.566 [http-nio-8091-exec-1] INFO  AppInfoParser          - Kafka startTimeMs: 1718695756565
24-06-18.15:29:16.570 [kafka-producer-network-thread | producer-1] INFO  Metadata               - [Producer clientId=producer-1] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-18.15:29:16.573 [kafka-producer-network-thread | producer-1] INFO  Metadata               - [Producer clientId=producer-1] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-18.15:29:16.580 [http-nio-8091-exec-1] INFO  EventPublisher         - 发送MQ消息 topic:send-rebate-topic message:{"data":{"bizId":"matthew_sku_20240618","rebateConfig":"999","rebateDesc":"签到返利-sku额度","rebateType":"sign","userId":"matthew"},"id":"59812257866","timestamp":1718695756374}
24-06-18.15:29:16.595 [http-nio-8091-exec-1] INFO  EventPublisher         - 发送MQ消息 topic:send-rebate-topic message:{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}
24-06-18.15:29:16.605 [http-nio-8091-exec-1] INFO  RaffleActivityController - 日历签到返利完成 userId:matthew orderIds: ["931091709696","731594955414"]
24-06-18.15:29:16.611 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_sku_20240618","rebateConfig":"999","rebateDesc":"签到返利-sku额度","rebateType":"sign","userId":"matthew"},"id":"59812257866","timestamp":1718695756374}]
24-06-18.15:29:16.629 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 999 outBusinessNo: matthew_sku_20240618
24-06-18.15:29:16.723 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单 SKU 查询结果：{"activityCountId":100001,"activityId":100001,"sku":999,"stockCount":1000000,"stockCountSurplus":1000000} {"activityId":100001,"activityName":"测试活动","beginDateTime":1709979310000,"endDateTime":2025512110000,"state":"open","strategyId":100006} {"activityCountId":100001,"dayCount":1,"monthCount":1,"totalCount":1}
24-06-18.15:29:16.723 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ActivityBaseChainNode  - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:999 activityId:100001
24-06-18.15:29:16.723 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ActivitySkuStockActionChainNode - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:999 activityId:100001
24-06-18.15:29:16.729 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ActivitySkuStockActionChainNode - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:999 activityId:100001
24-06-18.15:29:16.735 [kafka-producer-network-thread | producer-1] INFO  Metadata               - [Producer clientId=producer-1] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-18.15:29:16.737 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  EventPublisher         - 发送MQ消息 topic:sku-deduct-topic message:{"data":{"activityId":100001,"sku":999},"id":"55366521664","timestamp":1718695756730}
24-06-18.15:29:16.793 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户行为返利消息消费成功! Topic:send-rebate-topic,Message:{"data":{"bizId":"matthew_sku_20240618","rebateConfig":"999","rebateDesc":"签到返利-sku额度","rebateType":"sign","userId":"matthew"},"id":"59812257866","timestamp":1718695756374}
24-06-18.15:29:16.794 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ActivitySkuStockConsumeMessageListener - Kafka库存扣减消费成功! Topic:sku-deduct-topic,Message:{"data":{"activityId":100001,"sku":999},"id":"55366521664","timestamp":1718695756730}
24-06-18.15:29:16.795 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
24-06-18.15:29:16.796 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:29:16.832 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$681b96cb.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:49)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:29:16.876 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 1 for partition send-rebate-topic-0
24-06-18.15:29:16.876 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 10 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$681b96cb.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:49)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 12 common frames omitted
24-06-18.15:29:17.300 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
24-06-18.15:29:17.300 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:29:17.302 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$681b96cb.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:49)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:29:17.315 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 1 for partition send-rebate-topic-0
24-06-18.15:29:17.315 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 10 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$681b96cb.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:49)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 12 common frames omitted
24-06-18.15:29:17.803 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
24-06-18.15:29:17.803 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:29:17.805 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$681b96cb.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:49)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:29:17.817 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 1 for partition send-rebate-topic-0
24-06-18.15:29:17.817 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 10 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$681b96cb.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:49)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 12 common frames omitted
24-06-18.15:29:18.309 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
24-06-18.15:29:18.309 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:29:18.313 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$681b96cb.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:49)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:29:18.323 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 1 for partition send-rebate-topic-0
24-06-18.15:29:18.324 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 10 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$681b96cb.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:49)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 12 common frames omitted
24-06-18.15:29:18.812 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
24-06-18.15:29:18.812 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:29:18.814 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$681b96cb.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:49)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:29:18.827 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 1 for partition send-rebate-topic-0
24-06-18.15:29:18.827 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 10 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$681b96cb.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:49)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 12 common frames omitted
24-06-18.15:29:19.319 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
24-06-18.15:29:19.319 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:29:19.322 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$681b96cb.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:49)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:29:19.335 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 1 for partition send-rebate-topic-0
24-06-18.15:29:19.335 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 10 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$681b96cb.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:49)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 12 common frames omitted
24-06-18.15:29:19.826 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
24-06-18.15:29:19.827 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:29:19.833 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$681b96cb.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:49)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:29:19.845 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 1 for partition send-rebate-topic-0
24-06-18.15:29:19.846 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 10 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$681b96cb.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:49)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 12 common frames omitted
24-06-18.15:29:20.335 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
24-06-18.15:29:20.335 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:29:20.339 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$681b96cb.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:49)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:29:20.352 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 1 for partition send-rebate-topic-0
24-06-18.15:29:20.352 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 10 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$681b96cb.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:49)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 12 common frames omitted
24-06-18.15:29:20.840 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
24-06-18.15:29:20.840 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:29:20.843 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$681b96cb.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:49)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:29:20.856 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 1 for partition send-rebate-topic-0
24-06-18.15:29:20.856 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 10 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$681b96cb.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:49)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 12 common frames omitted
24-06-18.15:29:21.344 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
24-06-18.15:29:21.344 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:29:21.348 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$681b96cb.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:49)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:29:21.349 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR DefaultErrorHandler    - Backoff FixedBackOff{interval=0, currentAttempts=10, maxAttempts=9} exhausted for send-rebate-topic-0@1
org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.lang.Thread.run(Thread.java:750)
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$681b96cb.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:49)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 12 common frames omitted
24-06-18.15:29:55.488 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Revoke previously assigned partitions sku-clear-topic-0
24-06-18.15:29:55.488 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Revoke previously assigned partitions send-rebate-topic-0
24-06-18.15:29:55.488 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Revoke previously assigned partitions sku-deduct-topic-0
24-06-18.15:29:55.489 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-18.15:29:55.489 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-18.15:29:55.489 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-18.15:29:55.489 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-f845fffd-71e4-4962-bdb4-75d5ba04d146 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-18.15:29:55.489 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-920f3014-f49e-4b52-a28c-f826e9009ae2 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-18.15:29:55.489 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-4afce7ed-dbdd-4512-ad8b-f7988c4f48c6 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-18.15:29:55.492 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:29:55.492 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:29:55.492 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:29:55.492 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:29:55.492 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:29:55.492 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-18.15:29:55.492 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:29:55.492 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-18.15:29:55.492 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-18.15:29:55.492 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:29:55.492 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:29:55.493 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:29:55.493 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:29:55.493 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:29:55.493 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:29:55.509 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-18.15:29:55.509 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-18.15:29:55.509 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-18.15:29:55.509 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-18.15:29:55.509 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-18.15:29:55.509 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-18.15:29:55.510 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-18.15:29:55.510 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-18.15:29:55.510 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-18.15:29:55.515 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-18.15:29:55.516 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-18.15:29:55.516 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-18.15:29:55.516 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-18.15:29:55.516 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-18.15:29:55.516 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-18.15:29:55.522 [SpringApplicationShutdownHook] INFO  KafkaProducer          - [Producer clientId=producer-1] Closing the Kafka producer with timeoutMillis = 30000 ms.
24-06-18.15:29:55.524 [SpringApplicationShutdownHook] INFO  Metrics                - Metrics scheduler closed
24-06-18.15:29:55.524 [SpringApplicationShutdownHook] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-18.15:29:55.524 [SpringApplicationShutdownHook] INFO  Metrics                - Metrics reporters closed
24-06-18.15:29:55.524 [SpringApplicationShutdownHook] INFO  AppInfoParser          - App info kafka.producer for producer-1 unregistered
24-06-18.15:33:57.015 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 33275 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-18.15:33:57.016 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-18.15:33:57.496 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-18.15:33:57.497 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-18.15:33:57.515 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 10 ms. Found 0 Redis repository interfaces.
24-06-18.15:33:57.926 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-18.15:33:57.929 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-18.15:33:57.930 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-18.15:33:57.930 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-18.15:33:57.968 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-18.15:33:57.968 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 932 ms
24-06-18.15:33:58.326 [main            ] INFO  Version                - Redisson 3.26.0
24-06-18.15:33:58.343 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-18.15:33:58.415 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-18.15:33:58.424 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-18.15:33:58.934 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-18.15:33:59.073 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-18.15:33:59.105 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-18.15:33:59.105 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-18.15:33:59.105 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718696039104
24-06-18.15:33:59.112 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-18.15:33:59.118 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-18.15:33:59.122 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-18.15:33:59.122 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-18.15:33:59.122 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718696039122
24-06-18.15:33:59.124 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-18.15:33:59.125 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-18.15:33:59.128 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-18.15:33:59.128 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-18.15:33:59.128 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718696039128
24-06-18.15:33:59.130 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-18.15:33:59.131 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
24-06-18.15:33:59.136 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-18.15:33:59.145 [main            ] INFO  Application            - Started Application in 2.346 seconds (JVM running for 2.6)
24-06-18.15:33:59.284 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-18.15:33:59.284 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-18.15:33:59.284 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-18.15:33:59.285 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-18.15:33:59.285 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-18.15:33:59.285 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-18.15:33:59.286 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.15:33:59.296 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.15:33:59.296 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-18.15:33:59.296 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.15:33:59.298 [RMI TCP Connection(5)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
24-06-18.15:33:59.298 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-18.15:33:59.298 [RMI TCP Connection(5)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
24-06-18.15:33:59.299 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-18.15:33:59.299 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-18.15:33:59.299 [RMI TCP Connection(5)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 1 ms
24-06-18.15:33:59.315 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-18.15:33:59.315 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-18.15:33:59.315 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-18.15:33:59.315 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-18.15:33:59.315 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-18.15:33:59.315 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-18.15:33:59.477 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-18.15:33:59.488 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-18.15:33:59.513 [RMI TCP Connection(4)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-18.15:34:02.325 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=269, memberId='consumer-sku-clear-group-3-0dac37bf-dc5b-45d1-884d-5f21aaac76a9', protocol='range'}
24-06-18.15:34:02.326 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=15, memberId='consumer-send-rebate-group-1-d9e0033d-9ab3-404d-9bff-0ef85afded58', protocol='range'}
24-06-18.15:34:02.325 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=267, memberId='consumer-sku-deduct-group-2-d4378579-6382-4622-914a-381ab1f3c860', protocol='range'}
24-06-18.15:34:02.331 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 15: {consumer-send-rebate-group-1-d9e0033d-9ab3-404d-9bff-0ef85afded58=Assignment(partitions=[send-rebate-topic-0])}
24-06-18.15:34:02.331 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 269: {consumer-sku-clear-group-3-0dac37bf-dc5b-45d1-884d-5f21aaac76a9=Assignment(partitions=[sku-clear-topic-0])}
24-06-18.15:34:02.331 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 267: {consumer-sku-deduct-group-2-d4378579-6382-4622-914a-381ab1f3c860=Assignment(partitions=[sku-deduct-topic-0])}
24-06-18.15:34:02.355 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=15, memberId='consumer-send-rebate-group-1-d9e0033d-9ab3-404d-9bff-0ef85afded58', protocol='range'}
24-06-18.15:34:02.355 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=267, memberId='consumer-sku-deduct-group-2-d4378579-6382-4622-914a-381ab1f3c860', protocol='range'}
24-06-18.15:34:02.355 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=269, memberId='consumer-sku-clear-group-3-0dac37bf-dc5b-45d1-884d-5f21aaac76a9', protocol='range'}
24-06-18.15:34:02.356 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-18.15:34:02.356 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-18.15:34:02.356 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-18.15:34:02.359 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-18.15:34:02.359 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-18.15:34:02.359 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-18.15:34:02.370 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-18.15:34:02.370 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Setting offset for partition send-rebate-topic-0 to the committed offset FetchPosition{offset=1, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-18.15:34:02.370 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=81, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-18.15:34:02.370 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-18.15:34:02.370 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-18.15:34:02.370 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-18.15:34:02.399 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
24-06-18.15:34:02.457 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:34:02.467 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-18.15:34:02.483 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-18.15:34:02.493 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:34:02.508 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 1 for partition send-rebate-topic-0
24-06-18.15:34:02.508 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:34:02.901 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
24-06-18.15:34:02.901 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:34:02.903 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:34:02.916 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 1 for partition send-rebate-topic-0
24-06-18.15:34:02.916 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:34:03.406 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
24-06-18.15:34:03.406 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:34:03.410 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:34:03.423 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 1 for partition send-rebate-topic-0
24-06-18.15:34:03.423 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:34:03.911 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
24-06-18.15:34:03.911 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:34:03.915 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:34:03.926 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 1 for partition send-rebate-topic-0
24-06-18.15:34:03.926 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:34:04.415 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
24-06-18.15:34:04.415 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:34:04.417 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:34:04.427 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 1 for partition send-rebate-topic-0
24-06-18.15:34:04.428 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:34:04.919 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
24-06-18.15:34:04.919 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:34:04.922 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:34:04.935 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 1 for partition send-rebate-topic-0
24-06-18.15:34:04.935 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:34:05.423 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
24-06-18.15:34:05.423 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:34:05.428 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:34:05.441 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 1 for partition send-rebate-topic-0
24-06-18.15:34:05.441 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:34:05.926 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
24-06-18.15:34:05.926 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:34:05.929 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:34:05.941 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 1 for partition send-rebate-topic-0
24-06-18.15:34:05.941 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:34:06.432 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
24-06-18.15:34:06.433 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:34:06.439 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:34:06.451 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 1 for partition send-rebate-topic-0
24-06-18.15:34:06.451 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:34:06.935 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
24-06-18.15:34:06.935 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:34:06.936 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"92277231795","timestamp":1718695756376}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:34:06.937 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR DefaultErrorHandler    - Backoff FixedBackOff{interval=0, currentAttempts=10, maxAttempts=9} exhausted for send-rebate-topic-0@1
org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:35:19.141 [http-nio-8091-exec-2] INFO  RaffleActivityController - 日历签到返利开始 userId:matthew
24-06-18.15:35:19.141 [http-nio-8091-exec-2] INFO  BehaviorRebateService  - 开始创建返利订单 userId:matthew 
24-06-18.15:35:19.203 [http-nio-8091-exec-2] ERROR RebateRepository       - 写入返利记录，唯一索引冲突 userId: matthew
org.springframework.dao.DuplicateKeyException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'matthew_sku_20240618' for key 'user_behavior_rebate_order_000.uq_biz_id'
### The error may exist in file [/Users/matthew/Desktop/lottery/lottery-app/target/classes/mybatis/mapper/UserBehaviorRebateOrderMapper.xml]
### The error may involve cn.matthew.infrastructure.persistent.dao.rebate.IUserBehaviorRebateOrderDao.insert-Inline
### The error occurred while setting parameters
### SQL: insert into user_behavior_rebate_order_000(         user_id, order_id, behavior_type, rebate_desc, rebate_type, rebate_config, out_business_no, biz_id, create_time, update_time         ) values(         ?, ?, ?, ?, ?, ?, ?, ?, now(), now()         )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'matthew_sku_20240618' for key 'user_behavior_rebate_order_000.uq_biz_id'
; Duplicate entry 'matthew_sku_20240618' for key 'user_behavior_rebate_order_000.uq_biz_id'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'matthew_sku_20240618' for key 'user_behavior_rebate_order_000.uq_biz_id'
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:247)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy104.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy136.insert(Unknown Source)
	at cn.matthew.infrastructure.persistent.repository.RebateRepository.lambda$saveRebateRecord$0(RebateRepository.java:85)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.matthew.infrastructure.persistent.repository.RebateRepository.saveRebateRecord(RebateRepository.java:70)
	at cn.matthew.infrastructure.persistent.repository.RebateRepository$$FastClassBySpringCGLIB$$eb2d2aba.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.RebateRepository$$EnhancerBySpringCGLIB$$95aaadb.saveRebateRecord(<generated>)
	at cn.matthew.domain.rebate.service.BehaviorRebateService.createOrder(BehaviorRebateService.java:93)
	at cn.matthew.trigger.http.RaffleActivityController.calendarSignRebate(RaffleActivityController.java:239)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'matthew_sku_20240618' for key 'user_behavior_rebate_order_000.uq_biz_id'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy177.update(Unknown Source)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 75 common frames omitted
24-06-18.15:35:19.208 [http-nio-8091-exec-2] ERROR RaffleActivityController - 日历签到返利异常 userId:matthew 
cn.matthew.types.exception.AppException: null
	at cn.matthew.infrastructure.persistent.repository.RebateRepository.lambda$saveRebateRecord$0(RebateRepository.java:101)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.matthew.infrastructure.persistent.repository.RebateRepository.saveRebateRecord(RebateRepository.java:70)
	at cn.matthew.infrastructure.persistent.repository.RebateRepository$$FastClassBySpringCGLIB$$eb2d2aba.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.RebateRepository$$EnhancerBySpringCGLIB$$95aaadb.saveRebateRecord(<generated>)
	at cn.matthew.domain.rebate.service.BehaviorRebateService.createOrder(BehaviorRebateService.java:93)
	at cn.matthew.trigger.http.RaffleActivityController.calendarSignRebate(RaffleActivityController.java:239)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:926)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1791)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:37:22.334 [http-nio-8091-exec-4] INFO  RaffleActivityController - 日历签到返利开始 userId:matthew
24-06-18.15:37:22.334 [http-nio-8091-exec-4] INFO  BehaviorRebateService  - 开始创建返利订单 userId:matthew 
24-06-18.15:37:22.434 [http-nio-8091-exec-4] INFO  ProducerConfig         - Idempotence will be disabled because acks is set to 1, not set to 'all'.
24-06-18.15:37:22.434 [http-nio-8091-exec-4] INFO  ProducerConfig         - ProducerConfig values: 
	acks = 1
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-1
	compression.type = none
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = false
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.class = class org.apache.kafka.clients.producer.internals.DefaultPartitioner
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 1
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

24-06-18.15:37:22.445 [http-nio-8091-exec-4] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-18.15:37:22.445 [http-nio-8091-exec-4] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-18.15:37:22.445 [http-nio-8091-exec-4] INFO  AppInfoParser          - Kafka startTimeMs: 1718696242445
24-06-18.15:37:22.468 [kafka-producer-network-thread | producer-1] INFO  Metadata               - [Producer clientId=producer-1] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-18.15:37:22.478 [kafka-producer-network-thread | producer-1] INFO  Metadata               - [Producer clientId=producer-1] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-18.15:37:22.485 [http-nio-8091-exec-4] INFO  EventPublisher         - 发送MQ消息 topic:send-rebate-topic message:{"data":{"bizId":"matthew_sku_20240618","rebateConfig":"999","rebateDesc":"签到返利-sku额度","rebateType":"sign","userId":"matthew"},"id":"41624535968","timestamp":1718696242340}
24-06-18.15:37:22.503 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_sku_20240618","rebateConfig":"999","rebateDesc":"签到返利-sku额度","rebateType":"sign","userId":"matthew"},"id":"41624535968","timestamp":1718696242340}]
24-06-18.15:37:22.503 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 999 outBusinessNo: matthew_sku_20240618
24-06-18.15:37:22.517 [http-nio-8091-exec-4] INFO  EventPublisher         - 发送MQ消息 topic:send-rebate-topic message:{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"51720701095","timestamp":1718696242340}
24-06-18.15:37:22.531 [http-nio-8091-exec-4] INFO  RaffleActivityController - 日历签到返利完成 userId:matthew orderIds: ["423464769792","804241603597"]
24-06-18.15:37:22.579 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单 SKU 查询结果：{"activityCountId":100001,"activityId":100001,"sku":999,"stockCount":1000000,"stockCountSurplus":999999} {"activityId":100001,"activityName":"测试活动","beginDateTime":1709979310000,"endDateTime":2025512110000,"state":"open","strategyId":100006} {"activityCountId":100001,"dayCount":1,"monthCount":1,"totalCount":1}
24-06-18.15:37:22.579 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ActivityBaseChainNode  - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:999 activityId:100001
24-06-18.15:37:22.579 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ActivitySkuStockActionChainNode - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:999 activityId:100001
24-06-18.15:37:22.587 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ActivitySkuStockActionChainNode - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:999 activityId:100001
24-06-18.15:37:22.591 [kafka-producer-network-thread | producer-1] INFO  Metadata               - [Producer clientId=producer-1] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-18.15:37:22.591 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  EventPublisher         - 发送MQ消息 topic:sku-deduct-topic message:{"data":{"activityId":100001,"sku":999},"id":"79537151357","timestamp":1718696242588}
24-06-18.15:37:22.621 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR ActivityRepository     - 写入订单记录，唯一索引冲突 userId: matthew activityId: 100001 sku: 999
org.springframework.dao.DuplicateKeyException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'matthew_sku_20240618' for key 'raffle_activity_order_000.uq_out_business_no'
### The error may exist in file [/Users/matthew/Desktop/lottery/lottery-app/target/classes/mybatis/mapper/ActivityOrderMapper.xml]
### The error may involve cn.matthew.infrastructure.persistent.dao.IRaffleActivityOrderDao.insert-Inline
### The error occurred while setting parameters
### SQL: insert into raffle_activity_order_000         (user_id, sku, activity_id, activity_name, strategy_id, order_id, order_time, state, out_business_no, total_count, day_count, month_count,          create_time, update_time)         values             (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,              now(), now())
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'matthew_sku_20240618' for key 'raffle_activity_order_000.uq_out_business_no'
; Duplicate entry 'matthew_sku_20240618' for key 'raffle_activity_order_000.uq_out_business_no'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'matthew_sku_20240618' for key 'raffle_activity_order_000.uq_out_business_no'
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:247)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy104.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy115.insert(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.bugstack.middleware.db.router.DBRouterJoinPoint.doRouter(DBRouterJoinPoint.java:65)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:220)
	at com.sun.proxy.$Proxy116.insert(Unknown Source)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.lambda$doSaveOrder$0(ActivityRepository.java:209)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.doSaveOrder(ActivityRepository.java:206)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.doSaveOrder(<generated>)
	at cn.matthew.domain.activity.service.ActivityService.doSaveOrder(ActivityService.java:70)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:57)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'matthew_sku_20240618' for key 'raffle_activity_order_000.uq_out_business_no'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy177.update(Unknown Source)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 65 common frames omitted
24-06-18.15:37:22.626 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] WARN  RebateMessageListener  - 监听用户行为返利消息，消费重复 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_sku_20240618","rebateConfig":"999","rebateDesc":"签到返利-sku额度","rebateType":"sign","userId":"matthew"},"id":"41624535968","timestamp":1718696242340}]
cn.matthew.types.exception.AppException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.lambda$doSaveOrder$0(ActivityRepository.java:224)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.doSaveOrder(ActivityRepository.java:206)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.doSaveOrder(<generated>)
	at cn.matthew.domain.activity.service.ActivityService.doSaveOrder(ActivityService.java:70)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:57)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.dao.DuplicateKeyException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'matthew_sku_20240618' for key 'raffle_activity_order_000.uq_out_business_no'
### The error may exist in file [/Users/matthew/Desktop/lottery/lottery-app/target/classes/mybatis/mapper/ActivityOrderMapper.xml]
### The error may involve cn.matthew.infrastructure.persistent.dao.IRaffleActivityOrderDao.insert-Inline
### The error occurred while setting parameters
### SQL: insert into raffle_activity_order_000         (user_id, sku, activity_id, activity_name, strategy_id, order_id, order_time, state, out_business_no, total_count, day_count, month_count,          create_time, update_time)         values             (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,              now(), now())
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'matthew_sku_20240618' for key 'raffle_activity_order_000.uq_out_business_no'
; Duplicate entry 'matthew_sku_20240618' for key 'raffle_activity_order_000.uq_out_business_no'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'matthew_sku_20240618' for key 'raffle_activity_order_000.uq_out_business_no'
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:247)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy104.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy115.insert(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.bugstack.middleware.db.router.DBRouterJoinPoint.doRouter(DBRouterJoinPoint.java:65)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:220)
	at com.sun.proxy.$Proxy116.insert(Unknown Source)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.lambda$doSaveOrder$0(ActivityRepository.java:209)
	... 37 common frames omitted
Caused by: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'matthew_sku_20240618' for key 'raffle_activity_order_000.uq_out_business_no'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy177.update(Unknown Source)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 65 common frames omitted
24-06-18.15:37:22.627 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"51720701095","timestamp":1718696242340}]
24-06-18.15:37:22.627 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:37:22.629 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"51720701095","timestamp":1718696242340}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:37:22.629 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ActivitySkuStockConsumeMessageListener - Kafka库存扣减消费成功! Topic:sku-deduct-topic,Message:{"data":{"activityId":100001,"sku":999},"id":"79537151357","timestamp":1718696242588}
24-06-18.15:37:22.641 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 3 for partition send-rebate-topic-0
24-06-18.15:37:22.642 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:37:23.131 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"51720701095","timestamp":1718696242340}]
24-06-18.15:37:23.131 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:37:23.134 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"51720701095","timestamp":1718696242340}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:37:23.146 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 3 for partition send-rebate-topic-0
24-06-18.15:37:23.146 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:37:23.633 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"51720701095","timestamp":1718696242340}]
24-06-18.15:37:23.633 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:37:23.636 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"51720701095","timestamp":1718696242340}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:37:23.647 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 3 for partition send-rebate-topic-0
24-06-18.15:37:23.647 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:37:24.138 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"51720701095","timestamp":1718696242340}]
24-06-18.15:37:24.138 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:37:24.141 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"51720701095","timestamp":1718696242340}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:37:24.154 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 3 for partition send-rebate-topic-0
24-06-18.15:37:24.154 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:37:24.643 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"51720701095","timestamp":1718696242340}]
24-06-18.15:37:24.644 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:37:24.648 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"51720701095","timestamp":1718696242340}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:37:24.661 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 3 for partition send-rebate-topic-0
24-06-18.15:37:24.661 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:37:25.146 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"51720701095","timestamp":1718696242340}]
24-06-18.15:37:25.147 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:37:25.150 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"51720701095","timestamp":1718696242340}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:37:25.163 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 3 for partition send-rebate-topic-0
24-06-18.15:37:25.163 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:37:25.650 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"51720701095","timestamp":1718696242340}]
24-06-18.15:37:25.650 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:37:25.652 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"51720701095","timestamp":1718696242340}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:37:25.665 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 3 for partition send-rebate-topic-0
24-06-18.15:37:25.665 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:37:26.153 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"51720701095","timestamp":1718696242340}]
24-06-18.15:37:26.153 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:37:26.156 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"51720701095","timestamp":1718696242340}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:37:26.169 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 3 for partition send-rebate-topic-0
24-06-18.15:37:26.169 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:37:26.657 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"51720701095","timestamp":1718696242340}]
24-06-18.15:37:26.657 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:37:26.660 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"51720701095","timestamp":1718696242340}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:37:26.672 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 3 for partition send-rebate-topic-0
24-06-18.15:37:26.673 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:37:27.162 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"51720701095","timestamp":1718696242340}]
24-06-18.15:37:27.163 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:37:27.165 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"51720701095","timestamp":1718696242340}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:37:27.166 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR DefaultErrorHandler    - Backoff FixedBackOff{interval=0, currentAttempts=10, maxAttempts=9} exhausted for send-rebate-topic-0@3
org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:37:59.234 [http-nio-8091-exec-6] INFO  RaffleActivityController - 日历签到返利开始 userId:matthew
24-06-18.15:37:59.234 [http-nio-8091-exec-6] INFO  BehaviorRebateService  - 开始创建返利订单 userId:matthew 
24-06-18.15:37:59.299 [http-nio-8091-exec-6] INFO  EventPublisher         - 发送MQ消息 topic:send-rebate-topic message:{"data":{"bizId":"matthew_sku_20240618","rebateConfig":"999","rebateDesc":"签到返利-sku额度","rebateType":"sign","userId":"matthew"},"id":"62205960250","timestamp":1718696279251}
24-06-18.15:37:59.314 [http-nio-8091-exec-6] INFO  EventPublisher         - 发送MQ消息 topic:send-rebate-topic message:{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"07213041848","timestamp":1718696279251}
24-06-18.15:37:59.316 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_sku_20240618","rebateConfig":"999","rebateDesc":"签到返利-sku额度","rebateType":"sign","userId":"matthew"},"id":"62205960250","timestamp":1718696279251}]
24-06-18.15:37:59.316 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 999 outBusinessNo: matthew_sku_20240618
24-06-18.15:37:59.320 [http-nio-8091-exec-6] INFO  RaffleActivityController - 日历签到返利完成 userId:matthew orderIds: ["416331587740","823658967234"]
24-06-18.15:37:59.321 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单 SKU 查询结果：{"activityCountId":100001,"activityId":100001,"sku":999,"stockCount":1000000,"stockCountSurplus":999998} {"activityId":100001,"activityName":"测试活动","beginDateTime":1709979310000,"endDateTime":2025512110000,"state":"open","strategyId":100006} {"activityCountId":100001,"dayCount":1,"monthCount":1,"totalCount":1}
24-06-18.15:37:59.321 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ActivityBaseChainNode  - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:999 activityId:100001
24-06-18.15:37:59.321 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ActivitySkuStockActionChainNode - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:999 activityId:100001
24-06-18.15:37:59.323 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ActivitySkuStockActionChainNode - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:999 activityId:100001
24-06-18.15:37:59.323 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  EventPublisher         - 发送MQ消息 topic:sku-deduct-topic message:{"data":{"activityId":100001,"sku":999},"id":"86330989769","timestamp":1718696279323}
24-06-18.15:37:59.337 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR ActivityRepository     - 写入订单记录，唯一索引冲突 userId: matthew activityId: 100001 sku: 999
org.springframework.dao.DuplicateKeyException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'matthew_sku_20240618' for key 'raffle_activity_order_000.uq_out_business_no'
### The error may exist in file [/Users/matthew/Desktop/lottery/lottery-app/target/classes/mybatis/mapper/ActivityOrderMapper.xml]
### The error may involve cn.matthew.infrastructure.persistent.dao.IRaffleActivityOrderDao.insert-Inline
### The error occurred while setting parameters
### SQL: insert into raffle_activity_order_000         (user_id, sku, activity_id, activity_name, strategy_id, order_id, order_time, state, out_business_no, total_count, day_count, month_count,          create_time, update_time)         values             (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,              now(), now())
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'matthew_sku_20240618' for key 'raffle_activity_order_000.uq_out_business_no'
; Duplicate entry 'matthew_sku_20240618' for key 'raffle_activity_order_000.uq_out_business_no'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'matthew_sku_20240618' for key 'raffle_activity_order_000.uq_out_business_no'
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:247)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy104.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy115.insert(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.bugstack.middleware.db.router.DBRouterJoinPoint.doRouter(DBRouterJoinPoint.java:65)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:220)
	at com.sun.proxy.$Proxy116.insert(Unknown Source)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.lambda$doSaveOrder$0(ActivityRepository.java:209)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.doSaveOrder(ActivityRepository.java:206)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.doSaveOrder(<generated>)
	at cn.matthew.domain.activity.service.ActivityService.doSaveOrder(ActivityService.java:70)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:57)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'matthew_sku_20240618' for key 'raffle_activity_order_000.uq_out_business_no'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy177.update(Unknown Source)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 64 common frames omitted
24-06-18.15:37:59.341 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] WARN  RebateMessageListener  - 监听用户行为返利消息，消费重复 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_sku_20240618","rebateConfig":"999","rebateDesc":"签到返利-sku额度","rebateType":"sign","userId":"matthew"},"id":"62205960250","timestamp":1718696279251}]
cn.matthew.types.exception.AppException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.lambda$doSaveOrder$0(ActivityRepository.java:224)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.doSaveOrder(ActivityRepository.java:206)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.doSaveOrder(<generated>)
	at cn.matthew.domain.activity.service.ActivityService.doSaveOrder(ActivityService.java:70)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:57)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.dao.DuplicateKeyException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'matthew_sku_20240618' for key 'raffle_activity_order_000.uq_out_business_no'
### The error may exist in file [/Users/matthew/Desktop/lottery/lottery-app/target/classes/mybatis/mapper/ActivityOrderMapper.xml]
### The error may involve cn.matthew.infrastructure.persistent.dao.IRaffleActivityOrderDao.insert-Inline
### The error occurred while setting parameters
### SQL: insert into raffle_activity_order_000         (user_id, sku, activity_id, activity_name, strategy_id, order_id, order_time, state, out_business_no, total_count, day_count, month_count,          create_time, update_time)         values             (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,              now(), now())
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'matthew_sku_20240618' for key 'raffle_activity_order_000.uq_out_business_no'
; Duplicate entry 'matthew_sku_20240618' for key 'raffle_activity_order_000.uq_out_business_no'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'matthew_sku_20240618' for key 'raffle_activity_order_000.uq_out_business_no'
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:247)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy104.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy115.insert(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at cn.bugstack.middleware.db.router.DBRouterJoinPoint.doRouter(DBRouterJoinPoint.java:65)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:220)
	at com.sun.proxy.$Proxy116.insert(Unknown Source)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.lambda$doSaveOrder$0(ActivityRepository.java:209)
	... 36 common frames omitted
Caused by: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'matthew_sku_20240618' for key 'raffle_activity_order_000.uq_out_business_no'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:63)
	at com.sun.proxy.$Proxy177.update(Unknown Source)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 64 common frames omitted
24-06-18.15:37:59.343 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"07213041848","timestamp":1718696279251}]
24-06-18.15:37:59.343 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:37:59.345 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"07213041848","timestamp":1718696279251}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:37:59.355 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ActivitySkuStockConsumeMessageListener - Kafka库存扣减消费成功! Topic:sku-deduct-topic,Message:{"data":{"activityId":100001,"sku":999},"id":"86330989769","timestamp":1718696279323}
24-06-18.15:37:59.357 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 5 for partition send-rebate-topic-0
24-06-18.15:37:59.358 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:37:59.848 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"07213041848","timestamp":1718696279251}]
24-06-18.15:37:59.848 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:37:59.850 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"07213041848","timestamp":1718696279251}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:37:59.860 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 5 for partition send-rebate-topic-0
24-06-18.15:37:59.861 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:38:00.352 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"07213041848","timestamp":1718696279251}]
24-06-18.15:38:00.352 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:38:00.354 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"07213041848","timestamp":1718696279251}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:38:00.364 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 5 for partition send-rebate-topic-0
24-06-18.15:38:00.364 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:38:00.857 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"07213041848","timestamp":1718696279251}]
24-06-18.15:38:00.857 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:38:00.860 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"07213041848","timestamp":1718696279251}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:38:00.873 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 5 for partition send-rebate-topic-0
24-06-18.15:38:00.873 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:38:01.363 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"07213041848","timestamp":1718696279251}]
24-06-18.15:38:01.363 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:38:01.366 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"07213041848","timestamp":1718696279251}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:38:01.379 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 5 for partition send-rebate-topic-0
24-06-18.15:38:01.379 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:38:01.868 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"07213041848","timestamp":1718696279251}]
24-06-18.15:38:01.868 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:38:01.872 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"07213041848","timestamp":1718696279251}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:38:01.885 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 5 for partition send-rebate-topic-0
24-06-18.15:38:01.885 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:38:02.372 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"07213041848","timestamp":1718696279251}]
24-06-18.15:38:02.372 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:38:02.378 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"07213041848","timestamp":1718696279251}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:38:02.391 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 5 for partition send-rebate-topic-0
24-06-18.15:38:02.391 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:38:02.875 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"07213041848","timestamp":1718696279251}]
24-06-18.15:38:02.875 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:38:02.877 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"07213041848","timestamp":1718696279251}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:38:02.888 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 5 for partition send-rebate-topic-0
24-06-18.15:38:02.888 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:38:03.380 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"07213041848","timestamp":1718696279251}]
24-06-18.15:38:03.380 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:38:03.384 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"07213041848","timestamp":1718696279251}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:38:03.395 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 5 for partition send-rebate-topic-0
24-06-18.15:38:03.395 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:38:03.885 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"07213041848","timestamp":1718696279251}]
24-06-18.15:38:03.885 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:38:03.887 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"07213041848","timestamp":1718696279251}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:38:03.888 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR DefaultErrorHandler    - Backoff FixedBackOff{interval=0, currentAttempts=10, maxAttempts=9} exhausted for send-rebate-topic-0@5
org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:39:24.488 [http-nio-8091-exec-8] INFO  RaffleActivityController - 日历签到返利开始 userId:matthew
24-06-18.15:39:24.489 [http-nio-8091-exec-8] INFO  BehaviorRebateService  - 开始创建返利订单 userId:matthew 
24-06-18.15:39:24.544 [http-nio-8091-exec-8] INFO  EventPublisher         - 发送MQ消息 topic:send-rebate-topic message:{"data":{"bizId":"matthew_sku_20240618","rebateConfig":"999","rebateDesc":"签到返利-sku额度","rebateType":"sign","userId":"matthew"},"id":"85177313903","timestamp":1718696364504}
24-06-18.15:39:24.553 [http-nio-8091-exec-8] INFO  EventPublisher         - 发送MQ消息 topic:send-rebate-topic message:{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}
24-06-18.15:39:24.564 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_sku_20240618","rebateConfig":"999","rebateDesc":"签到返利-sku额度","rebateType":"sign","userId":"matthew"},"id":"85177313903","timestamp":1718696364504}]
24-06-18.15:39:24.571 [http-nio-8091-exec-8] INFO  RaffleActivityController - 日历签到返利完成 userId:matthew orderIds: ["379251434770","593561806666"]
24-06-18.15:39:24.572 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 999 outBusinessNo: matthew_sku_20240618
24-06-18.15:39:24.597 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单 SKU 查询结果：{"activityCountId":100001,"activityId":100001,"sku":999,"stockCount":1000000,"stockCountSurplus":999997} {"activityId":100001,"activityName":"测试活动","beginDateTime":1709979310000,"endDateTime":2025512110000,"state":"open","strategyId":100006} {"activityCountId":100001,"dayCount":1,"monthCount":1,"totalCount":1}
24-06-18.15:39:24.597 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ActivityBaseChainNode  - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:999 activityId:100001
24-06-18.15:39:24.597 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ActivitySkuStockActionChainNode - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:999 activityId:100001
24-06-18.15:39:24.609 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ActivitySkuStockActionChainNode - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:999 activityId:100001
24-06-18.15:39:24.610 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  EventPublisher         - 发送MQ消息 topic:sku-deduct-topic message:{"data":{"activityId":100001,"sku":999},"id":"73858722167","timestamp":1718696364609}
24-06-18.15:39:24.632 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ActivitySkuStockConsumeMessageListener - Kafka库存扣减消费成功! Topic:sku-deduct-topic,Message:{"data":{"activityId":100001,"sku":999},"id":"73858722167","timestamp":1718696364609}
24-06-18.15:39:24.641 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户行为返利消息消费成功! Topic:send-rebate-topic,Message:{"data":{"bizId":"matthew_sku_20240618","rebateConfig":"999","rebateDesc":"签到返利-sku额度","rebateType":"sign","userId":"matthew"},"id":"85177313903","timestamp":1718696364504}
24-06-18.15:39:24.642 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-18.15:39:24.642 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:39:24.645 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:39:24.657 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-18.15:39:24.658 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:39:25.144 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-18.15:39:25.144 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:39:25.146 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:39:25.158 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-18.15:39:25.159 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:39:25.650 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-18.15:39:25.650 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:39:25.653 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:39:25.666 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-18.15:39:25.666 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:39:26.152 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-18.15:39:26.153 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:39:26.155 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:39:26.166 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-18.15:39:26.166 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:39:26.656 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-18.15:39:26.657 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:39:26.660 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:39:26.672 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-18.15:39:26.672 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:39:27.162 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-18.15:39:27.162 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:39:27.167 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:39:27.178 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-18.15:39:27.179 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:39:27.666 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-18.15:39:27.666 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:39:27.668 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:39:27.678 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-18.15:39:27.679 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:39:28.169 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-18.15:39:28.170 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:39:28.173 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:39:28.184 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-18.15:39:28.184 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:39:28.673 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-18.15:39:28.673 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:39:28.676 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:39:28.689 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-18.15:39:28.689 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:39:29.176 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-18.15:39:29.176 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:39:29.181 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:39:29.182 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR DefaultErrorHandler    - Backoff FixedBackOff{interval=0, currentAttempts=10, maxAttempts=9} exhausted for send-rebate-topic-0@7
org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$1406d9df.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:40:23.640 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Revoke previously assigned partitions sku-deduct-topic-0
24-06-18.15:40:23.640 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Revoke previously assigned partitions sku-clear-topic-0
24-06-18.15:40:23.640 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Revoke previously assigned partitions send-rebate-topic-0
24-06-18.15:40:23.641 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-18.15:40:23.641 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-18.15:40:23.641 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-18.15:40:23.641 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-d9e0033d-9ab3-404d-9bff-0ef85afded58 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-18.15:40:23.641 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-0dac37bf-dc5b-45d1-884d-5f21aaac76a9 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-18.15:40:23.641 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-d4378579-6382-4622-914a-381ab1f3c860 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-18.15:40:23.642 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:40:23.642 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:40:23.643 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:40:23.643 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:40:23.643 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-18.15:40:23.643 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-18.15:40:23.642 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:40:23.643 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:40:23.643 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-18.15:40:23.644 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:40:23.644 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:40:23.644 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:40:23.644 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:40:23.645 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:40:23.645 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:40:23.667 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-18.15:40:23.667 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-18.15:40:23.667 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-18.15:40:23.667 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-18.15:40:23.667 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-18.15:40:23.667 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-18.15:40:23.668 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-18.15:40:23.668 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-18.15:40:23.668 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-18.15:40:23.672 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-18.15:40:23.672 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-18.15:40:23.672 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-18.15:40:23.672 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-18.15:40:23.672 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-18.15:40:23.672 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-18.15:40:23.678 [SpringApplicationShutdownHook] INFO  KafkaProducer          - [Producer clientId=producer-1] Closing the Kafka producer with timeoutMillis = 30000 ms.
24-06-18.15:40:23.679 [SpringApplicationShutdownHook] INFO  Metrics                - Metrics scheduler closed
24-06-18.15:40:23.679 [SpringApplicationShutdownHook] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-18.15:40:23.679 [SpringApplicationShutdownHook] INFO  Metrics                - Metrics reporters closed
24-06-18.15:40:23.679 [SpringApplicationShutdownHook] INFO  AppInfoParser          - App info kafka.producer for producer-1 unregistered
24-06-18.15:43:48.836 [main            ] INFO  Application            - Starting Application using Java 1.8.0_402 on MacBook-Air.local with PID 34754 (/Users/matthew/Desktop/lottery/lottery-app/target/classes started by matthew in /Users/matthew/Desktop/lottery)
24-06-18.15:43:48.837 [main            ] INFO  Application            - The following 1 profile is active: "dev"
24-06-18.15:43:49.541 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-06-18.15:43:49.542 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-06-18.15:43:49.564 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 13 ms. Found 0 Redis repository interfaces.
24-06-18.15:43:49.962 [main            ] INFO  TomcatWebServer        - Tomcat initialized with port(s): 8091 (http)
24-06-18.15:43:49.966 [main            ] INFO  Http11NioProtocol      - Initializing ProtocolHandler ["http-nio-8091"]
24-06-18.15:43:49.967 [main            ] INFO  StandardService        - Starting service [Tomcat]
24-06-18.15:43:49.967 [main            ] INFO  StandardEngine         - Starting Servlet engine: [Apache Tomcat/9.0.75]
24-06-18.15:43:50.010 [main            ] INFO  [/]                    - Initializing Spring embedded WebApplicationContext
24-06-18.15:43:50.010 [main            ] INFO  ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1148 ms
24-06-18.15:43:50.368 [main            ] INFO  Version                - Redisson 3.26.0
24-06-18.15:43:50.384 [main            ] WARN  DnsServerAddressStreamProviders - Can not find io.netty.resolver.dns.macos.MacOSDnsServerAddressStreamProvider in the classpath, fallback to system defaults. This may result in incorrect DNS resolutions on MacOS. Check whether you have a dependency on 'io.netty:netty-resolver-dns-native-macos'
24-06-18.15:43:50.452 [redisson-netty-1-4] INFO  ConnectionsHolder      - 1 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-18.15:43:50.461 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 127.0.0.1/127.0.0.1:16379
24-06-18.15:43:51.024 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-06-18.15:43:51.156 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-send-rebate-group-1
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = send-rebate-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-18.15:43:51.191 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-18.15:43:51.191 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-18.15:43:51.191 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718696631190
24-06-18.15:43:51.198 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Subscribed to topic(s): send-rebate-topic
24-06-18.15:43:51.205 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-deduct-group-2
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-deduct-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-18.15:43:51.208 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-18.15:43:51.208 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-18.15:43:51.208 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718696631208
24-06-18.15:43:51.211 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Subscribed to topic(s): sku-deduct-topic
24-06-18.15:43:51.212 [main            ] INFO  ConsumerConfig         - ConsumerConfig values: 
	allow.auto.create.topics = true
	auto.commit.interval.ms = 1000
	auto.offset.reset = earliest
	bootstrap.servers = [localhost:9092]
	check.crcs = true
	client.dns.lookup = use_all_dns_ips
	client.id = consumer-sku-clear-group-3
	client.rack = 
	connections.max.idle.ms = 540000
	default.api.timeout.ms = 60000
	enable.auto.commit = false
	exclude.internal.topics = true
	fetch.max.bytes = 52428800
	fetch.max.wait.ms = 500
	fetch.min.bytes = 1
	group.id = sku-clear-group
	group.instance.id = null
	heartbeat.interval.ms = 3000
	interceptor.classes = []
	internal.leave.group.on.close = true
	internal.throw.on.fetch.stable.offset.unsupported = false
	isolation.level = read_uncommitted
	key.deserializer = class org.apache.kafka.common.serialization.StringDeserializer
	max.partition.fetch.bytes = 1048576
	max.poll.interval.ms = 300000
	max.poll.records = 500
	metadata.max.age.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partition.assignment.strategy = [class org.apache.kafka.clients.consumer.RangeAssignor, class org.apache.kafka.clients.consumer.CooperativeStickyAssignor]
	receive.buffer.bytes = 65536
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	session.timeout.ms = 45000
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	value.deserializer = class org.apache.kafka.common.serialization.StringDeserializer

24-06-18.15:43:51.214 [main            ] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-18.15:43:51.215 [main            ] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-18.15:43:51.215 [main            ] INFO  AppInfoParser          - Kafka startTimeMs: 1718696631214
24-06-18.15:43:51.217 [main            ] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Subscribed to topic(s): sku-clear-topic
24-06-18.15:43:51.217 [main            ] INFO  Http11NioProtocol      - Starting ProtocolHandler ["http-nio-8091"]
24-06-18.15:43:51.222 [main            ] INFO  TomcatWebServer        - Tomcat started on port(s): 8091 (http) with context path ''
24-06-18.15:43:51.231 [main            ] INFO  Application            - Started Application in 2.64 seconds (JVM running for 2.949)
24-06-18.15:43:51.371 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-18.15:43:51.371 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting the last seen epoch of partition sku-clear-topic-0 to 0 since the associated topicId changed from null to dpyYmhqySGOjKUa7M-VmvQ
24-06-18.15:43:51.371 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting the last seen epoch of partition sku-deduct-topic-0 to 0 since the associated topicId changed from null to OUAQupDCTI6kGFJOV16ciA
24-06-18.15:43:51.372 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-18.15:43:51.372 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-18.15:43:51.372 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metadata               - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-18.15:43:51.373 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.15:43:51.373 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.15:43:51.373 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Discovered group coordinator kafka:9092 (id: 2147483646 rack: null)
24-06-18.15:43:51.375 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-18.15:43:51.375 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-18.15:43:51.376 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-18.15:43:51.389 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: need to re-join with the given member-id
24-06-18.15:43:51.389 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: need to re-join with the given member-id
24-06-18.15:43:51.389 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: need to re-join with the given member-id
24-06-18.15:43:51.389 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] (Re-)joining group
24-06-18.15:43:51.389 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] (Re-)joining group
24-06-18.15:43:51.389 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] (Re-)joining group
24-06-18.15:43:51.527 [RMI TCP Connection(2)-127.0.0.1] INFO  [/]                    - Initializing Spring DispatcherServlet 'dispatcherServlet'
24-06-18.15:43:51.529 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Initializing Servlet 'dispatcherServlet'
24-06-18.15:43:51.531 [RMI TCP Connection(2)-127.0.0.1] INFO  DispatcherServlet      - Completed initialization in 2 ms
24-06-18.15:43:51.534 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-18.15:43:51.744 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-18.15:43:51.760 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-18.15:43:51.781 [RMI TCP Connection(1)-127.0.0.1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-18.15:43:54.396 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully joined group with generation Generation{generationId=269, memberId='consumer-sku-deduct-group-2-195dccb1-d1c8-4f53-9b38-a2c66605053e', protocol='range'}
24-06-18.15:43:54.396 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully joined group with generation Generation{generationId=17, memberId='consumer-send-rebate-group-1-c770c558-24f5-4917-80bc-82bc74bcc85d', protocol='range'}
24-06-18.15:43:54.396 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully joined group with generation Generation{generationId=271, memberId='consumer-sku-clear-group-3-a80869f5-bacc-41ac-8475-60e4c55ce3e8', protocol='range'}
24-06-18.15:43:54.398 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Finished assignment for group at generation 269: {consumer-sku-deduct-group-2-195dccb1-d1c8-4f53-9b38-a2c66605053e=Assignment(partitions=[sku-deduct-topic-0])}
24-06-18.15:43:54.398 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Finished assignment for group at generation 271: {consumer-sku-clear-group-3-a80869f5-bacc-41ac-8475-60e4c55ce3e8=Assignment(partitions=[sku-clear-topic-0])}
24-06-18.15:43:54.398 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Finished assignment for group at generation 17: {consumer-send-rebate-group-1-c770c558-24f5-4917-80bc-82bc74bcc85d=Assignment(partitions=[send-rebate-topic-0])}
24-06-18.15:43:54.411 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Successfully synced group in generation Generation{generationId=17, memberId='consumer-send-rebate-group-1-c770c558-24f5-4917-80bc-82bc74bcc85d', protocol='range'}
24-06-18.15:43:54.411 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Successfully synced group in generation Generation{generationId=269, memberId='consumer-sku-deduct-group-2-195dccb1-d1c8-4f53-9b38-a2c66605053e', protocol='range'}
24-06-18.15:43:54.411 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Successfully synced group in generation Generation{generationId=271, memberId='consumer-sku-clear-group-3-a80869f5-bacc-41ac-8475-60e4c55ce3e8', protocol='range'}
24-06-18.15:43:54.412 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Notifying assignor about the new Assignment(partitions=[sku-deduct-topic-0])
24-06-18.15:43:54.412 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Notifying assignor about the new Assignment(partitions=[sku-clear-topic-0])
24-06-18.15:43:54.412 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Notifying assignor about the new Assignment(partitions=[send-rebate-topic-0])
24-06-18.15:43:54.414 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Adding newly assigned partitions: sku-deduct-topic-0
24-06-18.15:43:54.414 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Adding newly assigned partitions: send-rebate-topic-0
24-06-18.15:43:54.414 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Adding newly assigned partitions: sku-clear-topic-0
24-06-18.15:43:54.424 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Setting offset for partition sku-clear-topic-0 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-18.15:43:54.424 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Setting offset for partition send-rebate-topic-0 to the committed offset FetchPosition{offset=7, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-18.15:43:54.424 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Setting offset for partition sku-deduct-topic-0 to the committed offset FetchPosition{offset=84, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[kafka:9092 (id: 1 rack: null)], epoch=0}}
24-06-18.15:43:54.425 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions assigned: [sku-clear-topic-0]
24-06-18.15:43:54.425 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions assigned: [send-rebate-topic-0]
24-06-18.15:43:54.425 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions assigned: [sku-deduct-topic-0]
24-06-18.15:43:54.451 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-18.15:43:54.532 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:43:54.545 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-06-18.15:43:54.561 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-06-18.15:43:54.571 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:43:54.584 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-18.15:43:54.585 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:43:54.959 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-18.15:43:54.960 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:43:54.962 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:43:54.976 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-18.15:43:54.976 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:43:55.463 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-18.15:43:55.463 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:43:55.465 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:43:55.478 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-18.15:43:55.478 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:43:55.966 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-18.15:43:55.966 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:43:55.969 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:43:55.982 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-18.15:43:55.982 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:43:56.469 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-18.15:43:56.470 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:43:56.472 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:43:56.483 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-18.15:43:56.483 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:43:56.973 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-18.15:43:56.974 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:43:56.978 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:43:56.990 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-18.15:43:56.991 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:43:57.476 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-18.15:43:57.476 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:43:57.478 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:43:57.490 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-18.15:43:57.490 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:43:57.983 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-18.15:43:57.983 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:43:57.990 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:43:58.001 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-18.15:43:58.002 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:43:58.487 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-18.15:43:58.487 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:43:58.489 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:43:58.502 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Seeking to offset 7 for partition send-rebate-topic-0
24-06-18.15:43:58.503 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR KafkaMessageListenerContainer - Error handler threw an exception
org.springframework.kafka.KafkaException: Seek to current after exception; nested exception is org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.SeekUtils.seekOrRecover(SeekUtils.java:208)
	at org.springframework.kafka.listener.DefaultErrorHandler.handleRemaining(DefaultErrorHandler.java:133)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeErrorHandler(KafkaMessageListenerContainer.java:2682)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2563)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	... 9 common frames omitted
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:43:58.990 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
24-06-18.15:43:58.990 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AbstractRaffleActivity - 创建充值订单，userId: matthew sku: 10 outBusinessNo: matthew_integral_20240618
24-06-18.15:43:58.992 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR RebateMessageListener  - 监听用户行为返利消息，消费失败 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"sign","userId":"matthew"},"id":"91587119341","timestamp":1718696364504}]
java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
24-06-18.15:43:58.993 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] ERROR DefaultErrorHandler    - Backoff FixedBackOff{interval=0, currentAttempts=10, maxAttempts=9} exhausted for send-rebate-topic-0@7
org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method 'public void cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(org.apache.kafka.clients.consumer.ConsumerRecord<?, ?>,org.springframework.kafka.support.Acknowledgment,java.lang.String)' threw exception; nested exception is java.lang.NullPointerException; nested exception is java.lang.NullPointerException
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2695)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2665)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2625)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2552)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2433)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2311)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:1982)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1366)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1357)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1252)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:363)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
Caused by: java.lang.NullPointerException: null
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository.queryActivitySkuInfo(ActivityRepository.java:73)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$FastClassBySpringCGLIB$$8e55dbe6.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at cn.matthew.infrastructure.persistent.repository.ActivityRepository$$EnhancerBySpringCGLIB$$580906c.queryActivitySkuInfo(<generated>)
	at cn.matthew.domain.activity.service.AbstractRaffleActivityService.createSkuRechargeOrder(AbstractRaffleActivity.java:43)
	at cn.matthew.trigger.listener.RebateMessageListener.rebateMessage(RebateMessageListener.java:52)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:56)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:347)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:92)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:53)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2645)
	... 11 common frames omitted
24-06-18.15:44:47.959 [http-nio-8091-exec-2] INFO  RaffleActivityController - 日历签到返利开始 userId:matthew
24-06-18.15:44:47.959 [http-nio-8091-exec-2] INFO  BehaviorRebateService  - 开始创建返利订单 userId:matthew 
24-06-18.15:44:48.075 [http-nio-8091-exec-2] INFO  ProducerConfig         - Idempotence will be disabled because acks is set to 1, not set to 'all'.
24-06-18.15:44:48.075 [http-nio-8091-exec-2] INFO  ProducerConfig         - ProducerConfig values: 
	acks = 1
	batch.size = 16384
	bootstrap.servers = [localhost:9092]
	buffer.memory = 33554432
	client.dns.lookup = use_all_dns_ips
	client.id = producer-1
	compression.type = none
	connections.max.idle.ms = 540000
	delivery.timeout.ms = 120000
	enable.idempotence = false
	interceptor.classes = []
	key.serializer = class org.apache.kafka.common.serialization.StringSerializer
	linger.ms = 0
	max.block.ms = 60000
	max.in.flight.requests.per.connection = 5
	max.request.size = 1048576
	metadata.max.age.ms = 300000
	metadata.max.idle.ms = 300000
	metric.reporters = []
	metrics.num.samples = 2
	metrics.recording.level = INFO
	metrics.sample.window.ms = 30000
	partitioner.class = class org.apache.kafka.clients.producer.internals.DefaultPartitioner
	receive.buffer.bytes = 32768
	reconnect.backoff.max.ms = 1000
	reconnect.backoff.ms = 50
	request.timeout.ms = 30000
	retries = 1
	retry.backoff.ms = 100
	sasl.client.callback.handler.class = null
	sasl.jaas.config = null
	sasl.kerberos.kinit.cmd = /usr/bin/kinit
	sasl.kerberos.min.time.before.relogin = 60000
	sasl.kerberos.service.name = null
	sasl.kerberos.ticket.renew.jitter = 0.05
	sasl.kerberos.ticket.renew.window.factor = 0.8
	sasl.login.callback.handler.class = null
	sasl.login.class = null
	sasl.login.connect.timeout.ms = null
	sasl.login.read.timeout.ms = null
	sasl.login.refresh.buffer.seconds = 300
	sasl.login.refresh.min.period.seconds = 60
	sasl.login.refresh.window.factor = 0.8
	sasl.login.refresh.window.jitter = 0.05
	sasl.login.retry.backoff.max.ms = 10000
	sasl.login.retry.backoff.ms = 100
	sasl.mechanism = GSSAPI
	sasl.oauthbearer.clock.skew.seconds = 30
	sasl.oauthbearer.expected.audience = null
	sasl.oauthbearer.expected.issuer = null
	sasl.oauthbearer.jwks.endpoint.refresh.ms = 3600000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.max.ms = 10000
	sasl.oauthbearer.jwks.endpoint.retry.backoff.ms = 100
	sasl.oauthbearer.jwks.endpoint.url = null
	sasl.oauthbearer.scope.claim.name = scope
	sasl.oauthbearer.sub.claim.name = sub
	sasl.oauthbearer.token.endpoint.url = null
	security.protocol = PLAINTEXT
	security.providers = null
	send.buffer.bytes = 131072
	socket.connection.setup.timeout.max.ms = 30000
	socket.connection.setup.timeout.ms = 10000
	ssl.cipher.suites = null
	ssl.enabled.protocols = [TLSv1.2]
	ssl.endpoint.identification.algorithm = https
	ssl.engine.factory.class = null
	ssl.key.password = null
	ssl.keymanager.algorithm = SunX509
	ssl.keystore.certificate.chain = null
	ssl.keystore.key = null
	ssl.keystore.location = null
	ssl.keystore.password = null
	ssl.keystore.type = JKS
	ssl.protocol = TLSv1.2
	ssl.provider = null
	ssl.secure.random.implementation = null
	ssl.trustmanager.algorithm = PKIX
	ssl.truststore.certificates = null
	ssl.truststore.location = null
	ssl.truststore.password = null
	ssl.truststore.type = JKS
	transaction.timeout.ms = 60000
	transactional.id = null
	value.serializer = class org.apache.kafka.common.serialization.StringSerializer

24-06-18.15:44:48.099 [http-nio-8091-exec-2] INFO  AppInfoParser          - Kafka version: 3.1.2
24-06-18.15:44:48.099 [http-nio-8091-exec-2] INFO  AppInfoParser          - Kafka commitId: f8c67dc3ae0a3265
24-06-18.15:44:48.099 [http-nio-8091-exec-2] INFO  AppInfoParser          - Kafka startTimeMs: 1718696688099
24-06-18.15:44:48.109 [kafka-producer-network-thread | producer-1] INFO  Metadata               - [Producer clientId=producer-1] Cluster ID: eJaca9rYT_ikyV0wtNEGPA
24-06-18.15:44:48.116 [kafka-producer-network-thread | producer-1] INFO  Metadata               - [Producer clientId=producer-1] Resetting the last seen epoch of partition send-rebate-topic-0 to 0 since the associated topicId changed from null to 2iiYGt5rSRiRsPeQqxFxSw
24-06-18.15:44:48.122 [http-nio-8091-exec-2] INFO  EventPublisher         - 发送MQ消息 topic:send-rebate-topic message:{"data":{"bizId":"matthew_sku_20240618","rebateConfig":"999","rebateDesc":"签到返利-sku额度","rebateType":"sku","userId":"matthew"},"id":"66659538015","timestamp":1718696688011}
24-06-18.15:44:48.143 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_sku_20240618","rebateConfig":"999","rebateDesc":"签到返利-sku额度","rebateType":"sku","userId":"matthew"},"id":"66659538015","timestamp":1718696688011}]
24-06-18.15:44:48.146 [http-nio-8091-exec-2] INFO  EventPublisher         - 发送MQ消息 topic:send-rebate-topic message:{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"integral","userId":"matthew"},"id":"52032248913","timestamp":1718696688012}
24-06-18.15:44:48.148 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  RebateMessageListener  - 监听用户返利消息 topic: send-rebate-topic message: Optional[{"data":{"bizId":"matthew_integral_20240618","rebateConfig":"10","rebateDesc":"签到返利-积分","rebateType":"integral","userId":"matthew"},"id":"52032248913","timestamp":1718696688012}]
24-06-18.15:44:48.150 [http-nio-8091-exec-2] INFO  RaffleActivityController - 日历签到返利完成 userId:matthew orderIds: ["780993556230","332605514003"]
24-06-18.15:44:58.407 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Revoke previously assigned partitions send-rebate-topic-0
24-06-18.15:44:58.407 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Revoke previously assigned partitions sku-clear-topic-0
24-06-18.15:44:58.407 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Revoke previously assigned partitions sku-deduct-topic-0
24-06-18.15:44:58.409 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: partitions revoked: [send-rebate-topic-0]
24-06-18.15:44:58.409 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: partitions revoked: [sku-clear-topic-0]
24-06-18.15:44:58.409 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: partitions revoked: [sku-deduct-topic-0]
24-06-18.15:44:58.409 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Member consumer-sku-clear-group-3-a80869f5-bacc-41ac-8475-60e4c55ce3e8 sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-18.15:44:58.409 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Member consumer-sku-deduct-group-2-195dccb1-d1c8-4f53-9b38-a2c66605053e sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-18.15:44:58.409 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Member consumer-send-rebate-group-1-c770c558-24f5-4917-80bc-82bc74bcc85d sending LeaveGroup request to coordinator kafka:9092 (id: 2147483646 rack: null) due to the consumer unsubscribed from all topics
24-06-18.15:44:58.411 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:44:58.411 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:44:58.411 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:44:58.411 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:44:58.411 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:44:58.411 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Unsubscribed all topics or patterns and assigned partitions
24-06-18.15:44:58.411 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Unsubscribed all topics or patterns and assigned partitions
24-06-18.15:44:58.411 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:44:58.411 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaConsumer          - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Unsubscribed all topics or patterns and assigned partitions
24-06-18.15:44:58.412 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:44:58.412 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-clear-group-3, groupId=sku-clear-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:44:58.412 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:44:58.412 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-send-rebate-group-1, groupId=send-rebate-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:44:58.412 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Resetting generation due to: consumer pro-actively leaving the group
24-06-18.15:44:58.413 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  ConsumerCoordinator    - [Consumer clientId=consumer-sku-deduct-group-2, groupId=sku-deduct-group] Request joining group due to: consumer pro-actively leaving the group
24-06-18.15:44:58.427 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-18.15:44:58.427 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-18.15:44:58.427 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-18.15:44:58.427 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-18.15:44:58.427 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-18.15:44:58.428 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics scheduler closed
24-06-18.15:44:58.428 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-18.15:44:58.428 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-18.15:44:58.428 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  Metrics                - Metrics reporters closed
24-06-18.15:44:58.432 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-clear-group-3 unregistered
24-06-18.15:44:58.433 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-send-rebate-group-1 unregistered
24-06-18.15:44:58.433 [org.springframework.kafka.KafkaListenerEndpointContainer#2-0-C-1] INFO  KafkaMessageListenerContainer - send-rebate-group: Consumer stopped
24-06-18.15:44:58.433 [org.springframework.kafka.KafkaListenerEndpointContainer#1-0-C-1] INFO  KafkaMessageListenerContainer - sku-clear-group: Consumer stopped
24-06-18.15:44:58.433 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  AppInfoParser          - App info kafka.consumer for consumer-sku-deduct-group-2 unregistered
24-06-18.15:44:58.433 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  KafkaMessageListenerContainer - sku-deduct-group: Consumer stopped
24-06-18.15:44:58.439 [SpringApplicationShutdownHook] INFO  KafkaProducer          - [Producer clientId=producer-1] Closing the Kafka producer with timeoutMillis = 30000 ms.
24-06-18.15:44:58.440 [SpringApplicationShutdownHook] INFO  Metrics                - Metrics scheduler closed
24-06-18.15:44:58.440 [SpringApplicationShutdownHook] INFO  Metrics                - Closing reporter org.apache.kafka.common.metrics.JmxReporter
24-06-18.15:44:58.441 [SpringApplicationShutdownHook] INFO  Metrics                - Metrics reporters closed
24-06-18.15:44:58.441 [SpringApplicationShutdownHook] INFO  AppInfoParser          - App info kafka.producer for producer-1 unregistered
